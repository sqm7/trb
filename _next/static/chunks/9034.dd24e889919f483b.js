"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9034],{29991:(e,t,r)=>{r.d(t,{l:()=>a});var n=r(95155),s=r(12115),i=r(40980),l=r(66088);let a=s.forwardRef(({className:e,children:t,...r},s)=>(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("select",{className:(0,i.cn)("flex h-10 w-full appearance-none rounded-md border border-input bg-zinc-950/50 px-3 py-2 text-sm text-zinc-100 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 pr-8",e),ref:s,...r,children:t}),(0,n.jsx)(l.A,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50 pointer-events-none"})]}));a.displayName="Select"},37717:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(12115);let s=(e,t)=>getComputedStyle(document.documentElement).getPropertyValue(e).trim()||t,i=e=>{let t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);return t?[Number(t[1]),Number(t[2]),Number(t[3])]:null},l=e=>{let t=e.replace("#","").trim();if(![3,6].includes(t.length))return null;let r=parseInt(3===t.length?t.split("").map(e=>e+e).join(""):t,16);return Number.isNaN(r)?null:[r>>16&255,r>>8&255,255&r]},a=()=>{let e=[s("--color-chart-1","#8b5cf6"),s("--color-chart-2","#06b6d4"),s("--color-chart-3","#10b981"),s("--color-chart-4","#f43f5e"),s("--color-chart-5","#f59e0b")],t=s("--color-dark-bg","#09090b");return{bg:s("--color-dark-bg","#09090b"),card:s("--color-dark-card","#18181b"),surface:s("--color-dark-surface","#27272a"),primary:s("--color-primary","#8b5cf6"),primaryHover:s("--color-primary-hover","#7c3aed"),accent:s("--color-chart-2","#06b6d4"),accentAlt:s("--color-chart-4","#f43f5e"),text:s("--color-text-primary","#fafafa"),textMuted:s("--color-text-secondary","#a1a1aa"),border:s("--color-border","#27272a"),grid:s("--color-zinc-700","#3f3f46"),danger:s("--color-destructive","#ef4444"),warning:s("--color-amber-500","#f59e0b"),success:s("--color-emerald-500","#10b981"),chart:e,chartPalette:((e,t)=>{if(0===e.length)return[];let r=e.map(e=>((e,t,r=.35)=>{let n=l(e)??i(e),s=l(t)??i(t);if(!n||!s)return e;let a=(e,t)=>Math.round(e*(1-r)+t*r),o=a(n[0],s[0]),c=a(n[1],s[1]),d=a(n[2],s[2]);return`rgb(${o}, ${c}, ${d})`})(e,t,.4));return[...e,...r]})(e,t)}};function o(){let[e,t]=(0,n.useState)(()=>a());return(0,n.useEffect)(()=>{let e=()=>t(a());e();let r=new MutationObserver(e);r.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]});let n=t=>{"sqm_theme"===t.key&&e()};return window.addEventListener("storage",n),()=>{r.disconnect(),window.removeEventListener("storage",n)}},[]),(0,n.useMemo)(()=>e,[e])}},60529:(e,t,r)=>{r.d(t,{p:()=>l});var n=r(95155),s=r(12115),i=r(40980);let l=s.forwardRef(({className:e,type:t,...r},s)=>(0,n.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-zinc-950/50 px-3 py-2 text-sm text-zinc-100 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));l.displayName="Input"},72566:(e,t,r)=>{r.d(t,{q:()=>i});var n=r(95155);r(12115);var s=r(40980);function i({title:e,description:t,children:r,headerAction:i,className:l,containerRef:a}){return(0,n.jsxs)("div",{ref:a,className:(0,s.cn)("bg-zinc-900/50 border border-white/5 rounded-2xl p-4 md:p-6 backdrop-blur-sm",l),children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:e}),t&&(0,n.jsx)("p",{className:"text-zinc-400 text-sm mt-1",children:t})]}),i&&(0,n.jsx)("div",{className:"flex-shrink-0 w-full md:w-auto overflow-x-auto","data-html2canvas-ignore":"true",children:i})]}),r]})}},80642:(e,t,r)=>{r.d(t,{N:()=>v});var n=r(95155),s=r(12115),i=r(39551),l=r(28819),a=r(4524),o=r(15131),c=r(78757),d=r(24866);function x(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class h extends s.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,c.s)(e)&&e.offsetWidth||0,n=(0,c.s)(e)&&e.offsetHeight||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left,s.bottom=n-s.height-s.top}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:t,anchorX:r,anchorY:i,root:l}){let a=(0,s.useId)(),o=(0,s.useRef)(null),c=(0,s.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:u}=(0,s.useContext)(d.Q),m=function(...e){return s.useCallback(function(...e){return t=>{let r=!1,n=e.map(e=>{let n=x(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():x(e[t],null)}}}}(...e),e)}(o,e.props?.ref??e?.ref);return(0,s.useInsertionEffect)(()=>{let{width:e,height:n,top:s,left:d,right:x,bottom:h}=c.current;if(t||!o.current||!e||!n)return;let m="left"===r?`left: ${d}`:`right: ${x}`,p="bottom"===i?`bottom: ${h}`:`top: ${s}`;o.current.dataset.motionPopId=a;let f=document.createElement("style");u&&(f.nonce=u);let b=l??document.head;return b.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${n}px !important;
            ${m}px !important;
            ${p}px !important;
          }
        `),()=>{b.contains(f)&&b.removeChild(f)}},[t]),(0,n.jsx)(h,{isPresent:t,childRef:o,sizeRef:c,children:s.cloneElement(e,{ref:m})})}let m=({children:e,initial:t,isPresent:r,onExitComplete:i,custom:a,presenceAffectsLayout:c,mode:d,anchorX:x,anchorY:h,root:m})=>{let f=(0,l.M)(p),b=(0,s.useId)(),g=!0,v=(0,s.useMemo)(()=>(g=!1,{id:b,initial:t,isPresent:r,custom:a,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;i&&i()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[r,f,i]);return c&&g&&(v={...v}),(0,s.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[r]),s.useEffect(()=>{r||f.size||!i||i()},[r]),"popLayout"===d&&(e=(0,n.jsx)(u,{isPresent:r,anchorX:x,anchorY:h,root:m,children:e})),(0,n.jsx)(o.t.Provider,{value:v,children:e})};function p(){return new Map}var f=r(79196);let b=e=>e.key||"";function g(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let v=({children:e,custom:t,initial:r=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:x=!1,anchorX:h="left",anchorY:u="top",root:p})=>{let[v,j]=(0,f.xQ)(x),N=(0,s.useMemo)(()=>g(e),[e]),w=x&&!v?[]:N.map(b),y=(0,s.useRef)(!0),z=(0,s.useRef)(N),R=(0,l.M)(()=>new Map),k=(0,s.useRef)(new Set),[M,P]=(0,s.useState)(N),[$,C]=(0,s.useState)(N);(0,a.E)(()=>{y.current=!1,z.current=N;for(let e=0;e<$.length;e++){let t=b($[e]);w.includes(t)?(R.delete(t),k.current.delete(t)):!0!==R.get(t)&&R.set(t,!1)}},[$,w.length,w.join("-")]);let E=[];if(N!==M){let e=[...N];for(let t=0;t<$.length;t++){let r=$[t],n=b(r);w.includes(n)||(e.splice(t,0,r),E.push(r))}return"wait"===d&&E.length&&(e=E),C(g(e)),P(N),null}let{forceRender:A}=(0,s.useContext)(i.L);return(0,n.jsx)(n.Fragment,{children:$.map(e=>{let s=b(e),i=(!x||!!v)&&(N===$||w.includes(s));return(0,n.jsx)(m,{isPresent:i,initial:(!y.current||!!r)&&void 0,custom:t,presenceAffectsLayout:c,mode:d,root:p,onExitComplete:i?void 0:()=>{if(k.current.has(s)||(k.current.add(s),!R.has(s)))return;R.set(s,!0);let e=!0;R.forEach(t=>{t||(e=!1)}),e&&(A?.(),C(z.current),x&&j?.(),o&&o())},anchorX:h,anchorY:u,children:e},s)})})}},97085:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(95155);r(12115);var s=r(37206),i=r(81477),l=r(37717);let a=(0,s.default)(()=>Promise.all([r.e(7776),r.e(4822)]).then(r.bind(r,44822)),{loadableGenerated:{webpack:()=>[null]},ssr:!1});function o({type:e,series:t,options:r,height:s=350,title:o,description:c,className:d,loading:x}){let h=(0,l.A)(),u={chart:{background:"transparent",foreColor:h.text,toolbar:{show:!1}},theme:{mode:"dark",palette:"palette1"},dataLabels:{enabled:!1,style:{colors:[h.text]}},grid:{borderColor:h.grid,strokeDashArray:4},xaxis:{labels:{style:{colors:h.textMuted}},axisBorder:{color:h.border},axisTicks:{color:h.border}},yaxis:{labels:{style:{colors:h.textMuted}}},tooltip:{theme:"dark",style:{fontSize:"12px"},x:{show:!0}},legend:{labels:{colors:h.textMuted}}},m={...u,...r,chart:{...u.chart,...r.chart}};return(0,n.jsxs)(i.Zp,{className:`p-4 ${d}`,children:[(o||c)&&(0,n.jsxs)("div",{className:"mb-4",children:[o&&(0,n.jsx)("h3",{className:"text-lg font-bold text-text-primary mb-1",children:o}),c&&(0,n.jsx)("p",{className:"text-sm text-text-secondary",children:c})]}),x?(0,n.jsx)("div",{className:"flex items-center justify-center",style:{height:s},children:(0,n.jsx)("div",{className:"loader"})}):(0,n.jsx)(a,{options:m,series:t,type:e,height:s,width:"100%"})]})}},98230:(e,t,r)=>{r.r(t),r.d(t,{MapSalesVelocityReport:()=>f});var n=r(95155),s=r(12115),i=r(72566),l=r(3083),a=r(4439),o=r(91703),c=r(29991),d=r(60529),x=r(40980),h=r(91156),u=r(88743),m=r(39430),p=r(80642);function f({data:e,visibleSections:t=["chart","table","heatmap"],uiSize:r="dashboard"}){let[f,b]=(0,s.useState)("monthly"),[g,v]=(0,s.useState)("count"),j=(0,x.cn)("bg-zinc-950/50","builder"===r?"text-xl h-12":"text-sm h-9"),[N,w]=(0,s.useState)(15),[y,z]=(0,s.useState)(65),[R,k]=(0,s.useState)(2),M=s.useMemo(()=>{let t=(e?.transactionDetails||[]).map(e=>{let t=Number(e["房屋面積(坪)"]||e.houseArea||(e["建物移轉平方公尺"]?.3025*e["建物移轉平方公尺"]:null));return Number.isFinite(t)&&t>0?t:null}).filter(e=>null!==e);return t.length?{min:Math.min(...t),max:Math.max(...t)}:null},[e?.transactionDetails]),P=s.useMemo(()=>{let t=e?.transactionDetails?.[0];if(!t)return"";let r=t["建案名稱"]||t.projectName||"";return`${r}-${e?.transactionDetails?.length||0}`},[e?.transactionDetails]);s.useEffect(()=>{if(!M)return;let e=Math.floor(M.min),t=Math.ceil(M.max);w(e),z(t),k(2)},[P,M?.min,M?.max]);let[$,C]=(0,s.useState)([]),[E,A]=(0,s.useState)(null),{selectedRoomTypes:S,setSelectedRoomTypes:F}=(0,u.P)();if(!e)return null;let{salesVelocityAnalysis:D,areaDistributionAnalysis:I}=e,L=e=>Math.round(e)+"萬",q=s.useRef(null),W=s.useRef(null),_=s.useRef(null),H=s.useRef(null),T=s.useRef(`sales-velocity-${Math.random().toString(36).slice(2,8)}`).current,B=s.useRef(`area-heatmap-${Math.random().toString(36).slice(2,8)}`).current,V=(t,r)=>{q.current&&(q.current.style.width=`${q.current.offsetWidth}px`);let n=0,s=1/0;if(r.includes("<"))s=parseFloat(r.replace("<","").trim());else if(r.includes(">"))n=parseFloat(r.replace(">","").trim());else if(r.includes("-")){let e=r.split("-");n=parseFloat(e[0].trim()),s=parseFloat(e[1].trim())}let i=(e.transactionDetails||[]).filter(e=>{let r=(0,h.A)(e),i=parseFloat(e["房屋面積(坪)"]||e.houseArea||(e["建物移轉平方公尺"]?.3025*e["建物移移轉平方公尺"]:0));if(!r)return!1;let l=i>=n&&i<s;return r===t&&l});console.log(`[Heatmap Click] Room: ${t}, Range: ${n}-${s}, Found: ${i.length}`);let l={};i.forEach(e=>{let t=e["建案名稱"]||e.projectName||"未知建案";l[t]||(l[t]=[]),l[t].push(e)});let a=Object.entries(l).map(([e,t])=>{let r=t.map(e=>e["產權總價"]||e["交易總價(萬)"]||e.totalPrice||0).filter(e=>e>0).sort((e,t)=>e-t),n=t.map(e=>e["房屋單價"]||e["房屋單價(萬)"]||e.unitPrice||0).filter(e=>e>0),s=0;if(r.length>0){let e=Math.floor(r.length/2);s=r.length%2!=0?r[e]:(r[e-1]+r[e])/2}return{projectName:e,count:t.length,priceRange:{min:r.length>0?r[0]:0,max:r.length>0?r[r.length-1]:0,median:s},unitPriceRange:{min:n.length>0?Math.min(...n):0,max:n.length>0?Math.max(...n):0},transactions:t.sort((e,t)=>{let r=e["房屋單價"]||e["房屋單價(萬)"]||e.unitPrice||0;return(t["房屋單價"]||t["房屋單價(萬)"]||t.unitPrice||0)-r}),isExpanded:!1}});a.sort((e,t)=>t.unitPriceRange.max-e.unitPriceRange.max),C(a),A({roomType:t,areaRange:r,totalCount:i.length})},O=()=>{q.current&&(q.current.style.width=`${q.current.offsetWidth}px`),A(null)},Q=t.includes("chart"),U=t.includes("table"),X=t.includes("heatmap"),Y=t.includes("heatmap-detail")&&!X&&!Q&&!U;s.useEffect(()=>{let t,r,n;if(!Y||E||!e?.transactionDetails?.length)return;let s=S[0]||u.M[0];s&&V(s,(r=(t=Number.isInteger(R)&&Number.isInteger(N))?N.toFixed(0):N.toFixed(1),n=t?(N+R).toFixed(0):(N+R).toFixed(1),`${r}-${n}`))},[Y,E,e?.transactionDetails,S,N,R]);let G=()=>E?(0,n.jsxs)("div",{className:"flex-1 min-w-0 bg-zinc-900/50 border border-white/10 rounded-lg h-full flex flex-col p-4 overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-4 pb-4 border-b border-white/5",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h4",{className:"text-white font-medium flex items-center gap-2 text-lg",children:[(0,n.jsx)("span",{className:"text-cyan-400",children:E.roomType}),(0,n.jsx)("span",{className:"text-zinc-500",children:"|"}),(0,n.jsxs)("span",{children:[E.areaRange," 坪"]})]}),(0,n.jsxs)("p",{className:"text-zinc-400 text-xs mt-1",children:["共找到 ",(0,n.jsx)("span",{className:"text-white font-mono",children:$.length})," 個建案",(0,n.jsx)("br",{}),"合計 ",(0,n.jsx)("span",{className:"text-white font-mono",children:E.totalCount})," 筆交易"]})]}),(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)("div",{className:"flex gap-1 mr-2"}),!Y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-px h-4 bg-white/10 mx-1"}),(0,n.jsx)("button",{onClick:O,className:"text-zinc-400 hover:text-white p-1 hover:bg-zinc-800 rounded transition-colors",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M18 6 6 18"}),(0,n.jsx)("path",{d:"m6 6 12 12"})]})})]})]})]}),$.length>0?(0,n.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar pr-1 -mr-1",children:(0,n.jsx)("div",{className:"space-y-3",children:$.map((e,t)=>(0,n.jsxs)("div",{className:"bg-zinc-950/30 rounded border border-white/5 overflow-hidden",children:[(0,n.jsxs)("div",{className:(0,x.cn)("p-3 cursor-pointer transition-colors flex justify-between items-center",e.isExpanded?"bg-zinc-800/80":"hover:bg-zinc-800/40"),onClick:()=>{C(e=>e.map((e,r)=>r===t?{...e,isExpanded:!e.isExpanded}:e))},children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:(0,x.cn)("w-4 h-4 rounded-full bg-zinc-800 flex items-center justify-center text-[10px] text-zinc-400 transition-transform duration-200",e.isExpanded?"rotate-90 bg-violet-500/20 text-violet-300":""),children:"▶"}),(0,n.jsx)("span",{className:"font-medium text-sm text-zinc-200",children:e.projectName}),(0,n.jsxs)("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-zinc-800 text-zinc-400 border border-white/5",children:[e.count,"戶"]})]}),(0,n.jsx)("div",{className:"text-right",children:(0,n.jsxs)("div",{className:"text-xs font-mono text-cyan-400",children:[e.unitPriceRange.min===e.unitPriceRange.max?e.unitPriceRange.min.toFixed(1):`${e.unitPriceRange.min.toFixed(1)}~${e.unitPriceRange.max.toFixed(1)}`," ",(0,n.jsx)("span",{className:"text-zinc-500 text-[10px]",children:"萬/坪"})]})})]}),e.isExpanded&&(0,n.jsxs)("div",{className:"p-3 bg-black/20 border-t border-white/5",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs mb-3 text-zinc-400",children:[(0,n.jsxs)("div",{className:"flex justify-between border-b border-white/5 pb-1",children:[(0,n.jsx)("span",{children:"總價範圍"}),(0,n.jsx)("span",{className:"font-mono text-zinc-300",children:e.priceRange.min===e.priceRange.max?L(e.priceRange.min):`${L(e.priceRange.min)}~${L(e.priceRange.max)}`})]}),(0,n.jsxs)("div",{className:"flex justify-between border-b border-white/5 pb-1",children:[(0,n.jsx)("span",{children:"總價中位數"}),(0,n.jsx)("span",{className:"font-mono text-violet-300",children:L(e.priceRange.median||0)})]})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"grid grid-cols-5 text-[10px] text-zinc-500 pb-1 border-b border-white/5",children:[(0,n.jsx)("div",{className:"col-span-1",children:"樓層"}),(0,n.jsx)("div",{className:"col-span-1",children:"坪數"}),(0,n.jsx)("div",{className:"col-span-1 text-right",children:"單價"}),(0,n.jsx)("div",{className:"col-span-2 text-right",children:"總價"})]}),e.transactions.slice(0,e.showAll?void 0:10).map((e,t)=>(0,n.jsxs)("div",{className:"grid grid-cols-5 text-xs py-1 hover:bg-white/5 rounded px-1 -mx-1 transition-colors",children:[(0,n.jsx)("div",{className:"col-span-1 text-zinc-300",children:e["樓層"]||e.floor||"-"}),(0,n.jsx)("div",{className:"col-span-1 text-zinc-400",children:(e["房屋面積(坪)"]||e.houseArea||0).toFixed(1)}),(0,n.jsx)("div",{className:"col-span-1 text-right text-cyan-400",children:(e["房屋單價(萬)"]||e.unitPrice||0).toFixed(0)}),(0,n.jsx)("div",{className:"col-span-2 text-right text-zinc-300 font-mono",children:L(e["交易總價(萬)"]||e.totalPrice||0)})]},t)),e.transactions.length>10&&(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),C(e=>e.map((e,r)=>r===t?{...e,showAll:!e.showAll}:e))},className:"w-full text-center text-[10px] text-zinc-500 hover:text-cyan-400 py-1.5 mt-1 border-t border-white/5 transition-colors",children:e.showAll?"收合內容":`還有 ${e.transactions.length-10} 筆交易...`})]})]})]},t))})}):(0,n.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center text-zinc-500 border border-dashed border-zinc-800 rounded bg-zinc-900/30",children:(0,n.jsx)("p",{children:"無詳細資料"})})]}):(0,n.jsx)("div",{className:"flex items-center justify-center text-zinc-500 border border-dashed border-zinc-800 rounded bg-zinc-900/30 p-6",children:"無詳細資料"});return Y?(0,n.jsx)("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,n.jsx)(G,{})}):(0,n.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,n.jsxs)("div",{id:"room-type-filter-anchor","data-report-control":"hide",className:"p-4 bg-zinc-900/30 border border-white/5 rounded-lg flex flex-wrap gap-2 items-center scroll-mt-24",children:[(0,n.jsx)("span",{className:"text-zinc-400 text-sm mr-2",children:"分析房型:"}),u.M.map(e=>(0,n.jsx)("button",{onClick:()=>{F(S.includes(e)?S.filter(t=>t!==e):[...S,e])},className:(0,x.cn)("px-3 py-1 text-xs rounded-full border transition-colors",S.includes(e)?"bg-violet-500/20 border-violet-500 text-violet-200":"bg-zinc-800 border-zinc-700 text-zinc-500 hover:bg-zinc-700"),children:e},e))]}),Q&&(0,n.jsx)(i.q,{title:"房型銷售速度與趨勢分析",containerRef:W,headerAction:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{"data-report-control":"hide",children:(0,n.jsxs)(c.l,{value:f,onChange:e=>b(e.target.value),className:j,children:[(0,n.jsx)("option",{value:"weekly",children:"每週"}),(0,n.jsx)("option",{value:"monthly",children:"每月"}),(0,n.jsx)("option",{value:"quarterly",children:"每季"})]})}),(0,n.jsx)("div",{"data-report-control":"hide",children:(0,n.jsxs)(c.l,{value:g,onChange:e=>v(e.target.value),className:j,children:[(0,n.jsx)("option",{value:"count",children:"交易筆數"}),(0,n.jsx)("option",{value:"priceSum",children:"總銷金額"}),(0,n.jsx)("option",{value:"areaSum",children:"總銷坪數"})]})})]}),children:(0,n.jsx)(l.M,{data:D?.[f]||{},selectedRooms:S,metric:g,chartId:T})}),U&&(0,n.jsx)(i.q,{title:"銷售速度明細表",description:"各時間段詳細銷售數據統計",containerRef:_,children:(0,n.jsx)(o.I,{data:D?.[f]||[],viewType:f,selectedRooms:S})}),X&&(0,n.jsx)(i.q,{title:"房型面積分佈熱力圖",description:"分析不同坪數區間的產品供給與去化分佈",containerRef:H,headerAction:(0,n.jsx)("div",{className:"flex gap-2 items-center text-zinc-400 text-xs",children:(0,n.jsxs)("div",{className:"flex gap-2 items-center","data-report-control":"hide",children:[(0,n.jsx)("span",{children:"範圍:"}),(0,n.jsx)(d.p,{type:"number",value:N,onChange:e=>w(Number(e.target.value)),className:"w-16 h-8 text-xs bg-zinc-950/50"}),(0,n.jsx)("span",{children:"-"}),(0,n.jsx)(d.p,{type:"number",value:y,onChange:e=>z(Number(e.target.value)),className:"w-16 h-8 text-xs bg-zinc-950/50"}),(0,n.jsx)("span",{className:"ml-2",children:"級距:"}),(0,n.jsx)(d.p,{type:"number",value:R,onChange:e=>k(Number(e.target.value)),step:"0.5",className:"w-16 h-8 text-xs bg-zinc-950/50"}),(0,n.jsx)("div",{className:"border-l border-white/10 h-4 mx-1"})]})}),children:(0,n.jsxs)("div",{className:(0,x.cn)("flex flex-col lg:flex-row gap-6 relative overflow-hidden items-stretch transition-all duration-300",E?"lg:h-[600px]":"min-h-[500px]"),children:[(0,n.jsx)(m.P.div,{layout:!0,initial:!1,animate:{flex:E?"0 0 60%":"0 0 100%"},transition:{type:"spring",stiffness:300,damping:35,mass:1},onAnimationStart:()=>{},onAnimationComplete:()=>{q.current&&(q.current.style.width="100%",window.dispatchEvent(new Event("resize")))},className:"min-w-0 overflow-hidden h-full flex flex-col",children:(0,n.jsx)("div",{ref:q,className:"w-full h-full flex flex-col",children:(0,n.jsx)(a.m,{data:I||{},selectedRooms:S,minArea:N,maxArea:y,interval:R,onDataPointClick:V,height:E?"100%":void 0,chartId:B})})}),(0,n.jsx)(p.N,{mode:"wait",children:E&&(0,n.jsx)(m.P.div,{initial:{opacity:0,x:50,width:0},animate:{opacity:1,x:0,width:"40%"},exit:{opacity:0,x:50,width:0},transition:{type:"spring",stiffness:300,damping:35},className:"min-w-0 h-full flex",children:(0,n.jsx)(G,{})})})]})})]})}}}]);