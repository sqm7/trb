(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{3951:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>l});var t=r(95155),i=r(95542),n=r(86120);let a=(0,r(37206).default)(()=>Promise.all([r.e(6648),r.e(1761),r.e(6994),r.e(2560)]).then(r.bind(r,62560)),{loadableGenerated:{webpack:()=>[62560]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-900 rounded-xl border border-white/5",children:(0,t.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"h-10 w-10 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"Initializing Geospatial Engine..."})]})})}),l=(0,n.i)(function(){return(0,t.jsx)(i.e,{children:(0,t.jsxs)("div",{className:"flex flex-col h-[calc(100vh-8rem)] gap-6 animate-in fade-in zoom-in-95 duration-500",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"地圖分析實驗室"}),(0,t.jsx)("p",{className:"text-zinc-400 text-sm",children:"整合 OpenStreetMap 與政府開放圖資的空間分析工具。"})]})}),(0,t.jsx)("div",{className:"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 p-1 relative overflow-hidden",children:(0,t.jsx)(a,{})})]})})})},21657:(e,s,r)=>{Promise.resolve().then(r.bind(r,3951))},86120:(e,s,r)=>{"use strict";r.d(s,{b:()=>h,i:()=>m});var t=r(95155),i=r(12115),n=r(73321),a=r(16385),l=r(39430),c=r(62032),o=r(66614),d=r(80723);function x(){let e=(0,n.useRouter)();return(0,t.jsxs)("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-red-600/10 rounded-full blur-[128px] pointer-events-none"}),(0,t.jsx)("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-amber-600/10 rounded-full blur-[128px] pointer-events-none"}),(0,t.jsx)("div",{className:"relative z-10 max-w-md w-full",children:(0,t.jsxs)(l.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-zinc-900/50 backdrop-blur-xl border border-red-500/20 rounded-3xl p-8 shadow-2xl overflow-hidden",children:[(0,t.jsxs)(l.P.div,{className:"w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-red-500/20 relative",initial:{rotate:-180,opacity:0},animate:{rotate:0,opacity:1},transition:{delay:.2,type:"spring"},children:[(0,t.jsx)(c.A,{className:"w-10 h-10 text-red-500"}),(0,t.jsx)(l.P.div,{className:"absolute inset-0 bg-red-500/20 rounded-full",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}})]}),(0,t.jsxs)("div",{className:"text-center space-y-3 mb-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"Access Denied"}),(0,t.jsxs)("p",{className:"text-zinc-400 text-sm leading-relaxed",children:["權限不足。此區域僅限系統管理員訪問。",(0,t.jsx)("br",{}),"若您認為這是錯誤，請聯繫技術支援。"]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"w-full flex items-center justify-center gap-2 bg-white text-black hover:bg-zinc-200 font-bold py-3.5 px-4 rounded-xl transition-all active:scale-[0.98]",children:[(0,t.jsx)(o.A,{className:"w-4 h-4"}),"返回主控台 (Dashboard)"]}),(0,t.jsxs)("button",{onClick:()=>e.back(),className:"w-full flex items-center justify-center gap-2 bg-transparent hover:bg-white/5 text-zinc-400 hover:text-white font-medium py-3.5 px-4 rounded-xl border border-white/5 hover:border-white/10 transition-all active:scale-[0.98]",children:[(0,t.jsx)(d.A,{className:"w-4 h-4"}),"回上一頁"]})]}),(0,t.jsx)(l.P.div,{className:"mt-8 pt-6 border-t border-white/5 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},children:(0,t.jsx)("p",{className:"text-[10px] text-zinc-600 font-mono uppercase tracking-widest",children:"Error: 403_FORBIDDEN"})})]})})]})}function h(){let[e,s]=(0,i.useState)({user:null,isAdmin:!1,isLoading:!0,error:null});return(0,i.useEffect)(()=>{let e=async()=>{try{let{data:{session:e},error:r}=await a.N.auth.getSession();if(r)throw r;if(!e?.user)return void s({user:null,isAdmin:!1,isLoading:!1,error:null});let{data:t,error:i}=await a.N.from("profiles").select("role").eq("id",e.user.id).single();if(i){console.warn("Profile fetch error:",i),s({user:e.user,isAdmin:!1,isLoading:!1,error:null});return}s({user:e.user,isAdmin:t?.role==="admin"||t?.role==="super_admin",isLoading:!1,error:null})}catch(e){console.error("Admin auth check error:",e),s({user:null,isAdmin:!1,isLoading:!1,error:e.message})}};e();let{data:{subscription:r}}=a.N.auth.onAuthStateChange(()=>{e()});return()=>r.unsubscribe()},[]),e}function m(e){return function(s){let{user:r,isAdmin:a,isLoading:l,error:c}=h(),o=(0,n.useRouter)();return((0,i.useEffect)(()=>{l||a||o.replace("/")},[l,a,o]),l)?(0,t.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"h-8 w-8 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto"}),(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"驗證管理員權限..."})]})}):r?a?(0,t.jsx)(e,{...s}):(0,t.jsx)(x,{}):(0,t.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center space-y-4 p-8",children:[(0,t.jsx)("div",{className:"text-4xl",children:"\uD83D\uDD12"}),(0,t.jsx)("h1",{className:"text-xl font-bold text-white",children:"請先登入"}),(0,t.jsx)("p",{className:"text-zinc-500",children:"此頁面需要登入才能訪問"}),(0,t.jsx)("button",{onClick:()=>o.push("/"),className:"bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-2 rounded-lg transition-colors",children:"前往登入"})]})})}}},95542:(e,s,r)=>{"use strict";r.d(s,{e:()=>x});var t=r(95155);r(12115);var i=r(9425),n=r(68500),a=r(92564),l=r(97810),c=r(99815),o=r(92289);function d(){return(0,t.jsxs)("footer",{className:"text-center py-10 mt-12 border-t border-white/5 bg-black/20 text-zinc-500 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-6 flex-wrap px-4",children:[(0,t.jsxs)("a",{href:"https://line.me/R/ti/p/@425ohbmf",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 hover:text-[#06C755] transition-colors",title:"加入 LINE 官方帳號",children:[(0,t.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-[#06C755]/10 transition-colors",children:(0,t.jsx)(a.A,{className:"w-4 h-4"})}),(0,t.jsx)("span",{children:"官方帳號"})]}),(0,t.jsxs)("a",{href:"https://medium.com/@sqmtalk7",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 hover:text-white transition-colors",title:"閱讀開發者日誌",children:[(0,t.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-white/10 transition-colors",children:(0,t.jsx)(l.A,{className:"w-4 h-4"})}),(0,t.jsx)("span",{children:"開發者日誌"})]}),(0,t.jsxs)("a",{href:"https://www.threads.net/@sqm.talk",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 hover:text-white transition-colors",title:"追蹤 Threads",children:[(0,t.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-white/10 transition-colors",children:(0,t.jsx)(c.A,{className:"w-4 h-4"})}),(0,t.jsx)("span",{children:"Threads"})]}),(0,t.jsxs)("a",{href:"mailto:sqmtalk7@gmail.com",className:"group flex items-center gap-2 hover:text-cyan-400 transition-colors",title:"聯絡我們",children:[(0,t.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-cyan-500/10 transition-colors",children:(0,t.jsx)(o.A,{className:"w-4 h-4"})}),(0,t.jsx)("span",{children:"Email"})]})]}),(0,t.jsxs)("div",{className:"mt-8 space-y-2 text-xs text-zinc-600",children:[(0,t.jsx)("p",{children:"資料來源：內政部實價登錄"}),(0,t.jsx)("p",{children:"版權所有 \xa9 2025 平米內參. 保留一切權利."})]})]})}function x({children:e}){return(0,t.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,t.jsx)(i.Sidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-20 min-w-0 transition-all duration-300",children:[(0,t.jsx)(n.Header,{}),(0,t.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:[(0,t.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 min-h-[calc(100vh-12rem)]",children:e}),(0,t.jsx)(d,{})]})]})]})}}},e=>{e.O(0,[4764,5969,3242,6119,5772,9262,8500,8441,3794,7358],()=>e(e.s=21657)),_N_E=e.O()}]);