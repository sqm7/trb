(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{3951:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});var t=s(95155),i=s(58822),n=s(18648);let l=(0,s(37206).default)(()=>Promise.all([s.e(6648),s.e(1761),s.e(6994),s.e(2560)]).then(s.bind(s,62560)),{loadableGenerated:{webpack:()=>[62560]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-900 rounded-xl border border-white/5",children:(0,t.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"h-10 w-10 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"Initializing Geospatial Engine..."})]})})}),a=(0,n.i)(function(){return(0,t.jsx)(i.e,{children:(0,t.jsxs)("div",{className:"flex flex-col h-[calc(100vh-8rem)] gap-6 animate-in fade-in zoom-in-95 duration-500",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"地圖分析實驗室"}),(0,t.jsx)("p",{className:"text-zinc-400 text-sm",children:"整合 OpenStreetMap 與政府開放圖資的空間分析工具。"})]})}),(0,t.jsx)("div",{className:"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 p-1 relative overflow-hidden",children:(0,t.jsx)(l,{})})]})})})},14182:(e,r,s)=>{Promise.resolve().then(s.bind(s,3951))},18648:(e,r,s)=>{"use strict";s.d(r,{b:()=>c,i:()=>d});var t=s(95155),i=s(12115),n=s(73321),l=s(16385),a=s(85864);function c(){let[e,r]=(0,i.useState)({user:null,isAdmin:!1,isLoading:!0,error:null});return(0,i.useEffect)(()=>{let e=async()=>{try{let{data:{session:e},error:s}=await l.N.auth.getSession();if(s)throw s;let t=e?.user||null;if(!t){let{data:{user:e}}=await l.N.auth.getUser();t=e}if(!t)return void r({user:null,isAdmin:!1,isLoading:!1,error:null});let{data:i,error:n}=await l.N.from("profiles").select("role").eq("id",t.id).single();if(n){console.warn("Profile fetch error:",n),r({user:t,isAdmin:!1,isLoading:!1,error:null});return}r({user:t,isAdmin:i?.role==="admin"||i?.role==="super_admin",isLoading:!1,error:null})}catch(e){console.error("Admin auth check error:",e),r({user:null,isAdmin:!1,isLoading:!1,error:e.message})}};e();let{data:{subscription:s}}=l.N.auth.onAuthStateChange(()=>{e()});return()=>s.unsubscribe()},[]),e}function d(e){return function(r){let{user:s,isAdmin:l,isLoading:d,error:o}=c(),m=(0,n.useRouter)();return((0,i.useEffect)(()=>{d||l||m.replace("/")},[d,l,m]),d)?(0,t.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"h-8 w-8 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto"}),(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:"驗證管理員權限..."})]})}):l?(0,t.jsx)(e,{...r}):(0,t.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,t.jsx)(a.O,{type:"forbidden"})})}}},58822:(e,r,s)=>{"use strict";s.d(r,{e:()=>l});var t=s(95155);s(12115);var i=s(9425),n=s(68500);function l({children:e}){return(0,t.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,t.jsx)(i.Sidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-20 min-w-0 transition-all duration-300",children:[(0,t.jsx)(n.Header,{}),(0,t.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:[(0,t.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 min-h-[calc(100vh-12rem)]",children:e}),(0,t.jsxs)("footer",{className:"py-8 text-center border-t border-white/5 mt-8",children:[(0,t.jsx)("p",{className:"text-zinc-600 text-sm font-medium",children:"\xa9 2026 平米內參 sqmtalk.com. All rights reserved."}),(0,t.jsx)("a",{href:"mailto:sqmtalk7@gmail.com",className:"block mt-2 text-zinc-700 hover:text-cyan-500 text-xs transition-colors",children:"Contact: sqmtalk7@gmail.com"})]})]})]})]})}}},e=>{e.O(0,[4764,3242,5969,6119,5772,8242,8500,5864,8441,3794,7358],()=>e(e.s=14182)),_N_E=e.O()}]);