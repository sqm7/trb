(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{3951:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(95155),s=r(12115),l=r(95542),i=r(86120);let a=(0,r(37206).default)(()=>Promise.all([r.e(2366),r.e(5600),r.e(117)]).then(r.bind(r,117)),{loadableGenerated:{webpack:()=>[117]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-900 rounded-xl border border-white/5",children:(0,n.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,n.jsx)("div",{className:"h-10 w-10 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),(0,n.jsx)("p",{className:"text-zinc-500 text-sm",children:"Initializing Geospatial Engine..."})]})})}),c=(0,i.i)(function(){let[e]=(0,s.useState)(!0);return(0,n.jsx)(l.e,{children:(0,n.jsxs)("div",{className:e?"fixed inset-y-0 left-0 right-0 lg:left-20 z-50 flex flex-col gap-4 bg-zinc-950 p-4":"flex flex-col h-[calc(100vh-8rem)] gap-6 animate-in fade-in zoom-in-95 duration-500",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"地圖分析實驗室"}),(0,n.jsx)("p",{className:"text-zinc-400 text-sm",children:"MapLibre + MapTiler 地圖環境建置（3D / 平面切換）。"})]})}),(0,n.jsx)("div",{className:"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 p-1 relative overflow-hidden",children:(0,n.jsx)(a,{})})]})})})},5214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return n.workAsyncStorageInstance}});let n=r(17828)},17828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,r(64054).createAsyncLocalStorage)()},21957:(e,t,r)=>{"use strict";function n({moduleIds:e}){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}}),r(95155),r(47650),r(5214),r(2451),r(53887)},37206:(e,t,r)=>{"use strict";r.d(t,{default:()=>s.a});var n=r(75707),s=r.n(n)},41112:(e,t,r)=>{"use strict";function n({reason:e,children:t}){return t}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(1980)},48488:(e,t,r)=>{Promise.resolve().then(r.bind(r,3951))},62032:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(78340).A)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},64054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={bindSnapshot:function(){return c},createAsyncLocalStorage:function(){return a},createSnapshot:function(){return o}};for(var n in r)Object.defineProperty(t,n,{enumerable:!0,get:r[n]});let s=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class l{disable(){throw s}getStore(){}run(){throw s}exit(){throw s}enterWith(){throw s}static bind(e){return e}}let i="u">typeof globalThis&&globalThis.AsyncLocalStorage;function a(){return i?new i:new l}function c(e){return i?i.bind(e):l.bind(e)}function o(){return i?i.snapshot():function(e,...t){return e(...t)}}},66614:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(78340).A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},68635:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=r(95155),s=r(12115),l=r(41112);function i(e){return{default:e&&"default"in e?e.default:e}}r(21957);let a={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},c=function(e){let t={...a,...e},r=(0,s.lazy)(()=>t.loader().then(i)),c=t.loading;function o(e){let i=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,a=!t.ssr||!!t.loading,o=a?s.Suspense:s.Fragment,d=t.ssr?(0,n.jsxs)(n.Fragment,{children:[null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(o,{...a?{fallback:i}:{},children:d})}return o.displayName="LoadableComponent",o}},75707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let n=r(73623)._(r(68635));function s(e,t){let r={};"function"==typeof e&&(r.loader=e);let s={...r,...t};return(0,n.default)({...s,modules:s.loadableGenerated?.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},80723:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(78340).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},86120:(e,t,r)=>{"use strict";r.d(t,{b:()=>h,i:()=>m});var n=r(95155),s=r(12115),l=r(73321),i=r(16385),a=r(39430),c=r(62032),o=r(66614),d=r(80723);function u(){let e=(0,l.useRouter)();return(0,n.jsxs)("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-red-600/10 rounded-full blur-[128px] pointer-events-none"}),(0,n.jsx)("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-amber-600/10 rounded-full blur-[128px] pointer-events-none"}),(0,n.jsx)("div",{className:"relative z-10 max-w-md w-full",children:(0,n.jsxs)(a.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-zinc-900/50 backdrop-blur-xl border border-red-500/20 rounded-3xl p-8 shadow-2xl overflow-hidden",children:[(0,n.jsxs)(a.P.div,{className:"w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-red-500/20 relative",initial:{rotate:-180,opacity:0},animate:{rotate:0,opacity:1},transition:{delay:.2,type:"spring"},children:[(0,n.jsx)(c.A,{className:"w-10 h-10 text-red-500"}),(0,n.jsx)(a.P.div,{className:"absolute inset-0 bg-red-500/20 rounded-full",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}})]}),(0,n.jsxs)("div",{className:"text-center space-y-3 mb-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"Access Denied"}),(0,n.jsxs)("p",{className:"text-zinc-400 text-sm leading-relaxed",children:["權限不足。此區域僅限系統管理員訪問。",(0,n.jsx)("br",{}),"若您認為這是錯誤，請聯繫技術支援。"]})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"w-full flex items-center justify-center gap-2 bg-white text-black hover:bg-zinc-200 font-bold py-3.5 px-4 rounded-xl transition-all active:scale-[0.98]",children:[(0,n.jsx)(o.A,{className:"w-4 h-4"}),"返回主控台 (Dashboard)"]}),(0,n.jsxs)("button",{onClick:()=>e.back(),className:"w-full flex items-center justify-center gap-2 bg-transparent hover:bg-white/5 text-zinc-400 hover:text-white font-medium py-3.5 px-4 rounded-xl border border-white/5 hover:border-white/10 transition-all active:scale-[0.98]",children:[(0,n.jsx)(d.A,{className:"w-4 h-4"}),"回上一頁"]})]}),(0,n.jsx)(a.P.div,{className:"mt-8 pt-6 border-t border-white/5 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},children:(0,n.jsx)("p",{className:"text-[10px] text-zinc-600 font-mono uppercase tracking-widest",children:"Error: 403_FORBIDDEN"})})]})})]})}function h(){let[e,t]=(0,s.useState)({user:null,isAdmin:!1,permissions:{canPostAnnouncement:!1,accessibleCounties:[],isSuperAdmin:!1},isLoading:!0,error:null});return(0,s.useEffect)(()=>{let e=async()=>{try{let{data:{session:e},error:r}=await i.N.auth.getSession();if(r)throw r;if(!e?.user)return void t({user:null,isAdmin:!1,permissions:{canPostAnnouncement:!1,accessibleCounties:[],isSuperAdmin:!1},isLoading:!1,error:null});let{data:n,error:s}=await i.N.from("profiles").select("role, accessible_counties, can_post_announcement").eq("id",e.user.id).single();if(s){console.warn("Profile fetch error:",s),t({user:e.user,isAdmin:!1,permissions:{canPostAnnouncement:!1,accessibleCounties:[],isSuperAdmin:!1},isLoading:!1,error:null});return}let l=n?.role==="super_admin",a=n?.role==="admin"||l,c=l?null:n?.accessible_counties,o=!!l||n?.can_post_announcement||!1;t({user:e.user,isAdmin:a,permissions:{canPostAnnouncement:o,accessibleCounties:c,isSuperAdmin:l},isLoading:!1,error:null})}catch(e){console.error("Admin auth check error:",e),t({user:null,isAdmin:!1,permissions:{canPostAnnouncement:!1,accessibleCounties:[],isSuperAdmin:!1},isLoading:!1,error:e.message})}};e();let{data:{subscription:r}}=i.N.auth.onAuthStateChange(()=>{e()});return()=>r.unsubscribe()},[]),e}function m(e){return function(t){let{user:r,isAdmin:i,isLoading:a,error:c}=h(),o=(0,l.useRouter)();return((0,s.useEffect)(()=>{a||i||o.replace("/")},[a,i,o]),a)?(0,n.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)("div",{className:"h-8 w-8 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto"}),(0,n.jsx)("p",{className:"text-zinc-500 text-sm",children:"驗證管理員權限..."})]})}):r?i?(0,n.jsx)(e,{...t}):(0,n.jsx)(u,{}):(0,n.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center space-y-4 p-8",children:[(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDD12"}),(0,n.jsx)("h1",{className:"text-xl font-bold text-white",children:"請先登入"}),(0,n.jsx)("p",{className:"text-zinc-500",children:"此頁面需要登入才能訪問"}),(0,n.jsx)("button",{onClick:()=>o.push("/"),className:"bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-2 rounded-lg transition-colors",children:"前往登入"})]})})}}},92289:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(78340).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},95542:(e,t,r)=>{"use strict";r.d(t,{e:()=>u});var n=r(95155);r(12115);var s=r(9425),l=r(68500),i=r(92289);let a=({className:e})=>(0,n.jsx)("svg",{role:"img",viewBox:"0 0 24 24",fill:"currentColor",className:e,children:(0,n.jsx)("path",{d:"M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"})}),c=({className:e})=>(0,n.jsx)("svg",{role:"img",viewBox:"0 0 24 24",fill:"currentColor",className:e,children:(0,n.jsx)("path",{d:"M4.21 0A4.201 4.201 0 0 0 0 4.21v15.58A4.201 4.201 0 0 0 4.21 24h15.58A4.201 4.201 0 0 0 24 19.79v-1.093c-.137.013-.278.02-.422.02-2.577 0-4.027-2.146-4.09-4.832a7.592 7.592 0 0 1 .022-.708c.093-1.186.475-2.241 1.105-3.022a3.885 3.885 0 0 1 1.395-1.1c.468-.237 1.127-.367 1.664-.367h.023c.101 0 .202.004.303.01V4.211A4.201 4.201 0 0 0 19.79 0Zm.198 5.583h4.165l3.588 8.435 3.59-8.435h3.864v.146l-.019.004c-.705.16-1.063.397-1.063 1.254h-.003l.003 10.274c.06.676.424.885 1.063 1.03l.02.004v.145h-4.923v-.145l.019-.005c.639-.144.994-.353 1.054-1.03V7.267l-4.745 11.15h-.261L6.15 7.569v9.445c0 .857.358 1.094 1.063 1.253l.02.004v.147H4.405v-.147l.019-.004c.705-.16 1.065-.397 1.065-1.253V6.987c0-.857-.358-1.094-1.064-1.254l-.018-.004zm19.25 3.668c-1.086.023-1.733 1.323-1.813 3.124H24V9.298a1.378 1.378 0 0 0-.342-.047Zm-1.862 3.632c-.1 1.756.86 3.239 2.204 3.634v-3.634z"})}),o=({className:e})=>(0,n.jsx)("svg",{role:"img",viewBox:"0 0 24 24",fill:"currentColor",className:e,children:(0,n.jsx)("path",{d:"M12.186 24h-.007c-3.581-.024-6.334-1.205-8.184-3.509C2.35 18.44 1.5 15.586 1.472 12.01v-.017c.03-3.579.879-6.43 2.525-8.482C5.845 1.205 8.6.024 12.18 0h.014c2.746.02 5.043.725 6.826 2.098 1.677 1.29 2.858 3.13 3.509 5.467l-2.04.569c-1.104-3.96-3.898-5.984-8.304-6.015-2.91.022-5.11.936-6.54 2.717C4.307 6.504 3.616 8.914 3.589 12c.027 3.086.718 5.496 2.057 7.164 1.43 1.783 3.631 2.698 6.54 2.717 2.623-.02 4.358-.631 5.8-2.045 1.647-1.613 1.618-3.593 1.09-4.798-.31-.71-.873-1.3-1.634-1.75-.192 1.352-.622 2.446-1.284 3.272-.886 1.102-2.14 1.704-3.73 1.79-1.202.065-2.361-.218-3.259-.801-1.063-.689-1.685-1.74-1.752-2.964-.065-1.19.408-2.285 1.33-3.082.88-.76 2.119-1.207 3.583-1.291a13.853 13.853 0 0 1 3.02.142c-.126-.742-.375-1.332-.75-1.757-.513-.586-1.308-.883-2.359-.89h-.029c-.844 0-1.992.232-2.721 1.32L7.734 7.847c.98-1.454 2.568-2.256 4.478-2.256h.044c3.194.02 5.097 1.975 5.287 5.388.108.046.216.094.321.142 1.49.7 2.58 1.761 3.154 3.07.797 1.82.871 4.79-1.548 7.158-1.85 1.81-4.094 2.628-7.277 2.65Zm1.003-11.69c-.242 0-.487.007-.739.021-1.836.103-2.98.946-2.916 2.143.067 1.256 1.452 1.839 2.784 1.767 1.224-.065 2.818-.543 3.086-3.71a10.5 10.5 0 0 0-2.215-.221z"})});function d(){return(0,n.jsxs)("footer",{className:"text-center py-10 mt-12 border-t border-white/5 bg-black/20 text-zinc-500 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-6 flex-wrap px-4",children:[(0,n.jsxs)("a",{href:"https://line.me/R/ti/p/@425ohbmf",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 hover:text-[#06C755] transition-colors",title:"加入 LINE 官方帳號",children:[(0,n.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-[#06C755]/10 transition-colors",children:(0,n.jsx)(a,{className:"w-4 h-4"})}),(0,n.jsx)("span",{children:"官方帳號"})]}),(0,n.jsxs)("a",{href:"https://medium.com/@sqmtalk7",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 hover:text-white transition-colors",title:"閱讀開發者日誌",children:[(0,n.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-white/10 transition-colors",children:(0,n.jsx)(c,{className:"w-4 h-4"})}),(0,n.jsx)("span",{children:"開發者日誌"})]}),(0,n.jsxs)("a",{href:"https://www.threads.net/@sqm.talk",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 hover:text-white transition-colors",title:"追蹤 Threads",children:[(0,n.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-white/10 transition-colors",children:(0,n.jsx)(o,{className:"w-4 h-4"})}),(0,n.jsx)("span",{children:"Threads"})]}),(0,n.jsxs)("a",{href:"mailto:sqmtalk7@gmail.com",className:"group flex items-center gap-2 hover:text-cyan-400 transition-colors",title:"聯絡我們",children:[(0,n.jsx)("div",{className:"p-2 rounded-full bg-zinc-900 group-hover:bg-cyan-500/10 transition-colors",children:(0,n.jsx)(i.A,{className:"w-4 h-4"})}),(0,n.jsx)("span",{children:"Email"})]})]}),(0,n.jsxs)("div",{className:"mt-8 space-y-2 text-xs text-zinc-600",children:[(0,n.jsx)("p",{children:"資料來源：內政部實價登錄"}),(0,n.jsx)("p",{children:"版權所有 \xa9 2025 平米內參. 保留一切權利."})]})]})}function u({children:e}){return(0,n.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,n.jsx)(s.Sidebar,{}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-20 min-w-0 transition-all duration-300",children:[(0,n.jsx)(l.Header,{}),(0,n.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:[(0,n.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 min-h-[calc(100vh-12rem)]",children:e}),(0,n.jsx)(d,{})]})]})]})}}},e=>{e.O(0,[4764,8409,5969,6119,5772,3380,8500,8441,3794,7358],()=>e(e.s=48488)),_N_E=e.O()}]);