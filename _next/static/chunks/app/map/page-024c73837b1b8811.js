(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{3951:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var i=r(95155),l=r(58822),s=r(18648);let n=(0,r(37206).default)(()=>Promise.all([r.e(6648),r.e(1761),r.e(6994),r.e(2560)]).then(r.bind(r,62560)),{loadableGenerated:{webpack:()=>[62560]},ssr:!1,loading:()=>(0,i.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-900 rounded-xl border border-white/5",children:(0,i.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,i.jsx)("div",{className:"h-10 w-10 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),(0,i.jsx)("p",{className:"text-zinc-500 text-sm",children:"Initializing Geospatial Engine..."})]})})}),a=(0,s.i)(function(){return(0,i.jsx)(l.e,{children:(0,i.jsxs)("div",{className:"flex flex-col h-[calc(100vh-8rem)] gap-6 animate-in fade-in zoom-in-95 duration-500",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"地圖分析實驗室"}),(0,i.jsx)("p",{className:"text-zinc-400 text-sm",children:"整合 OpenStreetMap 與政府開放圖資的空間分析工具。"})]})}),(0,i.jsx)("div",{className:"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 p-1 relative overflow-hidden",children:(0,i.jsx)(n,{})})]})})})},14182:(e,t,r)=>{Promise.resolve().then(r.bind(r,3951))},18648:(e,t,r)=>{"use strict";r.d(t,{b:()=>o,i:()=>d});var i=r(95155),l=r(12115),s=r(73321),n=r(16385),a=r(85864);function o(){let[e,t]=(0,l.useState)({user:null,isAdmin:!1,isLoading:!0,error:null});return(0,l.useEffect)(()=>{let e=async()=>{try{let{data:{session:e},error:r}=await n.N.auth.getSession();if(r)throw r;if(!e?.user)return void t({user:null,isAdmin:!1,isLoading:!1,error:null});let{data:i,error:l}=await n.N.from("profiles").select("role").eq("id",e.user.id).single();if(l){console.warn("Profile fetch error:",l),t({user:e.user,isAdmin:!1,isLoading:!1,error:null});return}t({user:e.user,isAdmin:i?.role==="admin"||i?.role==="super_admin",isLoading:!1,error:null})}catch(e){console.error("Admin auth check error:",e),t({user:null,isAdmin:!1,isLoading:!1,error:e.message})}};e();let{data:{subscription:r}}=n.N.auth.onAuthStateChange(()=>{e()});return()=>r.unsubscribe()},[]),e}function d(e){return function(t){let{user:r,isAdmin:n,isLoading:d,error:c}=o(),u=(0,s.useRouter)();return((0,l.useEffect)(()=>{d||n||u.replace("/")},[d,n,u]),d)?(0,i.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center space-y-4",children:[(0,i.jsx)("div",{className:"h-8 w-8 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto"}),(0,i.jsx)("p",{className:"text-zinc-500 text-sm",children:"驗證管理員權限..."})]})}):r?n?(0,i.jsx)(e,{...t}):(0,i.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,i.jsx)(a.O,{type:"forbidden"})}):(0,i.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,i.jsx)(a.O,{type:"login"})})}}},58822:(e,t,r)=>{"use strict";r.d(t,{e:()=>n});var i=r(95155);r(12115);var l=r(9425),s=r(68500);function n({children:e}){return(0,i.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,i.jsx)(l.Sidebar,{}),(0,i.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-20 min-w-0 transition-all duration-300",children:[(0,i.jsx)(s.Header,{}),(0,i.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:[(0,i.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 min-h-[calc(100vh-12rem)]",children:e}),(0,i.jsxs)("footer",{className:"py-8 text-center border-t border-white/5 mt-8",children:[(0,i.jsx)("p",{className:"text-zinc-600 text-sm font-medium",children:"\xa9 2026 平米內參 sqmtalk.com. All rights reserved."}),(0,i.jsx)("a",{href:"mailto:sqmtalk7@gmail.com",className:"block mt-2 text-zinc-700 hover:text-cyan-500 text-xs transition-colors",children:"Contact: sqmtalk7@gmail.com"})]})]})]})]})}},85864:(e,t,r)=>{"use strict";r.d(t,{O:()=>c});var i=r(95155);r(12115);var l=r(73321),s=r(25777),n=r(62032),a=r(86901),o=r(54452),d=r(89239);function c({type:e="forbidden",title:t,description:r,actionLabel:c,onAction:u,showHomeButton:x=!0}){let m=(0,l.useRouter)(),h={login:{icon:s.A,defaultTitle:"請先登入",defaultDesc:"此頁面需要登入會員才能訪問。請登入以解鎖完整功能。",color:"text-cyan-400",glow:"shadow-[0_0_50px_-12px_rgba(34,211,238,0.2)]",border:"border-cyan-500/30",bgGradient:"from-cyan-500/10 to-transparent",buttonColor:"bg-cyan-600 hover:bg-cyan-500 text-white",defaultActionLabel:"前往登入",defaultAction:()=>m.push("/")},forbidden:{icon:n.A,defaultTitle:"權限不足",defaultDesc:"您沒有權限訪問此頁面。此區域僅限管理員或特定角色進入。",color:"text-red-400",glow:"shadow-[0_0_50px_-12px_rgba(248,113,113,0.2)]",border:"border-red-500/30",bgGradient:"from-red-500/10 to-transparent",buttonColor:"bg-red-600 hover:bg-red-500 text-white",defaultActionLabel:"返回首頁",defaultAction:()=>m.push("/dashboard")},upgrade:{icon:a.A,defaultTitle:"需要升級會員",defaultDesc:"此功能僅開放給 Pro 以上會員使用。升級解鎖無限分析與專業報表功能。",color:"text-violet-400",glow:"shadow-[0_0_50px_-12px_rgba(139,92,246,0.25)]",border:"border-violet-500/30",bgGradient:"from-violet-500/10 to-transparent",buttonColor:"bg-violet-600 hover:bg-violet-500 text-white shadow-lg shadow-violet-900/20",defaultActionLabel:"立即升級",defaultAction:()=>m.push("/pricing")}}[e],f=h.icon,b=u||h.defaultAction,g=t||h.defaultTitle,p=r||h.defaultDesc,v=c||h.defaultActionLabel;return(0,i.jsx)("div",{className:"min-h-[80vh] w-full flex items-center justify-center p-4",children:(0,i.jsxs)("div",{className:`relative group max-w-md w-full bg-zinc-900/40 backdrop-blur-xl border ${h.border} rounded-3xl p-8 flex flex-col items-center text-center ${h.glow} transition-all duration-500`,children:[(0,i.jsx)("div",{className:`absolute inset-0 bg-gradient-to-b ${h.bgGradient} rounded-3xl pointer-events-none opacity-50`}),(0,i.jsx)("div",{className:`relative mb-6 p-4 rounded-full bg-zinc-900/80 border border-zinc-800 ${h.glow}`,children:(0,i.jsx)(f,{className:`w-8 h-8 ${h.color}`})}),(0,i.jsx)("h2",{className:"relative text-2xl font-bold text-white mb-3 tracking-tight",children:g}),(0,i.jsx)("p",{className:"relative text-zinc-400 text-sm leading-relaxed mb-8",children:p}),(0,i.jsxs)("div",{className:"relative w-full space-y-3",children:[(0,i.jsxs)(d.$,{onClick:b,className:`w-full h-11 rounded-xl font-medium transition-all ${h.buttonColor}`,children:["login"===e&&(0,i.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"upgrade"===e&&(0,i.jsx)(a.A,{className:"w-4 h-4 mr-2"}),v]}),x&&"forbidden"!==e&&(0,i.jsx)(d.$,{variant:"ghost",onClick:()=>m.push("/dashboard"),className:"w-full h-11 text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800/50 rounded-xl",children:"返回首頁"})]})]})})}}},e=>{e.O(0,[4764,3242,6119,1819,157,8500,8441,3794,7358],()=>e(e.s=14182)),_N_E=e.O()}]);