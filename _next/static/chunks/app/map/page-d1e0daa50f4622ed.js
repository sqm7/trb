(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{3951:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(95155),s=r(58822),l=r(18648);let i=(0,r(37206).default)(()=>Promise.all([r.e(6648),r.e(1761),r.e(6994),r.e(2560)]).then(r.bind(r,62560)),{loadableGenerated:{webpack:()=>[62560]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-900 rounded-xl border border-white/5",children:(0,n.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,n.jsx)("div",{className:"h-10 w-10 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),(0,n.jsx)("p",{className:"text-zinc-500 text-sm",children:"Initializing Geospatial Engine..."})]})})}),a=(0,l.i)(function(){return(0,n.jsx)(s.e,{children:(0,n.jsxs)("div",{className:"flex flex-col h-[calc(100vh-8rem)] gap-6 animate-in fade-in zoom-in-95 duration-500",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"地圖分析實驗室"}),(0,n.jsx)("p",{className:"text-zinc-400 text-sm",children:"整合 OpenStreetMap 與政府開放圖資的空間分析工具。"})]})}),(0,n.jsx)("div",{className:"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 p-1 relative overflow-hidden",children:(0,n.jsx)(i,{})})]})})})},5214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return n.workAsyncStorageInstance}});let n=r(17828)},14182:(e,t,r)=>{Promise.resolve().then(r.bind(r,3951))},17828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,r(64054).createAsyncLocalStorage)()},18648:(e,t,r)=>{"use strict";r.d(t,{b:()=>a,i:()=>c});var n=r(95155),s=r(12115),l=r(73321),i=r(16385);function a(){let[e,t]=(0,s.useState)({user:null,isAdmin:!1,isLoading:!0,error:null});return(0,s.useEffect)(()=>{let e=async()=>{try{let{data:{session:e},error:r}=await i.N.auth.getSession();if(r)throw r;if(!e?.user)return void t({user:null,isAdmin:!1,isLoading:!1,error:null});let{data:n,error:s}=await i.N.from("profiles").select("role").eq("id",e.user.id).single();if(s){console.warn("Profile fetch error:",s),t({user:e.user,isAdmin:!1,isLoading:!1,error:null});return}t({user:e.user,isAdmin:n?.role==="admin"||n?.role==="super_admin",isLoading:!1,error:null})}catch(e){console.error("Admin auth check error:",e),t({user:null,isAdmin:!1,isLoading:!1,error:e.message})}};e();let{data:{subscription:r}}=i.N.auth.onAuthStateChange(()=>{e()});return()=>r.unsubscribe()},[]),e}function c(e){return function(t){let{user:r,isAdmin:i,isLoading:c,error:o}=a(),d=(0,l.useRouter)();return((0,s.useEffect)(()=>{c||i||d.replace("/")},[c,i,d]),c)?(0,n.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)("div",{className:"h-8 w-8 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto"}),(0,n.jsx)("p",{className:"text-zinc-500 text-sm",children:"驗證管理員權限..."})]})}):r?i?(0,n.jsx)(e,{...t}):(0,n.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center space-y-4 p-8",children:[(0,n.jsx)("div",{className:"text-4xl",children:"⛔"}),(0,n.jsx)("h1",{className:"text-xl font-bold text-white",children:"權限不足"}),(0,n.jsx)("p",{className:"text-zinc-500",children:"此頁面僅限管理員訪問"}),(0,n.jsx)("button",{onClick:()=>d.push("/dashboard"),className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-2 rounded-lg transition-colors",children:"返回首頁"})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center space-y-4 p-8",children:[(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDD12"}),(0,n.jsx)("h1",{className:"text-xl font-bold text-white",children:"請先登入"}),(0,n.jsx)("p",{className:"text-zinc-500",children:"此頁面需要登入才能訪問"}),(0,n.jsx)("button",{onClick:()=>d.push("/"),className:"bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-2 rounded-lg transition-colors",children:"前往登入"})]})})}}},21957:(e,t,r)=>{"use strict";function n({moduleIds:e}){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}}),r(95155),r(47650),r(5214),r(2451),r(53887)},37206:(e,t,r)=>{"use strict";r.d(t,{default:()=>s.a});var n=r(75707),s=r.n(n)},41112:(e,t,r)=>{"use strict";function n({reason:e,children:t}){return t}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(1980)},58822:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var n=r(95155);r(12115);var s=r(9425),l=r(68500);function i({children:e}){return(0,n.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,n.jsx)(s.Sidebar,{}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-20 min-w-0 transition-all duration-300",children:[(0,n.jsx)(l.Header,{}),(0,n.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:[(0,n.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 min-h-[calc(100vh-12rem)]",children:e}),(0,n.jsxs)("footer",{className:"py-8 text-center border-t border-white/5 mt-8",children:[(0,n.jsx)("p",{className:"text-zinc-600 text-sm font-medium",children:"\xa9 2026 平米內參 sqmtalk.com. All rights reserved."}),(0,n.jsx)("a",{href:"mailto:sqmtalk7@gmail.com",className:"block mt-2 text-zinc-700 hover:text-cyan-500 text-xs transition-colors",children:"Contact: sqmtalk7@gmail.com"})]})]})]})]})}},64054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={bindSnapshot:function(){return c},createAsyncLocalStorage:function(){return a},createSnapshot:function(){return o}};for(var n in r)Object.defineProperty(t,n,{enumerable:!0,get:r[n]});let s=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class l{disable(){throw s}getStore(){}run(){throw s}exit(){throw s}enterWith(){throw s}static bind(e){return e}}let i="u">typeof globalThis&&globalThis.AsyncLocalStorage;function a(){return i?new i:new l}function c(e){return i?i.bind(e):l.bind(e)}function o(){return i?i.snapshot():function(e,...t){return e(...t)}}},68635:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=r(95155),s=r(12115),l=r(41112);function i(e){return{default:e&&"default"in e?e.default:e}}r(21957);let a={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},c=function(e){let t={...a,...e},r=(0,s.lazy)(()=>t.loader().then(i)),c=t.loading;function o(e){let i=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,a=!t.ssr||!!t.loading,o=a?s.Suspense:s.Fragment,d=t.ssr?(0,n.jsxs)(n.Fragment,{children:[null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(o,{...a?{fallback:i}:{},children:d})}return o.displayName="LoadableComponent",o}},75707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let n=r(73623)._(r(68635));function s(e,t){let r={};"function"==typeof e&&(r.loader=e);let s={...r,...t};return(0,n.default)({...s,modules:s.loadableGenerated?.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},e=>{e.O(0,[4764,3242,6119,9907,8500,8441,3794,7358],()=>e(e.s=14182)),_N_E=e.O()}]);