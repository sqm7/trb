(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{3951:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var r=i(95155),a=i(58822),n=i(18648);let s=(0,i(37206).default)(()=>Promise.all([i.e(6648),i.e(1761),i.e(6994),i.e(2560)]).then(i.bind(i,62560)),{loadableGenerated:{webpack:()=>[62560]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-zinc-900 rounded-xl border border-white/5",children:(0,r.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,r.jsx)("div",{className:"h-10 w-10 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("p",{className:"text-zinc-500 text-sm",children:"Initializing Geospatial Engine..."})]})})}),l=(0,n.i)(function(){return(0,r.jsx)(a.e,{children:(0,r.jsxs)("div",{className:"flex flex-col h-[calc(100vh-8rem)] gap-6 animate-in fade-in zoom-in-95 duration-500",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"地圖分析實驗室"}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"整合 OpenStreetMap 與政府開放圖資的空間分析工具。"})]})}),(0,r.jsx)("div",{className:"flex-1 bg-zinc-900/50 rounded-2xl border border-white/5 p-1 relative overflow-hidden",children:(0,r.jsx)(s,{})})]})})})},14182:(e,t,i)=>{Promise.resolve().then(i.bind(i,3951))},18648:(e,t,i)=>{"use strict";i.d(t,{b:()=>o,i:()=>c});var r=i(95155),a=i(12115),n=i(73321),s=i(16385),l=i(85864);function o(){let[e,t]=(0,a.useState)({user:null,isAdmin:!1,isLoading:!0,error:null});return(0,a.useEffect)(()=>{let e=async()=>{try{let{data:{session:e},error:i}=await s.N.auth.getSession();if(i)throw i;if(!e?.user)return void t({user:null,isAdmin:!1,isLoading:!1,error:null});let{data:r,error:a}=await s.N.from("profiles").select("role").eq("id",e.user.id).single();if(a){console.warn("Profile fetch error:",a),t({user:e.user,isAdmin:!1,isLoading:!1,error:null});return}t({user:e.user,isAdmin:r?.role==="admin"||r?.role==="super_admin",isLoading:!1,error:null})}catch(e){console.error("Admin auth check error:",e),t({user:null,isAdmin:!1,isLoading:!1,error:e.message})}};e();let{data:{subscription:i}}=s.N.auth.onAuthStateChange(()=>{e()});return()=>i.unsubscribe()},[]),e}function c(e){return function(t){let{user:i,isAdmin:s,isLoading:c,error:d}=o(),u=(0,n.useRouter)();return((0,a.useEffect)(()=>{c||s||u.replace("/")},[c,s,u]),c)?(0,r.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"h-8 w-8 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto"}),(0,r.jsx)("p",{className:"text-zinc-500 text-sm",children:"驗證管理員權限..."})]})}):i?s?(0,r.jsx)(e,{...t}):(0,r.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,r.jsx)(l.O,{type:"forbidden"})}):(0,r.jsx)("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:(0,r.jsx)(l.O,{type:"login"})})}}},58822:(e,t,i)=>{"use strict";i.d(t,{e:()=>s});var r=i(95155);i(12115);var a=i(9425),n=i(68500);function s({children:e}){return(0,r.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,r.jsx)(a.Sidebar,{}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-20 min-w-0 transition-all duration-300",children:[(0,r.jsx)(n.Header,{}),(0,r.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8",children:[(0,r.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 min-h-[calc(100vh-12rem)]",children:e}),(0,r.jsxs)("footer",{className:"py-8 text-center border-t border-white/5 mt-8",children:[(0,r.jsx)("p",{className:"text-zinc-600 text-sm font-medium",children:"\xa9 2026 平米內參 sqmtalk.com. All rights reserved."}),(0,r.jsx)("a",{href:"mailto:sqmtalk7@gmail.com",className:"block mt-2 text-zinc-700 hover:text-cyan-500 text-xs transition-colors",children:"Contact: sqmtalk7@gmail.com"})]})]})]})]})}},85864:(e,t,i)=>{"use strict";i.d(t,{O:()=>u});var r=i(95155);i(12115);var a=i(73321),n=i(25777),s=i(62032),l=i(86901),o=i(54452),c=i(89239),d=i(39430);function u({type:e="forbidden",title:t,description:i,actionLabel:u,onAction:x,showHomeButton:m=!0}){let h=(0,a.useRouter)(),b={login:{icon:n.A,defaultTitle:"請先登入",defaultDesc:"此領域僅限會員進入。解鎖完整功能，探索無限可能。",color:"text-cyan-400",iconColor:"text-cyan-400",buttonColor:"bg-cyan-500 hover:bg-cyan-400 text-black shadow-[0_0_20px_rgba(6,182,212,0.5)]",glowColor:"rgba(34,211,238,0.4)",defaultActionLabel:"前往登入",defaultAction:()=>h.push("/")},forbidden:{icon:s.A,defaultTitle:"權限不足",defaultDesc:"您尚未獲得此區域的通行憑證。此處為管制區域。",color:"text-red-500",iconColor:"text-red-500",buttonColor:"bg-red-600 hover:bg-red-500 text-white shadow-[0_0_20px_rgba(239,68,68,0.5)]",glowColor:"rgba(239,68,68,0.4)",defaultActionLabel:"返回首頁",defaultAction:()=>h.push("/dashboard")},upgrade:{icon:l.A,defaultTitle:"需要升級會員",defaultDesc:"此功能蘊含強大力量，僅開放給 Pro 以上會員。準備好升級了嗎？",color:"text-violet-400",iconColor:"text-violet-400",buttonColor:"bg-violet-600 hover:bg-violet-500 text-white shadow-[0_0_30px_rgba(139,92,246,0.6)]",glowColor:"rgba(139,92,246,0.5)",defaultActionLabel:"立即升級",defaultAction:()=>h.push("/pricing")}}[e],f=b.icon,p=x||b.defaultAction,g=t||b.defaultTitle,v=i||b.defaultDesc,j=u||b.defaultActionLabel;return(0,r.jsxs)("div",{className:"min-h-[85vh] w-full flex items-center justify-center p-4 relative overflow-hidden",children:[(0,r.jsx)(d.P.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:1.5},children:(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] rounded-full blur-[120px] opacity-20 mix-blend-screen",style:{background:b.glowColor}})}),(0,r.jsx)(d.P.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},transition:{type:"spring",duration:.8,bounce:.2},className:"relative z-10 max-w-md w-full",children:(0,r.jsxs)("div",{className:"relative bg-zinc-900/40 backdrop-blur-2xl border border-zinc-800/50 rounded-[2.5rem] p-10 flex flex-col items-center text-center overflow-hidden group",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none"}),(0,r.jsx)(d.P.div,{animate:{y:[0,-10,0],rotate:[0,2,-2,0]},transition:{repeat:1/0,duration:4,ease:"easeInOut"},className:"relative mb-8",children:(0,r.jsxs)("div",{className:"relative p-6 rounded-3xl bg-zinc-900/50 border border-zinc-700/50 shadow-2xl backdrop-blur-sm group-hover:scale-110 transition-transform duration-500 ease-out",children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-3xl opacity-20 bg-current blur-xl",style:{color:b.glowColor}}),(0,r.jsx)(f,{className:`w-12 h-12 ${b.iconColor} relative z-10 drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]`,strokeWidth:1.5})]})}),(0,r.jsxs)(d.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:[(0,r.jsx)("h2",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-b from-white to-zinc-500 mb-4 tracking-tight",children:g}),(0,r.jsx)("p",{className:"text-zinc-400 text-base leading-relaxed mb-10 max-w-[280px] mx-auto",children:v})]}),(0,r.jsxs)(d.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"w-full space-y-4",children:[(0,r.jsx)(c.$,{onClick:p,className:`w-full h-14 text-base rounded-2xl font-bold tracking-wide transition-all hover:scale-[1.02] hover:-translate-y-1 active:scale-[0.98] ${b.buttonColor}`,children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:["login"===e&&(0,r.jsx)(o.A,{className:"w-5 h-5"}),"upgrade"===e&&(0,r.jsx)(l.A,{className:"w-5 h-5"}),j]})}),m&&"forbidden"!==e&&(0,r.jsx)(c.$,{variant:"ghost",onClick:()=>h.push("/dashboard"),className:"w-full h-12 text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800/50 rounded-2xl font-medium transition-all",children:"返回首頁"})]})]})})]})}}},e=>{e.O(0,[4764,3242,5969,6119,5772,157,8500,8441,3794,7358],()=>e(e.s=14182)),_N_E=e.O()}]);