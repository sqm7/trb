"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7534],{826:(e,t,r)=>{r.d(t,{B:()=>m});var i=r(95155),s=r(12115),n=r(47650),l=r(80642),o=r(39430),a=r(33210),d=r(44071),c=r(67514),x=r(37717);let h={height:450,paddingTop:40,paddingBottom:80,paddingLeft:100,paddingRight:40,boxWidth:60,whiskerWidth:30,whiskerStrokeWidth:1,boxStrokeWidth:1.5,medianStrokeWidth:2};function m({data:e}){let t=(0,x.A)(),[r,m]=(0,s.useState)(null),[u,b]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),[p,y]=(0,s.useState)(!1),w=(0,s.useRef)(null),j=(0,s.useRef)(null),v=(0,s.useRef)(null),k=(0,s.useMemo)(()=>({...h,colors:{upper:t.chart[1]||t.primary,lower:t.chart[0]||t.accent,whisker:t.text,median:t.text,grid:t.grid,text:t.textMuted,background:"transparent"}}),[t]);(0,s.useEffect)(()=>{y(!0)},[]),(0,s.useEffect)(()=>{let e=e=>{let t=v.current;if(t&&!t.contains(e.target)){let t=w.current;if(t&&t.contains(e.target))return;m(null)}};if(r){let t=setTimeout(()=>{document.addEventListener("click",e)},100);return()=>{clearTimeout(t),document.removeEventListener("click",e)}}},[r]);let N=(0,s.useMemo)(()=>{if(!e||0===e.length)return null;let t=e.map(e=>[e.minPrice,e.q1Price,e.medianPrice,e.q3Price,e.maxPrice].some(e=>"number"!=typeof e||isNaN(e))?null:{category:null!==e.bathrooms?`${e.roomType}-${e.bathrooms}衛`:e.roomType,min:Math.round(e.minPrice),q1:Math.round(e.q1Price),median:Math.round(e.medianPrice),q3:Math.round(e.q3Price),max:Math.round(e.maxPrice),count:e.count}).filter(Boolean);if(0===t.length)return null;let r=t.flatMap(e=>[e.min,e.q1,e.median,e.q3,e.max]),i=Math.min(...r),s=Math.max(...r),n=s-i,l=0===n?Math.max(.1*i,100):.1*n;return{items:t,yMin:Math.max(0,i-l),yMax:s+l}},[e]),M=(0,s.useMemo)(()=>{if(!N)return null;let e=j.current?.clientWidth||800,t=e-k.paddingLeft-k.paddingRight,r=k.height-k.paddingTop-k.paddingBottom,i=t/N.items.length;return{width:e,height:k.height,drawWidth:t,drawHeight:r,categoryWidth:i}},[N,k,j.current?.clientWidth]),z=(0,s.useMemo)(()=>N&&M?e=>{let t=(e-N.yMin)/(N.yMax-N.yMin);return k.paddingTop+M.drawHeight*(1-t)}:null,[N,M,k]),W=(0,s.useMemo)(()=>{if(!N)return[];let{yMin:e,yMax:t}=N,r=(t-e)/5;return Array.from({length:6},(t,i)=>Math.round(e+i*r))},[N]);return e&&0!==e.length&&N?(0,i.jsxs)("div",{ref:j,className:"relative w-full",children:[(0,i.jsx)("svg",{ref:w,width:"100%",height:k.height,className:"overflow-visible",onMouseMove:e=>{if(!w.current||!z||!N||!M)return;let t=w.current.getBoundingClientRect(),r=t.height/k.height||1,i=(e.clientY-t.top)/r;i>=k.paddingTop&&i<=k.paddingTop+M.drawHeight?g(i):g(null)},onMouseLeave:()=>{g(null)},children:M&&z&&(0,i.jsxs)(i.Fragment,{children:[W.map((e,t)=>(0,i.jsxs)("g",{children:[(0,i.jsx)("line",{x1:k.paddingLeft,y1:z(e),x2:k.paddingLeft+M.drawWidth,y2:z(e),stroke:k.colors.grid,strokeWidth:1,strokeDasharray:"4,4"}),(0,i.jsxs)("text",{x:k.paddingLeft-10,y:z(e),textAnchor:"end",dominantBaseline:"middle",fill:k.colors.text,fontSize:12,children:[e.toLocaleString()," 萬"]})]},`tick-${t}`)),(0,i.jsx)("text",{x:15,y:k.height/2,textAnchor:"middle",dominantBaseline:"middle",fill:k.colors.text,fontSize:12,transform:`rotate(-90, 15, ${k.height/2})`,children:"房屋總價 (萬)"}),N.items.map((e,s)=>{let n=k.paddingLeft+M.categoryWidth*(s+.5),l=k.boxWidth/2,o=k.whiskerWidth/2,a=z(e.max),d=z(e.q3),c=z(e.median),x=z(e.q1),h=z(e.min),f=u===s,g=r?.category===e.category;return(0,i.jsxs)("g",{className:"cursor-pointer transition-opacity",style:{opacity:null===u||f?1:.5},onMouseEnter:()=>b(s),onMouseLeave:()=>b(null),onClick:()=>m(e),children:[(0,i.jsx)("line",{x1:n,y1:d,x2:n,y2:a,stroke:k.colors.whisker,strokeWidth:k.whiskerStrokeWidth,strokeLinecap:"round"}),(0,i.jsx)("line",{x1:n-o,y1:a,x2:n+o,y2:a,stroke:k.colors.whisker,strokeWidth:k.whiskerStrokeWidth,strokeLinecap:"round"}),(0,i.jsx)("line",{x1:n,y1:x,x2:n,y2:h,stroke:k.colors.whisker,strokeWidth:k.whiskerStrokeWidth,strokeLinecap:"round"}),(0,i.jsx)("line",{x1:n-o,y1:h,x2:n+o,y2:h,stroke:k.colors.whisker,strokeWidth:k.whiskerStrokeWidth,strokeLinecap:"round"}),(0,i.jsx)("rect",{x:n-l,y:d,width:k.boxWidth,height:c-d,fill:k.colors.upper,stroke:f||g?t.text:k.colors.upper,strokeWidth:k.boxStrokeWidth,rx:2,style:{filter:f?"brightness(1.2)":"none"}}),(0,i.jsx)("rect",{x:n-l,y:c,width:k.boxWidth,height:x-c,fill:k.colors.lower,stroke:f||g?t.text:k.colors.lower,strokeWidth:k.boxStrokeWidth,rx:2,style:{filter:f?"brightness(1.2)":"none"}}),(0,i.jsx)("line",{x1:n-l,y1:c,x2:n+l,y2:c,stroke:k.colors.median,strokeWidth:k.medianStrokeWidth}),(0,i.jsx)("text",{x:n,y:k.height-25,textAnchor:"middle",fill:f?t.text:k.colors.text,fontSize:12,fontWeight:f?"bold":"normal",children:e.category})]},e.category)}),null!==f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("line",{x1:k.paddingLeft,y1:f,x2:k.paddingLeft+M.drawWidth,y2:f,stroke:t.accent,strokeWidth:1,strokeDasharray:"4,4",pointerEvents:"none"}),(0,i.jsx)("rect",{x:k.paddingLeft+M.drawWidth+5,y:f-12,width:70,height:24,rx:4,fill:t.card,stroke:t.accent,strokeWidth:1}),(0,i.jsxs)("text",{x:k.paddingLeft+M.drawWidth+40,y:f+4,textAnchor:"middle",fill:t.accent,fontSize:11,fontWeight:"bold",children:[(e=>{if(!N||!M)return 0;let t=1-(e-k.paddingTop)/M.drawHeight;return Math.round(N.yMin+t*(N.yMax-N.yMin))})(f).toLocaleString()," 萬"]})]})]})}),p&&(0,n.createPortal)((0,i.jsx)(l.N,{children:r&&(0,i.jsxs)("div",{className:"fixed inset-0 z-[9998] pointer-events-none",children:[(0,i.jsx)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-sm pointer-events-auto",onClick:()=>m(null)}),(0,i.jsx)(o.P.div,{ref:v,initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:400,damping:30},className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-auto w-[90vw] max-w-sm max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:(0,i.jsxs)("div",{className:"bg-zinc-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[(0,i.jsx)("div",{className:"bg-gradient-to-r from-cyan-500/20 to-violet-500/20 px-5 py-3 border-b border-white/10 flex-shrink-0",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-zinc-400 text-[10px] uppercase tracking-widest mb-0.5",children:"總價帶分析"}),(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)("div",{className:"text-white text-2xl font-black tracking-tight",children:r.category}),r.count>0&&(0,i.jsxs)("div",{className:"text-zinc-400 text-xs",children:["(",(0,i.jsx)("span",{className:"text-cyan-400 font-bold",children:r.count})," 筆)"]})]})]}),(0,i.jsx)("button",{onClick:()=>m(null),className:"p-1.5 rounded-full hover:bg-white/10 transition-colors",children:(0,i.jsx)(a.A,{className:"w-4 h-4 text-zinc-400"})})]})}),(0,i.jsxs)("div",{className:"p-4 space-y-2 overflow-y-auto flex-1 custom-scrollbar",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-white/5 border border-white/5",children:[(0,i.jsx)(d.A,{className:"w-4 h-4 text-white/70 flex-shrink-0"}),(0,i.jsx)("div",{className:"flex-1 min-w-0",children:(0,i.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,i.jsx)("span",{className:"text-white/60 text-xs font-medium",children:"最高成交"}),(0,i.jsxs)("span",{className:"text-white text-base font-mono font-bold",children:[r.max.toLocaleString()," 萬"]})]})}),(0,i.jsx)("div",{className:"w-1 h-3 border-r border-white/50 flex-shrink-0",title:"上引線"})]}),(0,i.jsxs)("div",{className:"p-3 rounded-lg bg-cyan-500/10 border border-cyan-500/30",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-[2px] bg-cyan-500"}),(0,i.jsx)("span",{className:"text-cyan-400 text-xs font-bold",children:"較高價區間 (25%)"})]}),(0,i.jsxs)("div",{className:"text-white text-lg font-mono font-bold mb-1",children:[r.median.toLocaleString()," ~ ",r.q3.toLocaleString()," 萬"]}),(0,i.jsx)("div",{className:"text-zinc-400 text-[10px] leading-tight",children:"價格偏高但屬正常範圍的交易。"})]}),(0,i.jsx)("div",{className:"flex items-center gap-3 px-3 py-2 bg-white/5 rounded-lg border border-white/5",children:(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("div",{className:"text-white text-xs font-bold",children:"中位數 (50%)"}),(0,i.jsxs)("div",{className:"text-white text-lg font-mono font-bold",children:[r.median.toLocaleString()," 萬"]})]})})}),(0,i.jsxs)("div",{className:"p-3 rounded-lg bg-violet-500/10 border border-violet-500/30",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-[2px] bg-violet-500"}),(0,i.jsx)("span",{className:"text-violet-400 text-xs font-bold",children:"較低價區間 (25%)"})]}),(0,i.jsxs)("div",{className:"text-white text-lg font-mono font-bold mb-1",children:[r.q1.toLocaleString()," ~ ",r.median.toLocaleString()," 萬"]}),(0,i.jsx)("div",{className:"text-zinc-400 text-[10px] leading-tight",children:"價格偏低但屬正常範圍的交易。"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-white/5 border border-white/5",children:[(0,i.jsx)(c.A,{className:"w-4 h-4 text-zinc-500 flex-shrink-0"}),(0,i.jsx)("div",{className:"flex-1 min-w-0",children:(0,i.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,i.jsx)("span",{className:"text-zinc-500 text-xs font-medium",children:"最低成交"}),(0,i.jsxs)("span",{className:"text-white text-base font-mono font-bold",children:[r.min.toLocaleString()," 萬"]})]})}),(0,i.jsx)("div",{className:"w-1 h-3 border-r border-zinc-600 flex-shrink-0",title:"下引線"})]})]}),(0,i.jsx)("div",{className:"px-4 py-2 bg-white/5 border-t border-white/10 flex-shrink-0",children:(0,i.jsxs)("div",{className:"text-zinc-500 text-[10px] text-center",children:["\uD83D\uDCA1 藍+紫區塊涵蓋 ",(0,i.jsx)("span",{className:"text-white font-bold",children:"50%"})," 的交易 (市場主流)"]})})]})})]})}),document.body)]}):(0,i.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無總價帶資料可顯示"})}},37717:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(12115);let s=(e,t)=>getComputedStyle(document.documentElement).getPropertyValue(e).trim()||t,n=e=>{let t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);return t?[Number(t[1]),Number(t[2]),Number(t[3])]:null},l=e=>{let t=e.replace("#","").trim();if(![3,6].includes(t.length))return null;let r=parseInt(3===t.length?t.split("").map(e=>e+e).join(""):t,16);return Number.isNaN(r)?null:[r>>16&255,r>>8&255,255&r]},o=()=>{let e=[s("--color-chart-1","#8b5cf6"),s("--color-chart-2","#06b6d4"),s("--color-chart-3","#10b981"),s("--color-chart-4","#f43f5e"),s("--color-chart-5","#f59e0b")],t=s("--color-dark-bg","#09090b");return{bg:s("--color-dark-bg","#09090b"),card:s("--color-dark-card","#18181b"),surface:s("--color-dark-surface","#27272a"),primary:s("--color-primary","#8b5cf6"),primaryHover:s("--color-primary-hover","#7c3aed"),accent:s("--color-chart-2","#06b6d4"),accentAlt:s("--color-chart-4","#f43f5e"),text:s("--color-text-primary","#fafafa"),textMuted:s("--color-text-secondary","#a1a1aa"),border:s("--color-border","#27272a"),grid:s("--color-zinc-700","#3f3f46"),danger:s("--color-destructive","#ef4444"),warning:s("--color-amber-500","#f59e0b"),success:s("--color-emerald-500","#10b981"),chart:e,chartPalette:((e,t)=>{if(0===e.length)return[];let r=e.map(e=>((e,t,r=.35)=>{let i=l(e)??n(e),s=l(t)??n(t);if(!i||!s)return e;let o=(e,t)=>Math.round(e*(1-r)+t*r),a=o(i[0],s[0]),d=o(i[1],s[1]),c=o(i[2],s[2]);return`rgb(${a}, ${d}, ${c})`})(e,t,.4));return[...e,...r]})(e,t)}};function a(){let[e,t]=(0,i.useState)(()=>o());return(0,i.useEffect)(()=>{let e=()=>t(o());e();let r=new MutationObserver(e);r.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]});let i=t=>{"sqm_theme"===t.key&&e()};return window.addEventListener("storage",i),()=>{r.disconnect(),window.removeEventListener("storage",i)}},[]),(0,i.useMemo)(()=>e,[e])}},64873:(e,t,r)=>{r.d(t,{d:()=>o});var i=r(95155),s=r(12115),n=r(33210),l=r(40980);function o({isOpen:e,onClose:t,title:r,projects:o}){let a=(0,s.useRef)(null);return((0,s.useEffect)(()=>{let r=e=>{"Escape"===e.key&&t()};return e&&(document.addEventListener("keydown",r),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",r),document.body.style.overflow=""}},[e,t]),e)?(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e=>{a.current&&!a.current.contains(e.target)&&t()},children:(0,i.jsxs)("div",{ref:a,className:"bg-zinc-900 border border-white/10 rounded-xl shadow-2xl max-w-md w-full mx-4 animate-in zoom-in-95 duration-200",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/5",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white",children:r}),(0,i.jsx)("button",{onClick:t,className:"p-1 rounded hover:bg-white/10 text-zinc-400 hover:text-white transition-colors",children:(0,i.jsx)(n.A,{size:20})})]}),(0,i.jsx)("div",{className:"px-5 py-4 max-h-[50vh] overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-700",children:0===o.length?(0,i.jsx)("p",{className:"text-zinc-500 text-center py-4",children:"無建案資料"}):(0,i.jsx)("ul",{className:"space-y-2",children:o.map((e,t)=>(0,i.jsx)("li",{className:(0,l.cn)("px-3 py-2 rounded-lg text-zinc-200 text-sm","bg-zinc-800/50 hover:bg-zinc-800 transition-colors","border border-white/5"),children:e},t))})}),(0,i.jsxs)("div",{className:"px-5 py-3 border-t border-white/5 flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"text-xs text-zinc-500",children:["共 ",o.length," 個建案"]}),(0,i.jsx)("button",{onClick:t,className:"px-4 py-1.5 text-sm rounded-lg bg-zinc-800 text-zinc-300 hover:bg-zinc-700 transition-colors",children:"關閉"})]})]})}):null}},70241:(e,t,r)=>{r.d(t,{s:()=>o});var i=r(95155),s=r(12115),n=r(97085),l=r(37717);function o({roomTypes:e,locations:t,crossTable:r,dimension:o,chartId:a}){let d=(0,l.A)(),c=(0,s.useMemo)(()=>e&&t&&r?e.map(e=>{let i=t.map(t=>r[e]&&r[e][t]||0);return{name:e,data:i}}):[],[e,t,r]),x=(0,s.useMemo)(()=>{let e="county"===o?"縣市":"行政區";return{chart:{type:"bar",height:Math.max(350,35*t.length),stacked:!0,background:"transparent",toolbar:{show:!1},foreColor:d.text,id:a},plotOptions:{bar:{horizontal:!0,barHeight:"70%",borderRadius:4,dataLabels:{total:{enabled:!0,offsetX:5,style:{fontSize:"11px",fontWeight:600,color:d.text},formatter:function(e,t){let r=t.w.config.series,i=t.dataPointIndex,s=0;return r.forEach(e=>{s+=e.data[i]||0}),s>0?s.toString():""}}}}},colors:d.chartPalette,dataLabels:{enabled:!1},xaxis:{categories:t,title:{text:"成交筆數",style:{color:d.textMuted}},labels:{style:{colors:d.textMuted}}},yaxis:{title:{text:e,style:{color:d.textMuted}},labels:{style:{colors:d.text},maxWidth:150}},legend:{position:"top",horizontalAlign:"center",labels:{colors:d.text}},tooltip:{theme:"dark",y:{formatter:function(e){return e+" 筆"}}},grid:{borderColor:d.grid},title:{text:`各${e}房型成交筆數分佈`,align:"center",style:{fontSize:"16px",color:d.text}}}},[t,o,a,d]);return c&&0!==c.length?(0,i.jsx)(n.A,{type:"bar",series:c,options:x,height:x.chart?.height||350,className:"w-full"}):(0,i.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無區域分佈資料"})}},97085:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(95155);r(12115);var s=r(37206),n=r(81477),l=r(37717);let o=(0,s.default)(()=>Promise.all([r.e(7776),r.e(4822)]).then(r.bind(r,44822)),{loadableGenerated:{webpack:()=>[null]},ssr:!1});function a({type:e,series:t,options:r,height:s=350,title:a,description:d,className:c,loading:x}){let h=(0,l.A)(),m={chart:{background:"transparent",foreColor:h.text,toolbar:{show:!1}},theme:{mode:"dark",palette:"palette1"},dataLabels:{enabled:!1,style:{colors:[h.text]}},grid:{borderColor:h.grid,strokeDashArray:4},xaxis:{labels:{style:{colors:h.textMuted}},axisBorder:{color:h.border},axisTicks:{color:h.border}},yaxis:{labels:{style:{colors:h.textMuted}}},tooltip:{theme:"dark",style:{fontSize:"12px"},x:{show:!0}},legend:{labels:{colors:h.textMuted}}},u={...m,...r,chart:{...m.chart,...r.chart}};return(0,i.jsxs)(n.Zp,{className:`p-4 ${c}`,children:[(a||d)&&(0,i.jsxs)("div",{className:"mb-4",children:[a&&(0,i.jsx)("h3",{className:"text-lg font-bold text-text-primary mb-1",children:a}),d&&(0,i.jsx)("p",{className:"text-sm text-text-secondary",children:d})]}),x?(0,i.jsx)("div",{className:"flex items-center justify-center",style:{height:s},children:(0,i.jsx)("div",{className:"loader"})}):(0,i.jsx)(o,{options:u,series:t,type:e,height:s,width:"100%"})]})}}}]);