"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6765],{69261:(e,t,i)=>{i.d(t,{A:()=>m});var r=i(95155),a=i(39430),s=i(17758),n=i(41585),o=i(42869),l=i(80723),d=i(73321);let _={no_referral:{title:"需要推薦碼授權",description:"此功能需要有效推薦碼才能使用，請至系統設定輸入或更換推薦碼。"},not_granted:{title:"未開通此功能",description:"此推薦碼未授權該功能，請確認推薦碼權限或聯絡管理員。"},quota_exceeded:{title:"使用次數已用完",description:"此功能的使用次數已達上限，請更換推薦碼或升級方案。"},time_limited_quota_exceeded:{title:"限時體驗次數已用完",description:"限時開放體驗的使用次數已達上限，請更換推薦碼或等待回溯。"},expired:{title:"推薦碼已過期",description:"此推薦碼已超過有效期間，請更換推薦碼。"},not_started:{title:"推薦碼尚未生效",description:"此推薦碼尚未到啟用時間，請稍後再試。"},inactive:{title:"推薦碼已停用",description:"此推薦碼已被停用，請更換推薦碼或聯絡管理員。"},unauthorized:{title:"請先登入",description:"請使用 LINE 會員登入/註冊後使用此功能。"},error:{title:"暫時無法使用",description:"系統發生錯誤，請稍後再試。"},not_allowed:{title:"目前未開放",description:"此功能未對一般會員開放，請升級或等待開放。"}};function m({reason:e}){let t=(0,d.useRouter)(),i=_[e||"error"]||_.error;return(0,r.jsxs)("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute top-0 left-1/3 w-96 h-96 bg-amber-500/10 rounded-full blur-[128px] pointer-events-none"}),(0,r.jsx)("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-cyan-500/10 rounded-full blur-[128px] pointer-events-none"}),(0,r.jsx)("div",{className:"relative z-10 max-w-md w-full",children:(0,r.jsxs)(a.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-zinc-900/60 backdrop-blur-xl border border-amber-500/20 rounded-3xl p-8 shadow-2xl",children:[(0,r.jsxs)(a.P.div,{className:"w-20 h-20 bg-gradient-to-tr from-amber-500/20 to-cyan-500/20 rounded-full flex items-center justify-center mx-auto mb-6 border border-amber-500/30 relative",initial:{rotate:-180,opacity:0},animate:{rotate:0,opacity:1},transition:{delay:.2,type:"spring"},children:["quota_exceeded"===e||"time_limited_quota_exceeded"===e?(0,r.jsx)(s.A,{className:"w-10 h-10 text-amber-400"}):(0,r.jsx)(n.A,{className:"w-10 h-10 text-amber-400"}),(0,r.jsx)(a.P.div,{className:"absolute inset-0 bg-amber-500/10 rounded-full",animate:{scale:[1,1.15,1]},transition:{duration:2.2,repeat:1/0}})]}),(0,r.jsxs)("div",{className:"text-center space-y-3 mb-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:i.title}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm leading-relaxed",children:i.description})]}),(0,r.jsxs)("div",{className:"space-y-3",children:["unauthorized"===e?(0,r.jsxs)("button",{onClick:()=>{window.location.href="/trb/"},className:"w-full flex items-center justify-center gap-2 bg-[#06C755] hover:bg-[#05b34c] text-white font-bold py-3.5 px-4 rounded-xl transition-all active:scale-[0.98] shadow-lg shadow-green-900/20",children:[(0,r.jsx)(o.A,{className:"w-4 h-4"}),"LINE 一鍵登入/註冊"]}):(0,r.jsxs)("button",{onClick:()=>t.push("/settings"),className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-amber-500 to-cyan-500 hover:from-amber-400 hover:to-cyan-400 text-black font-bold py-3.5 px-4 rounded-xl transition-all active:scale-[0.98] shadow-lg shadow-amber-900/20",children:[(0,r.jsx)(s.A,{className:"w-4 h-4"}),"查看推薦碼"]}),(0,r.jsxs)("button",{onClick:()=>t.back(),className:"w-full flex items-center justify-center gap-2 bg-transparent hover:bg-white/5 text-zinc-400 hover:text-white font-medium py-3.5 px-4 rounded-xl border border-white/5 hover:border-white/10 transition-all active:scale-[0.98]",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"回上一頁"]})]}),(0,r.jsx)(a.P.div,{className:"mt-8 pt-6 border-t border-white/5 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},children:(0,r.jsx)("p",{className:"text-[10px] text-zinc-600 font-mono uppercase tracking-widest",children:"PLAN: REFERRAL_LIMIT"})})]})})]})}},85993:(e,t,i)=>{i.d(t,{T:()=>n});var r=i(1934),a=i(16385);let s={map_mode:{key:"map_mode",is_active:!0,default_min_role:"user",overrides:{}},floor_plan:{key:"floor_plan",is_active:!0,default_min_role:"user",overrides:{}},report_builder:{key:"report_builder",is_active:!0,default_min_role:"pro",overrides:{}},export_report:{key:"export_report",is_active:!0,default_min_role:"pro",overrides:{}},market_heatmap:{key:"market_heatmap",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},price_analysis:{key:"price_analysis",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},total_price_analysis:{key:"total_price_analysis",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},policy_timeline:{key:"policy_timeline",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},sales_velocity:{key:"sales_velocity",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},parking_analysis:{key:"parking_analysis",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},transaction_list:{key:"transaction_list",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},share_report:{key:"share_report",is_active:!0,default_min_role:"pro",overrides:{user:{access:"time_limited",start_time:new Date().toISOString(),end_time:new Date(Date.now()+2592e6).toISOString(),is_manual_override:!0}}},system_settings:{key:"system_settings",is_active:!0,default_min_role:"user",overrides:{}},system_announcement:{key:"system_announcement",is_active:!0,default_min_role:"user",overrides:{}},admin_panel:{key:"admin_panel",is_active:!0,default_min_role:"admin",overrides:{}},manage_members:{key:"manage_members",is_active:!0,default_min_role:"admin",overrides:{}},delete_members:{key:"delete_members",is_active:!0,default_min_role:"super_admin",overrides:{}},manage_projects:{key:"manage_projects",is_active:!0,default_min_role:"admin",overrides:{}},post_annoucement:{key:"post_annoucement",is_active:!0,default_min_role:"admin",overrides:{}},upload_tools:{key:"upload_tools",is_active:!0,default_min_role:"admin",overrides:{}},edit_permissions:{key:"edit_permissions",is_active:!0,default_min_role:"super_admin",overrides:{}},manage_plans:{key:"manage_plans",is_active:!0,default_min_role:"admin",overrides:{}},dashboard_metrics:{key:"dashboard_metrics",is_active:!0,default_min_role:"user",overrides:{}}},n=(0,r.v)((e,t)=>({flags:s,isLoading:!0,error:null,fetchFlags:async()=>{e({isLoading:!0,error:null});try{let{data:t,error:i}=await a.N.from("feature_flags").select("*");if(i){console.warn("Failed to fetch feature flags (using defaults):",i.message),e({isLoading:!1});return}if(t&&t.length>0){let i={...s};t.forEach(e=>{i[e.key]&&(i[e.key]={...i[e.key],...e,overrides:e.overrides||{}})}),e({flags:i,isLoading:!1})}else e({isLoading:!1})}catch(t){console.error("Feature flag fetch error:",t),e({isLoading:!1,error:t.message})}},updateFlag:async(i,r)=>{let s=t().flags,n=s[i],o={...n,...r};e({flags:{...s,[i]:o}});try{let{error:e}=await a.N.from("feature_flags").upsert({key:i,is_active:o.is_active,default_min_role:o.default_min_role,overrides:o.overrides,updated_at:new Date().toISOString()});if(e)throw e}catch(t){throw console.error("Failed to update feature flag:",t),e({flags:{...s,[i]:n}}),t}},checkAccess:(e,i)=>{let r=t().flags[e];if(!r||!r.is_active)return{allowed:!1,reason:"default"};let a=i||"user",s=r.overrides[a];if(s){if("granted"===s.access)return{allowed:!0,reason:"override"};if("denied"===s.access)return{allowed:!1,reason:"override"};if("time_limited"===s.access){let e=new Date().getTime(),t=s.start_time?new Date(s.start_time).getTime():0,i=s.end_time?new Date(s.end_time).getTime():1/0;return e>=t&&e<=i?{allowed:!0,reason:"beta",remainingTime:i-e}:{allowed:!1,reason:"override"}}}let n=["user","pro","pro_max","admin","super_admin"];return n.indexOf(a)>=n.indexOf(r.default_min_role||"user")?{allowed:!0,reason:"default"}:{allowed:!1,reason:"default"}}}))}}]);