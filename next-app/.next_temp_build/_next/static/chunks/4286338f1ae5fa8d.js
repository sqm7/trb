(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98847,(e,t,s)=>{var r;let a;e.e,r=function e(){var t,s="u">typeof self?self:"u">typeof window?window:void 0!==s?s:{},r=!s.document&&!!s.postMessage,a=s.IS_PAPA_WORKER||!1,n={},i=0,l={};function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new x(t),(this._handle.streamer=this)._config=t}).call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(n=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,n)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&void 0!==(n=this._config.beforeFirstChunk(e))&&(e=n),this.isFirstChunk=!1,this._halted=!1;var r=this._partialLine+e,n=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=n.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),n&&n.data&&(this._rowCount+=n.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,a)s.postMessage({results:n,workerId:l.WORKER_ID,finished:r});else if(w(this._config.chunk)&&!t){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=n=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!r||!w(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):a&&this._config.error&&s.postMessage({workerId:l.WORKER_ID,error:e,finished:!1})}}function d(e){var t;(e=e||{}).chunkSize||(e.chunkSize=l.RemoteChunkSize),c.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,s,a=this._config.downloadRequestHeaders;for(s in a)t.setRequestHeader(s,a[s])}this._config.chunkSize&&(e=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+e));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){let e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null!==(e=(e=t).getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(Error(e))}}function o(e){(e=e||{}).chunkSize||(e.chunkSize=l.LocalChunkSize),c.call(this,e);var t,s,r="u">typeof FileReader;this.stream=function(e){this._input=e,s=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,a=(this._config.chunkSize&&(a=Math.min(this._start+this._config.chunkSize,this._input.size),e=s.call(e,this._start,a)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:a}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;c.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,s;if(!this._finished)return t=(e=this._config.chunkSize)?(s=t.substring(0,e),t.substring(e)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function h(e){c.call(this,e=e||{});var t=[],s=!0,r=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):s=!0},this._streamData=y(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),s&&(s=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x(e){var t,s,r,a,n=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,i=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,d=0,o=0,f=!1,h=!1,x=[],g={data:[],errors:[],meta:{}};function p(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function j(){if(g&&r&&(v("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(g.data=g.data.filter(function(e){return!p(e)})),y()){if(g)if(Array.isArray(g.data[0])){for(var t,s=0;y()&&s<g.data.length;s++)g.data[s].forEach(a);g.data.splice(0,1)}else g.data.forEach(a);function a(t,s){w(e.transformHeader)&&(t=e.transformHeader(t,s)),x.push(t)}}function c(t,s){for(var r=e.header?{}:[],a=0;a<t.length;a++){var l=a,c=t[a],c=((t,s)=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping))?"true"===s||"TRUE"===s||"false"!==s&&"FALSE"!==s&&((e=>{if(n.test(e)&&-0x20000000000000<(e=parseFloat(e))&&e<0x20000000000000)return 1})(s)?parseFloat(s):i.test(s)?new Date(s):""===s?null:s):s)(l=e.header?a>=x.length?"__parsed_extra":x[a]:l,c=e.transform?e.transform(c,l):c);"__parsed_extra"===l?(r[l]=r[l]||[],r[l].push(c)):r[l]=c}return e.header&&(a>x.length?v("FieldMismatch","TooManyFields","Too many fields: expected "+x.length+" fields but parsed "+a,o+s):a<x.length&&v("FieldMismatch","TooFewFields","Too few fields: expected "+x.length+" fields but parsed "+a,o+s)),r}g&&(e.header||e.dynamicTyping||e.transform)&&(t=1,!g.data.length||Array.isArray(g.data[0])?(g.data=g.data.map(c),t=g.data.length):g.data=c(g.data,0),e.header&&g.meta&&(g.meta.fields=x),o+=t)}function y(){return e.header&&0===x.length}function v(e,t,s,r){e={type:e,code:t,message:s},void 0!==r&&(e.row=r),g.errors.push(e)}w(e.step)&&(a=e.step,e.step=function(t){g=t,y()?j():(j(),0!==g.data.length&&(d+=t.data.length,e.preview&&d>e.preview?s.abort():(g.data=g.data[0],a(g,c))))}),this.parse=function(a,n,i){var c=e.quoteChar||'"',c=(e.newline||(e.newline=this.guessLineEndings(a,c)),r=!1,e.delimiter?w(e.delimiter)&&(e.delimiter=e.delimiter(a),g.meta.delimiter=e.delimiter):((c=((t,s,r,a,n)=>{var i,c,d,o;n=n||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var f=0;f<n.length;f++){for(var h,x=n[f],u=0,g=0,j=0,b=(d=void 0,new m({comments:a,delimiter:x,newline:s,preview:10}).parse(t)),y=0;y<b.data.length;y++)r&&p(b.data[y])?j++:(g+=h=b.data[y].length,void 0===d?d=h:0<h&&(u+=Math.abs(h-d),d=h));0<b.data.length&&(g/=b.data.length-j),(void 0===c||u<=c)&&(void 0===o||o<g)&&1.99<g&&(c=u,i=x,o=g)}return{successful:!!(e.delimiter=i),bestDelimiter:i}})(a,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=c.bestDelimiter:(r=!0,e.delimiter=l.DefaultDelimiter),g.meta.delimiter=e.delimiter),b(e));return e.preview&&e.header&&c.preview++,t=a,g=(s=new m(c)).parse(t,n,i),j(),f?{meta:{paused:!0}}:g||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,s.abort(),t=w(e.chunk)?"":t.substring(s.getCharIndex())},this.resume=function(){c.streamer._halted?(f=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,s.abort(),g.meta.aborted=!0,w(e.complete)&&e.complete(g),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576);var t=RegExp(u(t)+"([^]*?)"+u(t),"gm"),s=(e=e.replace(t,"")).split("\r"),t=e.split("\n"),e=1<t.length&&t[0].length<s[0].length;if(1===s.length||e)return"\n";for(var r=0,a=0;a<s.length;a++)"\n"===s[a][0]&&r++;return r>=s.length/2?"\r\n":"\r"}}function u(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t=(e=e||{}).delimiter,s=e.newline,r=e.comments,a=e.step,n=e.preview,i=e.fastMode,c=null,d=!1,o=null==e.quoteChar?'"':e.quoteChar,f=o;if(void 0!==e.escapeChar&&(f=e.escapeChar),("string"!=typeof t||-1<l.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<l.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==s&&"\r"!==s&&"\r\n"!==s&&(s="\n");var h=0,x=!1;this.parse=function(l,m,g){if("string"!=typeof l)throw Error("Input must be a string");var p=l.length,j=t.length,b=s.length,y=r.length,v=w(a),N=[],_=[],k=[],S=h=0;if(!l)return z();if(i||!1!==i&&-1===l.indexOf(o)){for(var C=l.split(s),E=0;E<C.length;E++){if(k=C[E],h+=k.length,E!==C.length-1)h+=s.length;else if(g)break;if(!r||k.substring(0,y)!==r){if(v){if(N=[],I(k.split(t)),M(),x)return z()}else I(k.split(t));if(n&&n<=E)return N=N.slice(0,n),z(!0)}}return z()}for(var R=l.indexOf(t,h),$=l.indexOf(s,h),O=RegExp(u(f)+u(o),"g"),A=l.indexOf(o,h);;)if(l[h]===o)for(A=h,h++;;){if(-1===(A=l.indexOf(o,A+1)))return g||_.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:N.length,index:h}),L();if(A===p-1)return L(l.substring(h,A).replace(O,o));if(o===f&&l[A+1]===f)A++;else if(o===f||0===A||l[A-1]!==f){-1!==R&&R<A+1&&(R=l.indexOf(t,A+1));var T=D(-1===($=-1!==$&&$<A+1?l.indexOf(s,A+1):$)?R:Math.min(R,$));if(l.substr(A+1+T,j)===t){k.push(l.substring(h,A).replace(O,o)),l[h=A+1+T+j]!==o&&(A=l.indexOf(o,h)),R=l.indexOf(t,h),$=l.indexOf(s,h);break}if(T=D($),l.substring(A+1+T,A+1+T+b)===s){if(k.push(l.substring(h,A).replace(O,o)),F(A+1+T+b),R=l.indexOf(t,h),A=l.indexOf(o,h),v&&(M(),x))return z();if(n&&N.length>=n)return z(!0);break}_.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:N.length,index:h}),A++}}else if(r&&0===k.length&&l.substring(h,h+y)===r){if(-1===$)return z();h=$+b,$=l.indexOf(s,h),R=l.indexOf(t,h)}else if(-1!==R&&(R<$||-1===$))k.push(l.substring(h,R)),h=R+j,R=l.indexOf(t,h);else{if(-1===$)break;if(k.push(l.substring(h,$)),F($+b),v&&(M(),x))return z();if(n&&N.length>=n)return z(!0)}return L();function I(e){N.push(e),S=h}function D(e){return -1!==e&&(e=l.substring(A+1,e))&&""===e.trim()?e.length:0}function L(e){return g||(void 0===e&&(e=l.substring(h)),k.push(e),h=p,I(k),v&&M()),z()}function F(e){h=e,I(k),k=[],$=l.indexOf(s,h)}function z(r){if(e.header&&!m&&N.length&&!d){var a=N[0],n=Object.create(null),i=new Set(a);let t=!1;for(let s=0;s<a.length;s++){let r=a[s];if(n[r=w(e.transformHeader)?e.transformHeader(r,s):r]){let e,l=n[r];for(;e=r+"_"+l,l++,i.has(e););i.add(e),a[s]=e,n[r]++,t=!0,(c=null===c?{}:c)[e]=r}else n[r]=1,a[s]=r;i.add(r)}t&&console.warn("Duplicate headers found and renamed."),d=!0}return{data:N,errors:_,meta:{delimiter:t,linebreak:s,aborted:x,truncated:!!r,cursor:S+(m||0),renamedHeaders:c}}}function M(){a(z()),N=[],_=[]}},this.abort=function(){x=!0},this.getCharIndex=function(){return h}}function g(e){var t=e.data,s=n[t.workerId],r=!1;if(t.error)s.userError(t.error,t.file);else if(t.results&&t.results.data){var a={abort:function(){r=!0,p(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:j,resume:j};if(w(s.userStep)){for(var i=0;i<t.results.data.length&&(s.userStep({data:t.results.data[i],errors:t.results.errors,meta:t.results.meta},a),!r);i++);delete t.results}else w(s.userChunk)&&(s.userChunk(t.results,a,t.file),delete t.results)}t.finished&&!r&&p(t.workerId,t.results)}function p(e,t){var s=n[e];w(s.userComplete)&&s.userComplete(t),s.terminate(),delete n[e]}function j(){throw Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,s=Array.isArray(e)?[]:{};for(t in e)s[t]=b(e[t]);return s}function y(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return l.parse=function(t,r){var a,c,x,u=(r=r||{}).dynamicTyping||!1;if(w(u)&&(r.dynamicTypingFunction=u,u={}),r.dynamicTyping=u,r.transform=!!w(r.transform)&&r.transform,!r.worker||!l.WORKERS_SUPPORTED){let e;return u=null,l.NODE_STREAM_INPUT,"string"==typeof t?(t=65279!==(e=t).charCodeAt(0)?e:e.slice(1),u=new(r.download?d:f)(r)):!0===t.readable&&w(t.read)&&w(t.on)?u=new h(r):(s.File&&t instanceof File||t instanceof Object)&&(u=new o(r)),u.stream(t)}(u=!!l.WORKERS_SUPPORTED&&(c=s.URL||s.webkitURL||null,x=e.toString(),a=l.BLOB_URL||(l.BLOB_URL=c.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",x,")();"],{type:"text/javascript"}))),(a=new s.Worker(a)).onmessage=g,a.id=i++,n[a.id]=a)).userStep=r.step,u.userChunk=r.chunk,u.userComplete=r.complete,u.userError=r.error,r.step=w(r.step),r.chunk=w(r.chunk),r.complete=w(r.complete),r.error=w(r.error),delete r.worker,u.postMessage({input:t,config:r,workerId:u.id})},l.unparse=function(e,t){var s=!1,r=!0,a=",",n="\r\n",i='"',c=i+i,d=!1,o=null,f=!1,h=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||l.BAD_DELIMITERS.filter(function(e){return -1!==t.delimiter.indexOf(e)}).length||(a=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(s=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(d=t.skipEmptyLines),"string"==typeof t.newline&&(n=t.newline),"string"==typeof t.quoteChar&&(i=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw Error("Option columns is empty");o=t.columns}void 0!==t.escapeChar&&(c=t.escapeChar+i),t.escapeFormulae instanceof RegExp?f=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(f=/^[=+\-@\t\r].*$/)}})(),RegExp(u(i),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return x(null,e,d);if("object"==typeof e[0])return x(o||Object.keys(e[0]),e,d)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||o),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),x(e.fields||[],e.data||[],d);throw Error("Unable to serialize unrecognized input");function x(e,t,s){var i="",l=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),c=!Array.isArray(t[0]);if(l&&r){for(var d=0;d<e.length;d++)0<d&&(i+=a),i+=m(e[d],d);0<t.length&&(i+=n)}for(var o=0;o<t.length;o++){var f=(l?e:t[o]).length,h=!1,x=l?0===Object.keys(t[o]).length:0===t[o].length;if(s&&!l&&(h="greedy"===s?""===t[o].join("").trim():1===t[o].length&&0===t[o][0].length),"greedy"===s&&l){for(var u=[],g=0;g<f;g++){var p=c?e[g]:g;u.push(t[o][p])}h=""===u.join("").trim()}if(!h){for(var j=0;j<f;j++){0<j&&!x&&(i+=a);var b=l&&c?e[j]:j;i+=m(t[o][b],j)}o<t.length-1&&(!s||0<f&&!x)&&(i+=n)}}return i}function m(e,t){var r,n;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(n=!1,f&&"string"==typeof e&&f.test(e)&&(e="'"+e,n=!0),r=e.toString().replace(h,c),(n=n||!0===s||"function"==typeof s&&s(e,t)||Array.isArray(s)&&s[t]||((e,t)=>{for(var s=0;s<t.length;s++)if(-1<e.indexOf(t[s]))return!0;return!1})(r,l.BAD_DELIMITERS)||-1<r.indexOf(a)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?i+r+i:r)}},l.RECORD_SEP="\x1e",l.UNIT_SEP="\x1f",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r","\n",'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!r&&!!s.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=0xa00000,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=m,l.ParserHandle=x,l.NetworkStreamer=d,l.FileStreamer=o,l.StringStreamer=f,l.ReadableStreamStreamer=h,s.jQuery&&((t=s.jQuery).fn.parse=function(e){var r=e.config||{},a=[];return this.each(function(e){if(!("INPUT"===t(this).prop("tagName").toUpperCase()&&"file"===t(this).attr("type").toLowerCase()&&s.FileReader)||!this.files||0===this.files.length)return!0;for(var n=0;n<this.files.length;n++)a.push({file:this.files[n],inputElem:this,instanceConfig:t.extend({},r)})}),n(),this;function n(){if(0===a.length)w(e.complete)&&e.complete();else{var s,r,n,c=a[0];if(w(e.before)){var d=e.before(c.file,c.inputElem);if("object"==typeof d){if("abort"===d.action)return s=c.file,r=c.inputElem,n=d.reason,void(w(e.error)&&e.error({name:"AbortError"},s,r,n));if("skip"===d.action)return void i();"object"==typeof d.config&&(c.instanceConfig=t.extend(c.instanceConfig,d.config))}else if("skip"===d)return void i()}var o=c.instanceConfig.complete;c.instanceConfig.complete=function(e){w(o)&&o(e,c.file,c.inputElem),i()},l.parse(c.file,c.instanceConfig)}}function i(){a.splice(0,1),n()}}),a&&(s.onmessage=function(e){e=e.data,void 0===l.WORKER_ID&&e&&(l.WORKER_ID=e.workerId),"string"==typeof e.input?s.postMessage({workerId:l.WORKER_ID,results:l.parse(e.input,e.config),finished:!0}):(s.File&&e.input instanceof File||e.input instanceof Object)&&(e=l.parse(e.input,e.config))&&s.postMessage({workerId:l.WORKER_ID,results:e,finished:!0})}),(d.prototype=Object.create(c.prototype)).constructor=d,(o.prototype=Object.create(c.prototype)).constructor=o,(f.prototype=Object.create(f.prototype)).constructor=f,(h.prototype=Object.create(c.prototype)).constructor=h,l},"function"==typeof define&&define.amd?void 0!==(a=r())&&e.v(a):t.exports=r()},23346,e=>{"use strict";var t=e.i(25191),s=e.i(42713),r=e.i(68524),a=e.i(41097),n=e.i(98847);let i={A:"臺北市",B:"臺中市",C:"基隆市",D:"臺南市",E:"高雄市",F:"新北市",G:"宜蘭縣",H:"桃園市",I:"嘉義市",J:"新竹縣",K:"苗栗縣",M:"南投縣",N:"彰化縣",O:"新竹市",P:"雲林縣",Q:"嘉義縣",T:"屏東縣",U:"花蓮縣",V:"臺東縣",W:"金門縣",X:"澎湖縣",Z:"連江縣"},l={a:{編號:"編號",鄉鎮市區:"行政區",交易標的:"交易標的",土地位置建物門牌:"地址",交易年月日:"交易日",交易筆棟數:"交易筆棟數",移轉層次:"樓層",建物型態:"建物型態",主要用途:"主要用途",建物移轉總面積平方公尺:"產權面積_房車","建物現況格局-房":"房數","建物現況格局-廳":"廳數","建物現況格局-衛":"衛浴數",總價元:"交易總價",車位類別:"車位類別",車位移轉總面積平方公尺:"車位總面積",車位總價元:"車位總價",備註:"備註",主建物面積:"主建物面積",附屬建物面積:"附屬建物面積",陽台面積:"陽台面積"},a_build:{編號:"編號",屋齡:"交易屋齡",主要建材:"結構",建築完成年月日:"完工日",建築完成日期:"完工日",總層數:"總樓層",移轉情形:"移轉情形"},a_land:{編號:"編號",土地位置:"地號_段",地號:"地號",土地移轉面積平方公尺:"土地持分面積",使用分區或編定:"使用分區",非都市土地使用分區:"使用分區",權利人持分分母:"持分分母",權利人持分分子:"持分分子"},a_park:{編號:"編號",車位類別:"車位類別",車位價格:"車位價格",車位面積平方公尺:"車位面積",車位所在樓層:"車位樓層"},b:{編號:"編號",鄉鎮市區:"行政區",交易標的:"交易標的",土地位置建物門牌:"地址",交易年月日:"交易日",交易筆棟數:"交易筆棟數",移轉層次:"樓層",總層數:"總樓層",總樓層數:"總樓層",建物型態:"建物型態",主要用途:"主要用途",建物移轉總面積平方公尺:"產權面積_房車","建物現況格局-房":"房數","建物現況格局-廳":"廳數","建物現況格局-衛":"衛浴數",總價元:"交易總價",車位類別:"車位類別",車位移轉總面積平方公尺:"車位總面積",車位總價元:"車位總價",備註:"備註",建案名稱:"建案名稱",棟及號:"戶別",解約情形:"解約情形"},b_land:{編號:"編號",土地位置:"地號_段",地號:"地號",土地移轉面積平方公尺:"土地持分面積",使用分區或編定:"使用分區",非都市土地使用分區:"使用分區",權利人持分分母:"持分分母",權利人持分分子:"持分分子"},b_park:{編號:"編號",車位類別:"車位類別",車位價格:"車位價格",車位面積平方公尺:"車位面積",車位所在樓層:"車位樓層"},c:{編號:"編號",鄉鎮市區:"行政區",交易標的:"交易標的",土地位置建物門牌:"地址",租賃年月日:"交易日",租賃筆棟數:"交易筆棟數",租賃層次:"樓層",建物型態:"建物型態",主要用途:"主要用途",建物總面積平方公尺:"租賃面積","建物現況格局-房":"房數","建物現況格局-廳":"廳數","建物現況格局-衛":"衛浴數",總額元:"交易總價",車位類別:"車位類別",車位面積平方公尺:"車位總面積",車位總額元:"車位總價",備註:"備註",出租型態:"出租型態",租賃期間:"租賃期間",附屬設備:"附屬設備",租賃住宅服務:"租賃住宅服務"},c_build:{編號:"編號",屋齡:"交易屋齡",主要建材:"結構",建築完成年月日:"完工日",建築完成日期:"完工日",總層數:"總樓層",移轉情形:"移轉情形"},c_land:{編號:"編號",土地位置:"地號_段",地號:"地號",土地移轉面積平方公尺:"土地租賃面積",使用分區或編定:"使用分區",非都市土地使用分區:"使用分區"},c_park:{編號:"編號",車位類別:"車位類別",車位價格:"車位價格",車位面積平方公尺:"車位面積",車位所在樓層:"車位樓層"}};function c(e){if("string"!=typeof e&&"number"!=typeof e)return null;let t=parseFloat(String(e).replace(/,/g,""));return isNaN(t)?null:t}async function d(e,t=""){let s=[];for await(let r of e.values()){let e=t?`${t}/${r.name}`:r.name;if("file"===r.kind&&r.name.toLowerCase().endsWith(".csv")){let t=/^([a-z])_lvr_land_([a-c](?:_build|_land|_park)?)\.csv$/i,a=r.name.match(t);a&&s.push({handle:r,name:r.name,fullPath:e,countyCode:a[1].toLowerCase(),tableType:a[2].toLowerCase(),isMain:!a[2].includes("_")})}else"directory"===r.kind&&s.push(...await d(r,e))}return s}async function o(e,t,s){let r=await e.handle.getFile(),a=await new Promise(e=>{n.default.parse(r,{header:!0,skipEmptyLines:!0,transformHeader:e=>e.trim(),complete:e})});if(a.errors&&a.errors.length>0){let t=["TooManyFields","TooFewFields","MissingQuotes"],r=a.errors.filter(e=>!t.includes(e.code));if(r.length>0)throw Error(`CSV 嚴重解析錯誤: ${r[0].message}`);s&&a.errors.forEach(t=>{s(`檔案 ${e.fullPath} 有解析警告 (已忽略): ${t.message} (行: ${(t.row||0)+2})`,"warning")})}if(!a.data||0===a.data.length)return[];let i=a.data;i[0]["編號"]?.toLowerCase().includes("serial number")&&i.shift();let d=l[e.tableType];if(!d)throw Error(`檔案 ${e.name} 找不到對應的欄位規則。`);let o=i.map(e=>(function(e,t){let s={};for(let r in Array.from(new Set(Object.values(t))).forEach(e=>s[e]=null),e){let a=t[r.trim()];if(a){let t=e[r];if(void 0===t||""===t||null===t)continue;"樓層"===a||"總樓層"===a?s[a]=function(e){if(!e||"string"!=typeof e)return null;let t=String(e).replace(/層|樓/g,""),s={一:1,二:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9,十:10};if(!isNaN(parseInt(t)))return parseInt(t,10);if(t.includes("地下"))return -1;let r=0;if(t.startsWith("十"))r=10+(s[t[1]]||0);else if(t.includes("十")){let e=t.split("十");r=10*(s[e[0]]||1)+(s[e[1]]||0)}else r=s[t]||0;return r>0?r:null}(t):a.includes("日")?s[a]=function(e){if(!e)return null;let t=String(e).match(/(\d{2,3})[^\d]*(\d{1,2})[^\d]*(\d{1,2})/);if(!t)return null;try{let e=parseInt(t[1],10),s=parseInt(t[2],10),r=parseInt(t[3],10);if(isNaN(e)||isNaN(s)||isNaN(r))return null;let a=e+1911,n=String(s).padStart(2,"0"),i=String(r).padStart(2,"0"),l=new Date(`${a}-${n}-${i}`);if(isNaN(l.getTime())||l.getDate()!==r)return null;return`${a}-${n}-${i}`}catch(e){return null}}(String(t)):["交易總價","車位總價","房數","廳數","衛浴數","持分分母","持分分子","交易屋齡","車位價格"].includes(a)||a.includes("面積")?s[a]=c(t):s[a]=String(t)}}return s})(e,d));if(t&&t.size>0){let e=0;o=o.map(s=>{let r=s["建案名稱"];if(r&&t.has(r)){let a=t.get(r);a&&(s["建案名稱"]=a,e++)}return s}),e>0&&s&&s(`已自動替換 ${e} 筆建案名稱`,"info")}return o}let f=new Map,h=new Set,x={new:0,updated:0,identical:0,subAdded:0,errors:0,warnings:0,newRecords:[],updatedRecords:[],identicalRecords:[]};async function u(e){try{let{data:t,error:s}=await a.supabase.from("project_name_mappings").select("old_name, new_name");if(s)return e&&e(`載入建案名稱對應失敗: ${s.message}`,"warning"),new Map;let r=new Map;return t?.forEach(e=>{r.set(e.old_name,e.new_name)}),e&&e(`已載入 ${r.size} 筆建案名稱對應規則`,"info"),f=r,r}catch(t){return e&&e(`載入建案名稱對應時發生錯誤: ${t.message}`,"warning"),new Map}}async function m(e,t){try{let s=`${e.countyCode}_lvr_land_${e.tableType}`,r=await o(e,f,(e,s)=>t(e,s));if(!r||0===r.length)return void t(`${e.fullPath}: 檔案為空或無有效資料，已跳過`,"warning");for(let n=0;n<r.length;n+=500){let i=r.slice(n,n+500),d=i.map(e=>e["編號"]),{data:o,error:f}=await a.supabase.from(s).select("*").in("編號",d);if(f)throw f;let u=new Map((o||[]).map(e=>[e["編號"],e])),m=[],g=[],p=[],j=0;for(let t of i){let s=u.get(t["編號"]);s?function(e,t,s){let r=l[s];if(!r)return!1;for(let s of Object.values(r)){if("id"===s||"建案名稱"===s)continue;let r=e[s],a=t[s];if(null==r||""===r)continue;let n=null!=r?String(r):"",i=null!=a?String(a):"";if(s.includes("面積")){let e=c(r)||0;if(Math.abs(e-(c(a)||0))>.001)return!1}else if(n!==i)return!1}return!0}(t,s,e.tableType)?(j++,x.identicalRecords.push(s)):(p.push(t["編號"]),g.push(t),x.updatedRecords.push({oldData:s,newData:t})):(m.push(t),x.newRecords.push(t))}if(t(`${e.fullPath} (區塊 ${Math.floor(n/500)+1}): 新增 ${m.length}, 更新 ${g.length}, 跳過 ${j}`,"info"),x.new+=m.length,x.updated+=g.length,x.identical+=j,[...m.map(e=>e["編號"]),...g.map(e=>e["編號"])].forEach(e=>h.add(e)),p.length>0){let{error:e}=await a.supabase.from(s).delete().in("編號",p);if(e)throw e}let b=[...m,...g];if(b.length>0){let{error:e}=await a.supabase.from(s).insert(b);if(e)throw e}}}catch(s){t(`${e.fullPath} 上傳失敗: ${s.message}`,"error"),x.errors++}}async function g(e,t){try{let s=`${e.countyCode}_lvr_land_${e.tableType}`,r=await o(e,f,(e,s)=>t(e,s));if(!r||0===r.length)return void t(`${e.fullPath}: 檔案為空或無有效資料，已跳過`,"warning");let n=r.filter(e=>h.has(e["編號"]));if(n.length>0){let{error:r}=await a.supabase.from(s).insert(n);if(r)throw r;x.subAdded+=n.length,t(`${e.fullPath}: 成功新增 ${n.length} 筆關聯的附表紀錄`,"success")}else t(`${e.fullPath}: 無對應的主表變更，已跳過`,"info")}catch(s){t(`${e.fullPath} 上傳失敗: ${s.message}`,"error"),x.errors++}}var p=e.i(72328),j=e.i(98739);function b(e,t){if(!e||!t)throw Error("請提供完整的 Supabase URL 和 Service Role Key");return(0,j.createClient)(e,t,{auth:{persistSession:!1}})}async function y(e,t,s,r,a){try{let n=b(a.url,a.key),i=`${e.toLowerCase()}_lvr_land_${t}`;console.log(`[AdminService] Searching ${i} for ${s} like %${r}%`);let{data:l,error:c}=await n.from(i).select("*").ilike(s,`%${r}%`).limit(100);if(c)throw c;return{success:!0,data:l,tableName:i}}catch(e){return console.error("Search error:",e),{success:!1,error:e.message}}}async function w(e,t,s,r,a,n,i,l){try{let c=b(l.url,l.key);if(!t||0===t.length)throw Error("沒有選擇任何要更新的資料");console.log(`[AdminService] Batch updating ${e}, Count: ${t.length}, Field: ${s}`);let{error:d}=await c.from(e).update({[s]:""===r?null:r}).in("編號",t);if(d)throw d;let o=a&&a.includes("?");return"建案名稱"===s&&a&&r&&a!==r&&o&&(console.log(`[AdminService] Detected encoding fix (old: ${a}, new: ${r}). Saving mapping.`),await v(a,r,n,i,c)),{success:!0,count:t.length}}catch(e){return console.error("Batch update error:",e),{success:!1,error:e.message}}}async function v(e,t,s,r,a){try{let n={old_name:e,new_name:t,updated_at:new Date().toISOString()};s&&(n.district=s),r&&(n.city=r);let{error:i}=await a.from("project_name_mappings").upsert(n,{onConflict:"old_name"});i&&console.error("Failed to save mapping:",i)}catch(e){console.error("Error saving mapping:",e)}}function N(){let e=(0,p.useRouter)(),[n,c]=(0,r.useState)([]),[o,f]=(0,r.useState)(!1),[j,b]=(0,r.useState)([]),[v,N]=(0,r.useState)("all"),[_,k]=(0,r.useState)(""),[S,C]=(0,r.useState)(0),[E,R]=(0,r.useState)(null),[$,O]=(0,r.useState)(""),[A,T]=(0,r.useState)(""),[I,D]=(0,r.useState)(!1),[L,F]=(0,r.useState)("f"),[z,M]=(0,r.useState)("b"),[P,U]=(0,r.useState)("建案名稱"),[K,q]=(0,r.useState)(""),[B,W]=(0,r.useState)([]),[H,Q]=(0,r.useState)(!1),[J,G]=(0,r.useState)(new Set),[Z,V]=(0,r.useState)("建案名稱"),[X,Y]=(0,r.useState)(""),[ee,et]=(0,r.useState)(!1),[es,er]=(0,r.useState)(!1),[ea,en]=(0,r.useState)(null),[ei,el]=(0,r.useState)(new Set),[ec,ed]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{await a.supabase.auth.getSession()})()},[]);let eo=(e,t)=>{let s=new Date().toLocaleTimeString();c(r=>[...r,{id:Date.now()+Math.random(),text:e,type:t,time:s}])},ef=async()=>{if(!$||!A)return void eo("請填寫完整的 Supabase URL 和 Service Role Key。","error");eo("正在測試連線...","info");try{let{error:e}=await a.supabase.from("county_codes").select("code",{count:"exact",head:!0});if(e&&"42P01"!==e.code)throw e;eo("連線成功！","success"),D(!0),u((e,t)=>eo(e,t))}catch(e){eo(`連線失敗: ${e.message}`,"error"),D(!1)}},eh=async()=>{c([]),b([]),R(null);try{if(!window.showDirectoryPicker)return void eo("您的瀏覽器不支援資料夾選擇功能，請使用 Chrome 或 Edge。","error");eo("正在掃描資料夾...","info");let e=await window.showDirectoryPicker(),t=await d(e);if(0===t.length)return void eo("在選擇的資料夾中沒有找到符合命名規則的檔案。","warning");b(t),eo(`掃描完成！找到 ${t.length} 個有效檔案。`,"success")}catch(e){"AbortError"!==e.name&&eo(`選擇資料夾時發生錯誤: ${e.message}`,"error")}},ex=async()=>{if(0===j.length)return;if(!I)return void eo("請先確認資料庫連線成功。","error");f(!0),h=new Set,x={new:0,updated:0,identical:0,subAdded:0,errors:0,warnings:0,newRecords:[],updatedRecords:[],identicalRecords:[]},c([]),eo("開始上傳任務...","info");let e=j;if("all"!==v&&(e=j.filter(e=>e.tableType.startsWith(v))),0===e.length){eo(`找不到符合「${{all:"全選",a:"中古",b:"預售",c:"租賃"}[v]}」類型的檔案...`,"warning"),f(!1);return}let t=e.filter(e=>e.isMain),s=e.filter(e=>!e.isMain);eo(`--- 階段 1: 主表 (智慧更新) ---`,"info");for(let e=0;e<t.length;e++){let s=t[e];k(s.fullPath),C(Math.round(e/t.length*100)),await m(s,eo)}eo(`--- 階段 2: 附表 (智慧連動) ---`,"info");for(let e=0;e<s.length;e++){let t=s[e];k(t.fullPath),C(Math.round(e/s.length*100)),await g(t,eo)}k(""),C(100);let r=x;R(r),eo(`所有檔案處理完成！新增: ${r.new}, 更新: ${r.updated}, 錯誤: ${r.errors}`,"success"),f(!1)},eu=async()=>{if(!$||!A)return void eo("請先填寫資料庫連線資訊 (URL & Key)","error");if(!K.trim())return void eo("請輸入搜尋關鍵字","warning");et(!0),c([]),eo(`正在搜尋: ${i[L.toUpperCase()]} ${z} ${P} containing "${K}"...`,"info");try{let e=await y(L,z,P,K.trim(),{url:$,key:A});e.success&&e.data?(W(e.data),en({tableName:e.tableName,city:i[L.toUpperCase()]}),Q(!0),G(new Set),eo(`搜尋完成，找到 ${e.data.length} 筆資料`,"success")):eo(`搜尋失敗: ${e.error}`,"error")}catch(e){eo(`搜尋發生錯誤: ${e.message}`,"error")}finally{et(!1)}},em=async()=>{if(!ea||0===J.size)return;let e=null,t=null;if("建案名稱"===Z){let s=Array.from(J)[0],r=B.find(e=>e["編號"]===s);r&&(e=r["建案名稱"],t=r["行政區"])}er(!0),eo(`開始批次更新 ${J.size} 筆資料...`,"info");try{let s=await w(ea.tableName,Array.from(J),Z,X,e,t,ea.city,{url:$,key:A});s.success?(eo(`成功更新 ${s.count} 筆資料！`,"success"),Q(!1)):eo(`批次更新失敗: ${s.error}`,"error")}catch(e){eo(`批次更新發生錯誤: ${e.message}`,"error")}finally{er(!1)}},eg=e=>{let t=new Set(J);t.has(e)?t.delete(e):t.add(e),G(t)},ep=()=>{J.size===B.length?G(new Set):G(new Set(B.map(e=>e["編號"])))},ej=e=>{let t=new Set(ei);t.has(e)?t.delete(e):t.add(e),el(t)};return(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 min-h-screen bg-[#1a1d29] text-gray-100 p-8 font-sans",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 max-w-7xl mx-auto space-y-8",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex justify-between items-center bg-[#252836] p-6 rounded-xl border border-gray-700 shadow-lg",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsxs)("h1",{className:"jsx-4f044084e7cd90f7 text-3xl font-extrabold text-white tracking-tight",children:["平米內參 ",(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 text-cyan-400",children:"資料上傳工具"})]}),(0,t.jsx)("p",{className:"jsx-4f044084e7cd90f7 text-gray-400 mt-2 text-sm",children:"高效能、智慧化的實價登錄資料批次處理系統 v2.0 (Next.js)"})]}),(0,t.jsxs)("button",{onClick:()=>e.push("/"),className:"jsx-4f044084e7cd90f7 text-gray-400 hover:text-white transition-colors flex items-center gap-2",children:[(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-arrow-left"})," 返回儀表板"]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 space-y-6",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#252836] p-6 rounded-xl border border-gray-700 shadow-lg",children:[(0,t.jsxs)("h2",{className:"jsx-4f044084e7cd90f7 text-xl font-bold text-white mb-4 flex items-center",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 bg-cyan-900 text-cyan-400 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm",children:"1"}),"資料庫連線"]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 space-y-4",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-1",children:"Supabase URL"}),(0,t.jsx)("input",{type:"text",value:$,onChange:e=>O(e.target.value),placeholder:"https://xyz.supabase.co",className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-cyan-500 focus:border-cyan-500 placeholder-gray-600"})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-1",children:"Service Role Key"}),(0,t.jsx)("input",{type:"password",value:A,onChange:e=>T(e.target.value),placeholder:"eyJhhGciOiJIUzI1NiIsInR5cCI...",className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-cyan-500 focus:border-cyan-500 placeholder-gray-600"})]}),(0,t.jsx)("button",{onClick:ef,className:`jsx-4f044084e7cd90f7 w-full font-bold py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 ${I?"bg-green-600 hover:bg-green-500 text-white cursor-default":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:I?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-check"})," 連線成功"]}):"測試連線"})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#252836] p-6 rounded-xl border border-gray-700 shadow-lg",children:[(0,t.jsxs)("h2",{className:"jsx-4f044084e7cd90f7 text-xl font-bold text-white mb-4 flex items-center",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 bg-cyan-900 text-cyan-400 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm",children:"2"}),"選擇資料來源"]}),(0,t.jsxs)("button",{onClick:eh,disabled:o,className:"jsx-4f044084e7cd90f7 w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-folder-open text-xl"})," 選擇 lvr_land 資料夾"]}),j.length>0&&(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 mt-4 p-3 bg-gray-800/50 rounded-lg text-sm",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex justify-between text-gray-300 mb-1",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7",children:"已找到檔案:"}),(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7 font-bold text-white",children:[j.length," 個"]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex justify-between text-gray-400 text-xs",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7",children:"主表 (Main):"}),(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7",children:j.filter(e=>e.isMain).length})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex justify-between text-gray-400 text-xs",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7",children:"附表 (Sub):"}),(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7",children:j.filter(e=>!e.isMain).length})]})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#252836] p-6 rounded-xl border border-gray-700 shadow-lg",children:[(0,t.jsxs)("h2",{className:"jsx-4f044084e7cd90f7 text-xl font-bold text-white mb-4 flex items-center",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 bg-cyan-900 text-cyan-400 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm",children:"3"}),"開始處理"]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 space-y-4",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-2",children:"上傳類型"}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 grid grid-cols-2 gap-2",children:["all","a","b","c"].map(e=>(0,t.jsxs)("label",{className:`jsx-4f044084e7cd90f7 cursor-pointer border rounded-lg p-2 text-center transition-all ${v===e?"bg-cyan-900/30 border-cyan-500 text-cyan-400":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:[(0,t.jsx)("input",{type:"radio",name:"uploadType",value:e,checked:v===e,onChange:e=>N(e.target.value),disabled:o,className:"jsx-4f044084e7cd90f7 sr-only"}),(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 font-bold",children:"all"===e?"全部":"a"===e?"中古":"b"===e?"預售":"租賃"})]},e))})]}),(0,t.jsxs)("button",{onClick:ex,disabled:!I||0===j.length||o,className:"jsx-4f044084e7cd90f7 w-full bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-bold py-3 px-4 rounded-lg shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o?(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-spinner fa-spin"}):(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-rocket"}),o?"處理中...":"開始上傳"]})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#252836] p-6 rounded-xl border border-gray-700 shadow-lg",children:[(0,t.jsxs)("h2",{className:"jsx-4f044084e7cd90f7 text-xl font-bold text-white mb-4 flex items-center",children:[(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 bg-cyan-900 text-cyan-400 w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm",children:"4"}),"資料批次修改 (獨立功能)"]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 space-y-4",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-1",children:"選擇縣市"}),(0,t.jsx)("select",{value:L,onChange:e=>F(e.target.value),className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-cyan-500 focus:border-cyan-500",children:Object.entries(i).map(([e,s])=>(0,t.jsx)("option",{value:e.toLowerCase(),className:"jsx-4f044084e7cd90f7",children:s},e))})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-2",children:"交易類型"}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 grid grid-cols-2 gap-2",children:["a","b","c"].map(e=>(0,t.jsxs)("label",{className:`jsx-4f044084e7cd90f7 cursor-pointer border rounded-lg p-2 text-center transition-all ${z===e?"bg-cyan-900/30 border-cyan-500 text-cyan-400":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-500"}`,children:[(0,t.jsx)("input",{type:"radio",name:"updateType",value:e,checked:z===e,onChange:e=>M(e.target.value),disabled:ee,className:"jsx-4f044084e7cd90f7 sr-only"}),(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 font-bold",children:"a"===e?"中古":"b"===e?"預售":"租賃"})]},e))})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-1",children:"搜尋欄位"}),(0,t.jsxs)("select",{value:P,onChange:e=>U(e.target.value),className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-cyan-500 focus:border-cyan-500",children:[Array.from(new Set(Object.values(l[z]||{}))).filter(e=>!["編號","id"].includes(e)).sort().map(e=>(0,t.jsx)("option",{value:e,className:"jsx-4f044084e7cd90f7",children:e},e)),(0,t.jsx)("option",{value:"編號",className:"jsx-4f044084e7cd90f7",children:"編號"})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-sm font-medium text-gray-400 mb-1",children:"關鍵字"}),(0,t.jsx)("input",{type:"text",value:K,onChange:e=>q(e.target.value),onKeyDown:e=>"Enter"===e.key&&eu(),placeholder:"輸入關鍵字...",className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded-lg px-3 py-2 text-white focus:ring-cyan-500 focus:border-cyan-500 placeholder-gray-600"})]}),(0,t.jsxs)("button",{onClick:eu,disabled:!I||ee,className:"jsx-4f044084e7cd90f7 w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[ee?(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-spinner fa-spin"}):(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-search"}),ee?"搜尋中...":"搜尋資料"]})]})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#252836] p-6 rounded-xl border border-gray-700 shadow-lg",children:[(0,t.jsxs)("h3",{className:"jsx-4f044084e7cd90f7 text-gray-300 font-bold mb-4 flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-tasks mr-2 text-purple-400"}),"執行進度"]}),o&&(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7 text-cyan-400",children:[S,"%"]})]}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 w-full bg-gray-700 rounded-full h-4 mb-2 overflow-hidden",children:(0,t.jsx)("div",{style:{width:`${S}%`},className:"jsx-4f044084e7cd90f7 bg-gradient-to-r from-cyan-500 to-purple-500 h-4 rounded-full transition-all duration-300 relative",children:o&&(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 absolute inset-0 bg-white/20 animate-pulse"})})}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-xs text-gray-500 h-5",children:_&&`正在處理: ${_}`})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-black/60 p-4 rounded-xl border border-gray-800 h-[500px] overflow-hidden flex flex-col font-mono text-sm shadow-inner",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex justify-between items-center mb-2 border-b border-gray-800 pb-2",children:[(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7 text-gray-400 font-bold",children:[(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-terminal mr-2"}),"系統日誌"]}),(0,t.jsx)("button",{onClick:()=>c([]),className:"jsx-4f044084e7cd90f7 text-xs text-gray-600 hover:text-gray-300 transition-colors",children:"清除"})]}),(0,t.jsxs)("div",{ref:e=>{e&&(e.scrollTop=e.scrollHeight)},className:"jsx-4f044084e7cd90f7 flex-1 overflow-y-auto space-y-1 p-2 custom-scrollbar",children:[n.map(e=>(0,t.jsxs)("div",{className:`jsx-4f044084e7cd90f7 flex gap-3 leading-relaxed border-b border-white/5 pb-1 ${"error"===e.type?"text-red-400 bg-red-900/10":"warning"===e.type?"text-yellow-400":"success"===e.type?"text-emerald-400":"text-gray-300"}`,children:[(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7 text-gray-600 select-none",children:["[",e.time,"]"]}),(0,t.jsx)("span",{className:"jsx-4f044084e7cd90f7 break-all",children:e.text})]},e.id)),0===n.length&&(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-gray-700 italic text-center mt-20",children:"等待任務啟動..."})]})]}),E&&(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-emerald-900/20 border border-emerald-800 p-4 rounded-xl text-center",children:[(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-3xl font-bold text-emerald-400",children:E.new}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-sm text-emerald-200/70 uppercase tracking-wider mt-1",children:"New"})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-yellow-900/20 border border-yellow-800 p-4 rounded-xl text-center",children:[(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-3xl font-bold text-yellow-400",children:E.updated}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-sm text-yellow-200/70 uppercase tracking-wider mt-1",children:"Updated"})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-gray-800/40 border border-gray-700 p-4 rounded-xl text-center",children:[(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-3xl font-bold text-gray-400",children:E.identical}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-sm text-gray-500 uppercase tracking-wider mt-1",children:"Skipped"})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-red-900/20 border border-red-800 p-4 rounded-xl text-center",children:[(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-3xl font-bold text-red-400",children:E.errors}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-sm text-red-200/70 uppercase tracking-wider mt-1",children:"Errors"})]})]})]})]})]}),H&&(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",children:(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#1a1d29] border border-gray-700 rounded-xl w-full max-w-6xl max-h-[90vh] flex flex-col shadow-2xl",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 p-4 border-b border-gray-700 flex justify-between items-center bg-[#252836] rounded-t-xl",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("h3",{className:"jsx-4f044084e7cd90f7 text-xl font-bold text-white",children:"批次修改搜尋結果"}),(0,t.jsxs)("p",{className:"jsx-4f044084e7cd90f7 text-sm text-gray-400 mt-1",children:["資料表: ",ea?.tableName," | 搜尋條件: ",i[L.toUpperCase()]," ",P," like '%",K,"%' | 共 ",B.length," 筆"]})]}),(0,t.jsx)("button",{onClick:()=>Q(!1),className:"jsx-4f044084e7cd90f7 text-gray-400 hover:text-white transition-colors",children:(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-times text-xl"})})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 p-4 border-b border-gray-700 bg-gray-800/50 flex gap-4 items-end flex-wrap",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex items-center gap-2 text-sm text-gray-300",children:[(0,t.jsx)("input",{type:"checkbox",checked:J.size>0&&J.size===B.length,onChange:ep,className:"jsx-4f044084e7cd90f7 form-checkbox h-5 w-5 text-cyan-600 bg-gray-700 border-gray-600 rounded"}),(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7",children:["全選 (",J.size," 筆)"]})]}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 flex-1"}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex gap-2 items-center",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"欲修改欄位"}),(0,t.jsx)("select",{value:Z,onChange:e=>V(e.target.value),className:"jsx-4f044084e7cd90f7 bg-gray-800 border-gray-600 rounded px-3 py-1.5 text-sm text-white focus:ring-cyan-500",children:Array.from(new Set(Object.values(l[z]||{}))).filter(e=>!["編號","id"].includes(e)).sort().map(e=>(0,t.jsx)("option",{value:e,className:"jsx-4f044084e7cd90f7",children:e},e))})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"新數值"}),(0,t.jsx)("input",{type:"text",value:X,onChange:e=>Y(e.target.value),placeholder:"輸入新內容...",className:"jsx-4f044084e7cd90f7 bg-gray-800 border-gray-600 rounded px-3 py-1.5 text-sm text-white w-48 focus:ring-cyan-500"})]}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 pb-0.5",children:(0,t.jsx)("button",{onClick:em,disabled:0===J.size||es,className:"jsx-4f044084e7cd90f7 bg-red-600 hover:bg-red-500 text-white font-bold py-1.5 px-4 rounded transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed h-[34px]",children:es?"更新中...":"執行批次更新"})})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex-1 overflow-auto p-4 custom-scrollbar",children:[(0,t.jsxs)("table",{className:"jsx-4f044084e7cd90f7 w-full text-left border-collapse",children:[(0,t.jsx)("thead",{className:"jsx-4f044084e7cd90f7 bg-gray-800 sticky top-0 z-10",children:(0,t.jsxs)("tr",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-12",children:"選取"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-24",children:"編號"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-24",children:"行政區"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-48",children:"建案名稱"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700",children:"地址/位置"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-16",children:"操作"})]})}),(0,t.jsx)("tbody",{className:"jsx-4f044084e7cd90f7 text-sm",children:B.map((e,s)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:"jsx-4f044084e7cd90f7 hover:bg-white/5 border-b border-gray-800",children:[(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3",children:(0,t.jsx)("input",{type:"checkbox",checked:J.has(e["編號"]),onChange:()=>eg(e["編號"]),className:"jsx-4f044084e7cd90f7 form-checkbox h-4 w-4 text-cyan-600 bg-gray-700 border-gray-600 rounded"})}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3 font-mono text-xs text-gray-400",children:e["編號"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3",children:e["行政區"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3 text-cyan-300",children:e["建案名稱"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3 text-gray-400 truncate max-w-[200px]",children:e["其他門牌"]||e["地址"]||e["土地位置建物門牌"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3",children:(0,t.jsx)("button",{onClick:()=>ej(s),className:"jsx-4f044084e7cd90f7 text-gray-500 hover:text-white text-xs underline",children:ei.has(s)?"收合":"明細"})})]},e["編號"]),ei.has(s)&&(0,t.jsx)("tr",{className:"jsx-4f044084e7cd90f7 bg-gray-900/50",children:(0,t.jsx)("td",{colSpan:6,className:"jsx-4f044084e7cd90f7 p-4 border-b border-gray-800",children:(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:Object.entries(e).filter(([e])=>"id"!==e).map(([e,s])=>(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-gray-500 mb-1",children:e}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-gray-300 break-all",children:String(s)})]},e))})})})]}))})]}),0===B.length&&(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-center py-20 text-gray-500",children:"無符合資料"})]})]})}),H&&(0,t.jsx)("div",{onClick:()=>Q(!1),className:"jsx-4f044084e7cd90f7 fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 transition-opacity animate-in fade-in duration-200",children:(0,t.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"jsx-4f044084e7cd90f7 bg-[#1a1d29] border border-gray-700 rounded-xl w-full max-w-6xl max-h-[90vh] flex flex-col shadow-2xl relative",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 p-4 border-b border-gray-700 flex justify-between items-center bg-[#252836] rounded-t-xl",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("h3",{className:"jsx-4f044084e7cd90f7 text-xl font-bold text-white",children:"批次修改搜尋結果"}),(0,t.jsxs)("p",{className:"jsx-4f044084e7cd90f7 text-sm text-gray-400 mt-1",children:["資料表: ",ea?.tableName," | 搜尋條件: ",i[L.toUpperCase()]," ",P," like '%",K,"%' | 共 ",B.length," 筆"]})]}),(0,t.jsx)("button",{onClick:()=>Q(!1),title:"關閉視窗 (Esc)",className:"jsx-4f044084e7cd90f7 text-gray-400 hover:text-white hover:bg-gray-700/50 p-2 rounded-full transition-colors flex items-center justify-center w-8 h-8",children:(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-times text-xl"})})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 bg-[#252836] border-b border-gray-700",children:[(0,t.jsxs)("button",{onClick:()=>ed(!ec),className:"jsx-4f044084e7cd90f7 w-full text-center py-2 text-xs text-gray-500 hover:text-white hover:bg-gray-700/50 transition-colors flex items-center justify-center gap-2",children:[(0,t.jsx)("i",{className:`jsx-4f044084e7cd90f7 fas fa-search ${ec?"text-cyan-400":""}`}),ec?"收合搜尋條件":"再次搜尋 / 修改條件"]}),ec&&(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 p-4 grid grid-cols-1 md:grid-cols-5 gap-4 animate-in slide-in-from-top-2 duration-200",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"縣市"}),(0,t.jsx)("select",{value:L,onChange:e=>F(e.target.value),className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded px-2 py-1.5 text-sm text-white focus:ring-cyan-500",children:Object.entries(i).map(([e,s])=>(0,t.jsx)("option",{value:e.toLowerCase(),className:"jsx-4f044084e7cd90f7",children:s},e))})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"類型"}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 flex bg-gray-800 rounded border border-gray-600 p-0.5",children:["a","b","c"].map(e=>(0,t.jsx)("button",{onClick:()=>M(e),className:`jsx-4f044084e7cd90f7 flex-1 text-xs py-1 rounded transition-colors ${z===e?"bg-cyan-900 text-cyan-400":"text-gray-400 hover:text-white"}`,children:"a"===e?"中古":"b"===e?"預售":"租賃"},e))})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"欄位"}),(0,t.jsxs)("select",{value:P,onChange:e=>U(e.target.value),className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded px-2 py-1.5 text-sm text-white focus:ring-cyan-500",children:[Array.from(new Set(Object.values(l[z]||{}))).filter(e=>!["編號","id"].includes(e)).sort().map(e=>(0,t.jsx)("option",{value:e,className:"jsx-4f044084e7cd90f7",children:e},e)),(0,t.jsx)("option",{value:"編號",className:"jsx-4f044084e7cd90f7",children:"編號"})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"關鍵字"}),(0,t.jsx)("input",{type:"text",value:K,onChange:e=>q(e.target.value),onKeyDown:e=>"Enter"===e.key&&eu(),placeholder:"關鍵字...",className:"jsx-4f044084e7cd90f7 w-full bg-gray-800 border-gray-600 rounded px-2 py-1.5 text-sm text-white focus:ring-cyan-500"})]}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 flex items-end",children:(0,t.jsxs)("button",{onClick:eu,disabled:ee,className:"jsx-4f044084e7cd90f7 w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-1.5 px-4 rounded transition-colors text-sm h-[34px] flex items-center justify-center gap-2 disabled:opacity-50",children:[ee?(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-spinner fa-spin"}):(0,t.jsx)("i",{className:"jsx-4f044084e7cd90f7 fas fa-search"}),"搜尋"]})})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 p-4 border-b border-gray-700 bg-gray-800/50 flex gap-4 items-end flex-wrap",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex items-center gap-2 text-sm text-gray-300",children:[(0,t.jsx)("input",{type:"checkbox",checked:J.size>0&&J.size===B.length,onChange:ep,className:"jsx-4f044084e7cd90f7 form-checkbox h-5 w-5 text-cyan-600 bg-gray-700 border-gray-600 rounded"}),(0,t.jsxs)("span",{className:"jsx-4f044084e7cd90f7",children:["全選 (",J.size," 筆)"]})]}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 flex-1"}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex gap-2 items-center",children:[(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"欲修改欄位"}),(0,t.jsx)("select",{value:Z,onChange:e=>V(e.target.value),className:"jsx-4f044084e7cd90f7 bg-gray-800 border-gray-600 rounded px-3 py-1.5 text-sm text-white focus:ring-cyan-500",children:Array.from(new Set(Object.values(l[z]||{}))).filter(e=>!["編號","id"].includes(e)).sort().map(e=>(0,t.jsx)("option",{value:e,className:"jsx-4f044084e7cd90f7",children:e},e))})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("label",{className:"jsx-4f044084e7cd90f7 block text-xs text-gray-400 mb-1",children:"新數值"}),(0,t.jsx)("input",{type:"text",value:X,onChange:e=>Y(e.target.value),placeholder:"輸入新內容...",className:"jsx-4f044084e7cd90f7 bg-gray-800 border-gray-600 rounded px-3 py-1.5 text-sm text-white w-48 focus:ring-cyan-500"})]}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 pb-0.5",children:(0,t.jsx)("button",{onClick:em,disabled:0===J.size||es,className:"jsx-4f044084e7cd90f7 bg-red-600 hover:bg-red-500 text-white font-bold py-1.5 px-4 rounded transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed h-[34px]",children:es?"更新中...":"執行批次更新"})})]})]}),(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7 flex-1 overflow-auto p-4 custom-scrollbar",children:[(0,t.jsxs)("table",{className:"jsx-4f044084e7cd90f7 w-full text-left border-collapse",children:[(0,t.jsx)("thead",{className:"jsx-4f044084e7cd90f7 bg-gray-800 sticky top-0 z-10",children:(0,t.jsxs)("tr",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-12",children:"選取"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-24",children:"編號"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-24",children:"行政區"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-48",children:"建案名稱"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700",children:"地址/位置"}),(0,t.jsx)("th",{className:"jsx-4f044084e7cd90f7 p-3 text-xs font-bold text-gray-400 border-b border-gray-700 w-16",children:"操作"})]})}),(0,t.jsx)("tbody",{className:"jsx-4f044084e7cd90f7 text-sm",children:B.map((e,s)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:"jsx-4f044084e7cd90f7 hover:bg-white/5 border-b border-gray-800",children:[(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3",children:(0,t.jsx)("input",{type:"checkbox",checked:J.has(e["編號"]),onChange:()=>eg(e["編號"]),className:"jsx-4f044084e7cd90f7 form-checkbox h-4 w-4 text-cyan-600 bg-gray-700 border-gray-600 rounded"})}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3 font-mono text-xs text-gray-400",children:e["編號"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3",children:e["行政區"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3 text-cyan-300",children:e["建案名稱"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3 text-gray-400 truncate max-w-[200px]",children:e["其他門牌"]||e["地址"]||e["土地位置建物門牌"]}),(0,t.jsx)("td",{className:"jsx-4f044084e7cd90f7 p-3",children:(0,t.jsx)("button",{onClick:()=>ej(s),className:"jsx-4f044084e7cd90f7 text-gray-500 hover:text-white text-xs underline",children:ei.has(s)?"收合":"明細"})})]},e["編號"]),ei.has(s)&&(0,t.jsx)("tr",{className:"jsx-4f044084e7cd90f7 bg-gray-900/50",children:(0,t.jsx)("td",{colSpan:6,className:"jsx-4f044084e7cd90f7 p-4 border-b border-gray-800",children:(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:Object.entries(e).filter(([e])=>"id"!==e).map(([e,s])=>(0,t.jsxs)("div",{className:"jsx-4f044084e7cd90f7",children:[(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-gray-500 mb-1",children:e}),(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-gray-300 break-all",children:String(s)})]},e))})})})]}))})]}),0===B.length&&(0,t.jsx)("div",{className:"jsx-4f044084e7cd90f7 text-center py-20 text-gray-500",children:"無符合資料"})]})]})}),(0,t.jsx)(s.default,{id:"4f044084e7cd90f7",children:".custom-scrollbar::-webkit-scrollbar{width:8px}.custom-scrollbar::-webkit-scrollbar-track{background:#0003}.custom-scrollbar::-webkit-scrollbar-thumb{background:#ffffff1a;border-radius:4px}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:#fff3}"})]})}e.s(["default",()=>N],23346)}]);