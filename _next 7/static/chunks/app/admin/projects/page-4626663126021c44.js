(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3321],{1610:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]])},1934:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});var a=s(12115);let l=e=>{let t,s=new Set,a=(e,a)=>{let l="function"==typeof e?e(t):e;if(!Object.is(l,t)){let e=t;t=(null!=a?a:"object"!=typeof l||null===l)?l:Object.assign({},t,l),s.forEach(s=>s(t,e))}},l=()=>t,n={setState:a,getState:l,getInitialState:()=>i,subscribe:e=>(s.add(e),()=>s.delete(e))},i=t=e(a,l,n);return n},n=e=>{let t=e?l(e):l,s=e=>(function(e,t=e=>e){let s=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>t(e.getState()),[e,t]),a.useCallback(()=>t(e.getInitialState()),[e,t]));return a.useDebugValue(s),s})(t,e);return Object.assign(s,t),s},i=e=>e?n(e):n},6296:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},20509:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var a=s(95155),l=s(12115),n=s(16385),i=s(73321),c=s(86120),r=s(14670),d=s(78340);let o=(0,d.A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var x=s(53961),p=s(84980),h=s(80723),m=s(6296),u=s(66088),b=s(61878),g=s(50049),j=s(21362),f=s(1610);let v=(0,d.A)("drafting-compass",[["path",{d:"m12.99 6.74 1.93 3.44",key:"iwagvd"}],["path",{d:"M19.136 12a10 10 0 0 1-14.271 0",key:"ppmlo4"}],["path",{d:"m21 21-2.16-3.84",key:"vylbct"}],["path",{d:"m3 21 8.02-14.26",key:"1ssaw4"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}]]),y=(0,d.A)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),N=(0,d.A)("circle-parking",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9 17V7h4a3 3 0 0 1 0 6H9",key:"1dfk2c"}]]);var z=s(55243),k=s(95057),w=s(33210),_=s(13545),A=s(8875);let C=[{label:"台北市",code:"a"},{label:"台中市",code:"b"},{label:"基隆市",code:"c"},{label:"台南市",code:"d"},{label:"高雄市",code:"e"},{label:"新北市",code:"f"},{label:"宜蘭縣",code:"g"},{label:"桃園市",code:"h"},{label:"嘉義市",code:"i"},{label:"新竹縣",code:"j"},{label:"苗栗縣",code:"k"},{label:"南投縣",code:"m"},{label:"彰化縣",code:"n"},{label:"新竹市",code:"o"},{label:"雲林縣",code:"p"},{label:"嘉義縣",code:"q"},{label:"屏東縣",code:"t"},{label:"花蓮縣",code:"u"},{label:"台東縣",code:"v"},{label:"金門縣",code:"w"},{label:"澎湖縣",code:"x"},{label:"連江縣",code:"z"}];function M(){let e=(0,i.useRouter)(),{isAdmin:t,isLoading:s}=(0,c.b)(),{guard:d}=(0,r.X)("manage_projects"),[M,S]=(0,l.useState)(C[0]),[q,L]=(0,l.useState)([]),[E,$]=(0,l.useState)(!0),[O,H]=(0,l.useState)(""),[V,D]=(0,l.useState)("all"),[I,P]=(0,l.useState)(null),[B,R]=(0,l.useState)(null),[T,W]=(0,l.useState)(!1),[X,F]=(0,l.useState)(null),[G,J]=(0,l.useState)([]),[K,Q]=(0,l.useState)(!1),{permissions:U}=(0,c.b)();(0,l.useEffect)(()=>{if(!s&&t&&U){let{accessibleCounties:e,isSuperAdmin:t}=U;if(!t&&null!==e&&!e.includes(M.code)){let t=C.find(t=>e.includes(t.code));t&&S(t)}}},[s,t,U,M]),(0,l.useEffect)(()=>{!s&&t&&Y()},[s,t,M,V]);let Y=async()=>{$(!0);try{let e=`${M.code.toLowerCase()}_projects`,t=n.N.from(e).select("*");"all"!==V&&(t=t.eq("enrichment_status",V));let{data:s,error:a}=await t.order("project_name",{ascending:!0}).limit(200);if(a)throw a;L(s||[])}catch(e){console.error("Error fetching projects:",e)}finally{$(!1)}},Z=(0,i.useSearchParams)().get("openConfig");(0,l.useEffect)(()=>{if(!E&&q.length>0&&Z&&!X){let e=q.find(e=>e.project_name===Z);e&&es(e)}},[E,q,Z,X]);let ee=async e=>{R(e.id);try{let t=`${M.code.toLowerCase()}_projects`,{error:s}=await n.N.from(t).update({...e,last_enriched_at:new Date().toISOString()}).eq("id",e.id);if(s)throw s;L(t=>t.map(t=>t.id===e.id?{...e}:t))}catch(e){alert("儲存失敗："+e.message)}finally{R(null)}},et=async()=>{W(!0);try{let e=`${M.code.toLowerCase()}_projects`,t=q.filter(e=>"pending"===e.enrichment_status).slice(0,10);if(0===t.length)return void alert("當前列表中沒有「待補」的建案。");let s=t.map(e=>e.id),{error:a}=await n.N.from(e).update({enrichment_status:"requested"}).in("id",s);if(a)throw a;L(e=>e.map(e=>s.includes(e.id)?{...e,enrichment_status:"requested"}:e)),alert(`已成功將 ${s.length} 筆建案「委託」給 Agent。現在請在對話框輸入 /batch-enrich，我將會立刻開始處理！`)}catch(e){alert("操作失敗："+e.message)}finally{W(!1)}},es=async e=>{F(e),Q(!0);try{let t=M.code.toLowerCase(),s=`${t}_lvr_land_a`,a=`${t}_lvr_land_b`,[l,i]=await Promise.all([n.N.from(s).select("*").eq("建案名稱",e.project_name),n.N.from(a).select("*").eq("建案名稱",e.project_name)]);l.error&&console.warn("Error fetching table A:",l.error),i.error&&console.warn("Error fetching table B:",i.error);let c=l.data||[],r=i.data||[],d=[...c,...r];J(d)}catch(e){console.error("Error fetching transactions:",e),alert("無法讀取實價登錄資料："+e.message),F(null)}finally{Q(!1)}},ea=({status:e})=>{switch(e){case"done":return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 rounded-full",children:[(0,a.jsx)(o,{className:"h-3 w-3"})," 完備"]});case"requested":return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-medium bg-amber-500/10 text-amber-400 border border-amber-500/20 rounded-full animate-pulse",children:[(0,a.jsx)(x.A,{className:"h-3 w-3"})," 代辦 (Agent)"]});default:return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-medium bg-zinc-800 text-zinc-400 border border-zinc-700 rounded-full",children:[(0,a.jsx)(p.A,{className:"h-3 w-3"})," 待補 (人工)"]})}},el=q.filter(e=>e.project_name.toLowerCase().includes(O.toLowerCase())||e.developer?.toLowerCase().includes(O.toLowerCase())||e.affiliated_companies?.toLowerCase().includes(O.toLowerCase()));return d||(0,a.jsxs)("div",{className:"min-h-screen bg-dark-bg text-gray-100 p-4 md:p-8",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto font-sans",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-5",children:[(0,a.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"p-2 hover:bg-zinc-800 rounded-full transition-colors text-zinc-500 hover:text-white",children:(0,a.jsx)(h.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h1",{className:"text-3xl font-black text-white tracking-tight",children:"建案數據中控台"}),(0,a.jsx)("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-400 text-[10px] font-bold rounded uppercase tracking-widest",children:"Admin v2.0"})]}),(0,a.jsx)("p",{className:"text-zinc-500 text-sm mt-1",children:"即時管理全台建案規格與補全狀態"})]})]}),(0,a.jsxs)("button",{onClick:et,disabled:T,className:"flex items-center gap-2 px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold shadow-lg shadow-indigo-500/20 transition-all active:scale-95 disabled:opacity-50",children:[T?(0,a.jsx)(m.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(x.A,{className:"h-4 w-4"}),"委託 Agent 補全數據 (下 10 筆)"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 mb-8 bg-zinc-900/50 p-4 rounded-2xl border border-zinc-800/50 backdrop-blur-sm",children:[(0,a.jsxs)("div",{className:"md:col-span-2 relative",children:[(0,a.jsx)("select",{value:M.code,onChange:e=>S(C.find(t=>t.code===e.target.value)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-xl px-4 py-3 text-sm font-bold focus:ring-2 focus:ring-indigo-500/50 outline-none appearance-none cursor-pointer",children:C.map(e=>{let t=U?.isSuperAdmin||U?.accessibleCounties===null||U?.accessibleCounties?.includes(e.code);return(0,a.jsxs)("option",{value:e.code,disabled:!t,className:t?"":"text-zinc-600 bg-zinc-900",children:[e.label," ",t?"":"(無權限)"]},e.code)})}),(0,a.jsx)(u.A,{className:"absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 text-zinc-600 pointer-events-none"})]}),(0,a.jsxs)("div",{className:"md:col-span-6 relative",children:[(0,a.jsx)(b.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-zinc-600"}),(0,a.jsx)("input",{type:"text",placeholder:"搜尋建案名稱、建設公司、關係企業...",value:O,onChange:e=>H(e.target.value),className:"w-full bg-zinc-950 border border-zinc-800 rounded-xl pl-11 pr-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500/50 outline-none"})]}),(0,a.jsxs)("div",{className:"md:col-span-2 relative",children:[(0,a.jsxs)("select",{value:V,onChange:e=>D(e.target.value),className:"w-full bg-zinc-950 border border-zinc-800 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-500/50 outline-none appearance-none cursor-pointer",children:[(0,a.jsx)("option",{value:"all",children:"全部狀態"}),(0,a.jsx)("option",{value:"requested",children:"代辦 (Agent)"}),(0,a.jsx)("option",{value:"pending",children:"待補 (人工)"}),(0,a.jsx)("option",{value:"done",children:"完備"})]}),(0,a.jsx)(u.A,{className:"absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 text-zinc-600 pointer-events-none"})]}),(0,a.jsxs)("div",{className:"md:col-span-2 flex items-center justify-center text-zinc-600 text-xs font-mono",children:["Count: ",el.length]})]}),(0,a.jsx)("div",{className:"space-y-4",children:E?(0,a.jsxs)("div",{className:"py-20 flex flex-col items-center gap-4",children:[(0,a.jsx)(m.A,{className:"h-10 w-10 text-indigo-500 animate-spin"}),(0,a.jsx)("span",{className:"text-zinc-500 font-medium",children:"盤點數據中..."})]}):0===el.length?(0,a.jsx)("div",{className:"py-20 text-center text-zinc-500 border-2 border-dashed border-zinc-800 rounded-3xl",children:"尚無符合條件的數據"}):el.map(e=>{let t=I===e.id;return(0,a.jsxs)("div",{className:`group border transition-all duration-300 rounded-2xl overflow-hidden ${t?"bg-zinc-900 border-indigo-500/50 shadow-2xl shadow-indigo-500/10":"bg-zinc-900/40 border-zinc-800 hover:border-zinc-700"}`,children:[(0,a.jsxs)("div",{onClick:()=>P(t?null:e.id),className:"px-6 py-5 cursor-pointer flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,a.jsx)("div",{className:`p-2 rounded-xl transition-colors ${t?"bg-indigo-500 text-white":"bg-zinc-800 text-zinc-400 group-hover:bg-zinc-700"}`,children:(0,a.jsx)(g.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-bold text-white group-hover:text-indigo-400 transition-colors",children:e.project_name}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,a.jsx)("span",{className:"text-xs text-zinc-500 font-medium",children:e.developer||"建商未載"}),(0,a.jsx)("span",{className:"w-1 h-1 bg-zinc-700 rounded-full"}),(0,a.jsx)("span",{className:"text-[10px] text-zinc-600 uppercase font-mono tracking-tighter",children:e.id.split("-")[0]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-8",children:[(0,a.jsx)("div",{className:"hidden md:block",children:(0,a.jsx)(ea,{status:e.enrichment_status})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-[10px] text-zinc-600 font-bold uppercase tracking-widest leading-none",children:"Last Sync"}),(0,a.jsx)("p",{className:"text-xs text-zinc-400 mt-1",children:e.last_enriched_at?new Date(e.last_enriched_at).toLocaleDateString("zh-TW"):"-"})]}),(0,a.jsx)(j.A,{className:`h-5 w-5 text-zinc-600 transition-transform duration-300 ${t?"rotate-90 text-indigo-400":""}`})]})]})]}),t&&(0,a.jsx)("div",{className:"px-6 pb-6 pt-2 border-t border-zinc-800 animate-in slide-in-from-top-4 duration-300",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-x-8 gap-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"開發與關係企業"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"投資建設"}),(0,a.jsx)("input",{type:"text",value:e.developer||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,developer:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 focus:border-indigo-500 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"關係企業"}),(0,a.jsx)("input",{type:"text",value:e.affiliated_companies||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,affiliated_companies:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 focus:border-indigo-500 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"工程營造"}),(0,a.jsx)("input",{type:"text",value:e.contractor||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,contractor:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 focus:border-indigo-500 outline-none"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400",children:[(0,a.jsx)(v,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"規劃與案名"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"建築設計"}),(0,a.jsx)("input",{type:"text",value:e.architect||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,architect:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 focus:border-indigo-500 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"代銷企劃"}),(0,a.jsx)("input",{type:"text",value:e.sales_agent||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,sales_agent:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 focus:border-indigo-500 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"建造執照"}),(0,a.jsx)("input",{type:"text",value:e.construction_license||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,construction_license:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 focus:border-indigo-500 outline-none"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400",children:[(0,a.jsx)(y,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"基地與規格"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"基地規模(坪)"}),(0,a.jsx)("input",{type:"text",value:e.site_area||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,site_area:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"公設比"}),(0,a.jsx)("input",{type:"text",value:e.public_ratio||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,public_ratio:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"地上層"}),(0,a.jsx)("input",{type:"text",value:e.total_floors||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,total_floors:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"地下層"}),(0,a.jsx)("input",{type:"text",value:e.basement_floors||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,basement_floors:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"土地使用分區 (新)"}),(0,a.jsx)("input",{type:"text",value:e.land_use_zoning||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,land_use_zoning:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"地號"}),(0,a.jsx)("input",{type:"text",value:e.land_plot_number||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,land_plot_number:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"社區戶數"}),(0,a.jsx)("input",{type:"number",value:e.community_unit_count||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,community_unit_count:parseInt(t.target.value)||0}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"結構類型"}),(0,a.jsx)("input",{type:"text",value:e.structure||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,structure:t.target.value}:s)),className:"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400",children:[(0,a.jsx)(N,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"車位與狀態"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"車位/數量"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"型態",value:e.parking_type||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,parking_type:t.target.value}:s)),className:"w-2/3 bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"}),(0,a.jsx)("input",{type:"text",placeholder:"數",value:e.parking_count||"",onChange:t=>L(s=>s.map(s=>s.id===e.id?{...s,parking_count:t.target.value}:s)),className:"w-1/3 bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-1.5 text-xs text-zinc-300 outline-none"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] text-zinc-600 font-bold block mb-1",children:"標記狀態"}),(0,a.jsx)("div",{className:"flex gap-1",children:[{val:"requested",label:"代辦"},{val:"pending",label:"待補"},{val:"done",label:"完備"}].map(t=>(0,a.jsx)("button",{onClick:()=>L(s=>s.map(s=>s.id===e.id?{...s,enrichment_status:t.val}:s)),className:`flex-1 py-1 rounded text-[9px] font-bold border transition-colors ${e.enrichment_status===t.val?"bg-indigo-500 border-indigo-400 text-white":"bg-zinc-950 border-zinc-800 text-zinc-600 hover:text-zinc-400"}`,children:t.label},t.val))})]}),(0,a.jsxs)("button",{onClick:()=>ee(e),disabled:B===e.id,className:"w-full mt-4 flex items-center justify-center gap-2 py-3 bg-white text-black hover:bg-zinc-200 rounded-xl font-black text-xs uppercase transition-all shadow-xl shadow-white/5 active:scale-95 disabled:opacity-50",children:[B===e.id?(0,a.jsx)(m.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(z.A,{className:"h-4 w-4"}),"確認並儲存變更"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400",children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"平面圖配置"})]}),(0,a.jsxs)("div",{className:"p-4 bg-zinc-950/50 rounded-xl border border-zinc-800/50",children:[(0,a.jsx)("p",{className:"text-xs text-zinc-400 mb-3",children:"您可以直接在此設定樓層戶型配置。設定完成並發布後，將同步更新至前台報表。"}),(0,a.jsxs)("button",{onClick:()=>es(e),className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-xs font-bold transition-colors border border-zinc-700 hover:border-zinc-600",children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),"開啟配置編輯器"]})]})]})]})})]},e.id)})})]}),X&&(0,a.jsx)("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-dark-card w-full max-w-6xl h-[90vh] rounded-2xl border border-zinc-700 shadow-2xl flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-700 bg-zinc-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(k.A,{className:"h-5 w-5 text-indigo-400"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-white",children:["配置編輯器：",X.project_name]}),(0,a.jsx)("p",{className:"text-xs text-zinc-500",children:"Admin Mode"})]})]}),(0,a.jsx)("button",{onClick:()=>F(null),className:"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors",children:(0,a.jsx)(w.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto bg-dark-bg relative",children:K?(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-4 text-zinc-400",children:[(0,a.jsx)(m.A,{className:"h-8 w-8 animate-spin text-indigo-500"}),(0,a.jsx)("span",{className:"text-xs font-mono",children:"載入交易資料中..."})]}):G.length>0?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(A.sB,{transactions:G,project:X.project_name,configOnly:!0,title:`平面配置設定 - ${X.project_name}`,mode:"admin"})}):(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-4 text-zinc-500",children:[(0,a.jsx)(_.A,{className:"h-10 w-10 opacity-50"}),(0,a.jsx)("p",{children:"此建案尚無實價登錄資料，無法進行配置。"}),(0,a.jsx)("button",{onClick:()=>F(null),className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-xs font-bold transition-colors",children:"關閉"})]})})]})})]})}function S(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-zinc-500 flex flex-col items-center gap-2",children:[(0,a.jsx)(m.A,{className:"h-8 w-8 animate-spin"}),(0,a.jsx)("span",{children:"載入中..."})]})}),children:(0,a.jsx)(M,{})})}},24538:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},33210:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},44071:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},50049:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]])},53961:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},54452:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]])},61878:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},62032:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},66088:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},66614:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},75942:(e,t,s)=>{Promise.resolve().then(s.bind(s,20509))},80723:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},82482:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},84980:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},94514:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])}},e=>{e.O(0,[4764,5969,9919,8962,4670,8875,8441,3794,7358],()=>e(e.s=75942)),_N_E=e.O()}]);