# Heatmap Report (建案銷控表與調價熱力圖)

## 1. 概述
`HeatmapReport` 提供建案內部的定價策略可視化。透過顏色深淺顯示不同戶別、樓層的單價差異與溢價狀況，幫助分析建案的銷控策略（如保留戶、階段性調價）。

## 2. 功能特點
- **建案選擇**: 下拉選單切換不同建案的熱力圖。
- **樓層價差試算**: 
  - 允許使用者輸入「起樓」與「迄樓」計算該區間的加權平均單價。
  - 用於評估特定樓層區段的定價水準。
- **熱力圖網格 (`PricingHeatmap`)**:
  - X軸為戶別 (Unit)，Y軸為樓層 (Floor)。
  - 顏色代表溢價率（相較於基準單價的差異）。
  - 支援過濾商業用途（店面、辦公室）。
- **調價參數控制**:
  - `floorPremium`: 設定樓層價差參數（萬/坪）。
  - `initialWindowDays`: 設定銷售初期基準天數，用於計算基準價格。
  - 自動試算建議價差功能 (`Wand2` button)。
- **水平價差比較**: 分析同一樓層不同戶型的價格差異。

## 3. props 定義
- `data`: `AnalysisData` 物件，必須包含 `priceGridAnalysis` 與 `transactionDetails`。

## 4. 關鍵邏輯
- **熱力圖生成 (`generateHeatmapData`)**: 
  - 根據交易時間與樓層，動態計算該建案的「基準單價」。
  - 計算每一戶的實際成交價與理論價格的差異（溢價率）。
- **自動建議 (`calculateSuggestedFloorPremium`)**: 
  - 分析同一戶型在不同樓層的成交價，回歸推算出最該建案的平均樓層價差。
- **過濾邏輯**: 
  - 支援透過 Store 設定 `excludeCommercial` 來排除非住宅產品，避免干擾住宅價格熱力圖。
