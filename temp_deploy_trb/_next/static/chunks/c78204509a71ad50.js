(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3797,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let s=e.r(11319);function n({reason:e,children:t}){if("u"<typeof window)throw Object.defineProperty(new s.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},89938,(e,t,r)=>{"use strict";function s(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"encodeURIPath",{enumerable:!0,get:function(){return s}})},46577,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"PreloadChunks",{enumerable:!0,get:function(){return o}});let s=e.r(25191),n=e.r(1801),i=e.r(12424),a=e.r(89938),l=e.r(39534);function o({moduleIds:e}){if("u">typeof window)return null;let t=i.workAsyncStorage.getStore();if(void 0===t)return null;let r=[];if(t.reactLoadableManifest&&e){let s=t.reactLoadableManifest;for(let t of e){if(!s[t])continue;let e=s[t].files;r.push(...e)}}if(0===r.length)return null;let o=(0,l.getDeploymentIdQueryOrEmptyString)();return(0,s.jsx)(s.Fragment,{children:r.map(e=>{let r=`${t.assetPrefix}/_next/${(0,a.encodeURIPath)(e)}${o}`;return e.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:r,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,n.preload)(r,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},67591,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return c}});let s=e.r(25191),n=e.r(68524),i=e.r(3797),a=e.r(46577);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},c=function(e){let t={...o,...e},r=(0,n.lazy)(()=>t.loader().then(l)),c=t.loading;function d(e){let l=c?(0,s.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,d=o?n.Suspense:n.Fragment,m=t.ssr?(0,s.jsxs)(s.Fragment,{children:["u"<typeof window?(0,s.jsx)(a.PreloadChunks,{moduleIds:t.modules}):null,(0,s.jsx)(r,{...e})]}):(0,s.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(r,{...e})});return(0,s.jsx)(d,{...o?{fallback:l}:{},children:m})}return d.displayName="LoadableComponent",d}},67123,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return n}});let s=e.r(79031)._(e.r(67591));function n(e,t){let r={};"function"==typeof e&&(r.loader=e);let n={...r,...t};return(0,s.default)({...n,modules:n.loadableGenerated?.modules})}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},6698,e=>{"use strict";let t,r,s,n,i,a;var l=e.i(25191),o=e.i(68524),c=e.i(41724),d=e.i(72328);function m(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(r=0;r<i;r++)t[r]&&(s=e(t[r]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s);return n}(e))&&(s&&(s+=" "),s+=t);return s}let x=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),u=[],h=(e,t,r)=>{if(0==e.length-t)return r.classGroupId;let s=e[t],n=r.nextPart.get(s);if(n){let r=h(e,t+1,n);if(r)return r}let i=r.validators;if(null===i)return;let a=0===t?e.join("-"):e.slice(t).join("-"),l=i.length;for(let e=0;e<l;e++){let t=i[e];if(t.validator(a))return t.classGroupId}},p=(e,t)=>{let r=x();for(let s in e)f(e[s],r,s,t);return r},f=(e,t,r,s)=>{let n=e.length;for(let i=0;i<n;i++)g(e[i],t,r,s)},g=(e,t,r,s)=>{"string"==typeof e?b(e,t,r):"function"==typeof e?y(e,t,r,s):j(e,t,r,s)},b=(e,t,r)=>{(""===e?t:v(t,e)).classGroupId=r},y=(e,t,r,s)=>{N(e)?f(e(s),t,r,s):(null===t.validators&&(t.validators=[]),t.validators.push({classGroupId:r,validator:e}))},j=(e,t,r,s)=>{let n=Object.entries(e),i=n.length;for(let e=0;e<i;e++){let[i,a]=n[e];f(a,v(t,i),r,s)}},v=(e,t)=>{let r=e,s=t.split("-"),n=s.length;for(let e=0;e<n;e++){let t=s[e],n=r.nextPart.get(t);n||(n=x(),r.nextPart.set(t,n)),r=n}return r},N=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,w=[],k=(e,t,r,s,n)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:s,isExternal:n}),z=/\s+/,P=e=>{let t;if("string"==typeof e)return e;let r="";for(let s=0;s<e.length;s++)e[s]&&(t=P(e[s]))&&(r&&(r+=" "),r+=t);return r},S=[],M=e=>{let t=t=>t[e]||S;return t.isThemeGetter=!0,t},C=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,A=/^\((?:(\w[\w-]*):)?(.+)\)$/i,R=/^\d+\/\d+$/,F=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,E=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,T=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,D=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,O=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,$=e=>R.test(e),L=e=>!!e&&!Number.isNaN(Number(e)),I=e=>!!e&&Number.isInteger(Number(e)),_=e=>e.endsWith("%")&&L(e.slice(0,-1)),q=e=>F.test(e),V=()=>!0,B=e=>E.test(e)&&!T.test(e),U=()=>!1,W=e=>D.test(e),G=e=>O.test(e),H=e=>!Y(e)&&!et(e),K=e=>eo(e,ex,U),Y=e=>C.test(e),J=e=>eo(e,eu,B),X=e=>eo(e,eh,L),Z=e=>eo(e,ed,U),Q=e=>eo(e,em,G),ee=e=>eo(e,ef,W),et=e=>A.test(e),er=e=>ec(e,eu),es=e=>ec(e,ep),en=e=>ec(e,ed),ei=e=>ec(e,ex),ea=e=>ec(e,em),el=e=>ec(e,ef,!0),eo=(e,t,r)=>{let s=C.exec(e);return!!s&&(s[1]?t(s[1]):r(s[2]))},ec=(e,t,r=!1)=>{let s=A.exec(e);return!!s&&(s[1]?t(s[1]):r)},ed=e=>"position"===e||"percentage"===e,em=e=>"image"===e||"url"===e,ex=e=>"length"===e||"size"===e||"bg-size"===e,eu=e=>"length"===e,eh=e=>"number"===e,ep=e=>"family-name"===e,ef=e=>"shadow"===e,eg=((e,...t)=>{let r,s,n,i,a=e=>{let t=s(e);if(t)return t;let i=((e,t)=>{let{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:i}=t,a=[],l=e.trim().split(z),o="";for(let e=l.length-1;e>=0;e-=1){let t=l[e],{isExternal:c,modifiers:d,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:u}=r(t);if(c){o=t+(o.length>0?" "+o:o);continue}let h=!!u,p=s(h?x.substring(0,u):x);if(!p){if(!h||!(p=s(x))){o=t+(o.length>0?" "+o:o);continue}h=!1}let f=0===d.length?"":1===d.length?d[0]:i(d).join(":"),g=m?f+"!":f,b=g+p;if(a.indexOf(b)>-1)continue;a.push(b);let y=n(p,h);for(let e=0;e<y.length;++e){let t=y[e];a.push(g+t)}o=t+(o.length>0?" "+o:o)}return o})(e,r);return n(e,i),i};return i=l=>{var o;let c;return s=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=Object.create(null),s=Object.create(null),n=(n,i)=>{r[n]=i,++t>e&&(t=0,s=r,r=Object.create(null))};return{get(e){let t=r[e];return void 0!==t?t:void 0!==(t=s[e])?(n(e,t),t):void 0},set(e,t){e in r?r[e]=t:n(e,t)}}})((o=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,s=e=>{let t,r=[],s=0,n=0,i=0,a=e.length;for(let l=0;l<a;l++){let a=e[l];if(0===s&&0===n){if(":"===a){r.push(e.slice(i,l)),i=l+1;continue}if("/"===a){t=l;continue}}"["===a?s++:"]"===a?s--:"("===a?n++:")"===a&&n--}let l=0===r.length?e:e.slice(i),o=l,c=!1;return l.endsWith("!")?(o=l.slice(0,-1),c=!0):l.startsWith("!")&&(o=l.slice(1),c=!0),k(r,c,o,t&&t>i?t-i:void 0)};if(t){let e=t+":",r=s;s=t=>t.startsWith(e)?r(t.slice(e.length)):k(w,!1,t,void 0,!0)}if(r){let e=s;s=t=>r({className:t,parseClassName:e})}return s})(o),sortModifiers:(c=new Map,o.orderSensitiveModifiers.forEach((e,t)=>{c.set(e,1e6+t)}),e=>{let t=[],r=[];for(let s=0;s<e.length;s++){let n=e[s],i="["===n[0],a=c.has(n);i||a?(r.length>0&&(r.sort(),t.push(...r),r=[]),t.push(n)):r.push(n)}return r.length>0&&(r.sort(),t.push(...r)),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e;return p(r,t)})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]")){var r;let t,s,n;return -1===(r=e).slice(1,-1).indexOf(":")?void 0:(s=(t=r.slice(1,-1)).indexOf(":"),(n=t.slice(0,s))?"arbitrary.."+n:void 0)}let s=e.split("-"),n=+(""===s[0]&&s.length>1);return h(s,n,t)},getConflictingClassGroupIds:(e,t)=>{if(t){let t=s[e],n=r[e];if(t){if(n){let e=Array(n.length+t.length);for(let t=0;t<n.length;t++)e[t]=n[t];for(let r=0;r<t.length;r++)e[n.length+r]=t[r];return e}return t}return n||u}return r[e]||u}}})(o)}).cache.get,n=r.cache.set,i=a,a(l)},(...e)=>i(((...e)=>{let t,r,s=0,n="";for(;s<e.length;)(t=e[s++])&&(r=P(t))&&(n&&(n+=" "),n+=r);return n})(...e))})(()=>{let e=M("color"),t=M("font"),r=M("text"),s=M("font-weight"),n=M("tracking"),i=M("leading"),a=M("breakpoint"),l=M("container"),o=M("spacing"),c=M("radius"),d=M("shadow"),m=M("inset-shadow"),x=M("text-shadow"),u=M("drop-shadow"),h=M("blur"),p=M("perspective"),f=M("aspect"),g=M("ease"),b=M("animate"),y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],j=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],v=()=>[...j(),et,Y],N=()=>["auto","hidden","clip","visible","scroll"],w=()=>["auto","contain","none"],k=()=>[et,Y,o],z=()=>[$,"full","auto",...k()],P=()=>[I,"none","subgrid",et,Y],S=()=>["auto",{span:["full",I,et,Y]},I,et,Y],C=()=>[I,"auto",et,Y],A=()=>["auto","min","max","fr",et,Y],R=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],E=()=>["auto",...k()],T=()=>[$,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],D=()=>[e,et,Y],O=()=>[...j(),en,Z,{position:[et,Y]}],B=()=>["no-repeat",{repeat:["","x","y","space","round"]}],U=()=>["auto","cover","contain",ei,K,{size:[et,Y]}],W=()=>[_,er,J],G=()=>["","none","full",c,et,Y],eo=()=>["",L,er,J],ec=()=>["solid","dashed","dotted","double"],ed=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],em=()=>[L,_,en,Z],ex=()=>["","none",h,et,Y],eu=()=>["none",L,et,Y],eh=()=>["none",L,et,Y],ep=()=>[L,et,Y],ef=()=>[$,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[q],breakpoint:[q],color:[V],container:[q],"drop-shadow":[q],ease:["in","out","in-out"],font:[H],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[q],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[q],shadow:[q],spacing:["px",L],text:[q],"text-shadow":[q],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",$,Y,et,f]}],container:["container"],columns:[{columns:[L,Y,et,l]}],"break-after":[{"break-after":y()}],"break-before":[{"break-before":y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:w()}],"overscroll-x":[{"overscroll-x":w()}],"overscroll-y":[{"overscroll-y":w()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[I,"auto",et,Y]}],basis:[{basis:[$,"full","auto",l,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[L,$,"auto","initial","none",Y]}],grow:[{grow:["",L,et,Y]}],shrink:[{shrink:["",L,et,Y]}],order:[{order:[I,"first","last","none",et,Y]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:S()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:S()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":A()}],"auto-rows":[{"auto-rows":A()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...R(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...R()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":R()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:E()}],mx:[{mx:E()}],my:[{my:E()}],ms:[{ms:E()}],me:[{me:E()}],mt:[{mt:E()}],mr:[{mr:E()}],mb:[{mb:E()}],ml:[{ml:E()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:T()}],w:[{w:[l,"screen",...T()]}],"min-w":[{"min-w":[l,"screen","none",...T()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[a]},...T()]}],h:[{h:["screen","lh",...T()]}],"min-h":[{"min-h":["screen","lh","none",...T()]}],"max-h":[{"max-h":["screen","lh",...T()]}],"font-size":[{text:["base",r,er,J]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,et,X]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",_,Y]}],"font-family":[{font:[es,Y,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,et,Y]}],"line-clamp":[{"line-clamp":[L,"none",et,X]}],leading:[{leading:[i,...k()]}],"list-image":[{"list-image":["none",et,Y]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",et,Y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:D()}],"text-color":[{text:D()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ec(),"wavy"]}],"text-decoration-thickness":[{decoration:[L,"from-font","auto",et,J]}],"text-decoration-color":[{decoration:D()}],"underline-offset":[{"underline-offset":[L,"auto",et,Y]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",et,Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",et,Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:O()}],"bg-repeat":[{bg:B()}],"bg-size":[{bg:U()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},I,et,Y],radial:["",et,Y],conic:[I,et,Y]},ea,Q]}],"bg-color":[{bg:D()}],"gradient-from-pos":[{from:W()}],"gradient-via-pos":[{via:W()}],"gradient-to-pos":[{to:W()}],"gradient-from":[{from:D()}],"gradient-via":[{via:D()}],"gradient-to":[{to:D()}],rounded:[{rounded:G()}],"rounded-s":[{"rounded-s":G()}],"rounded-e":[{"rounded-e":G()}],"rounded-t":[{"rounded-t":G()}],"rounded-r":[{"rounded-r":G()}],"rounded-b":[{"rounded-b":G()}],"rounded-l":[{"rounded-l":G()}],"rounded-ss":[{"rounded-ss":G()}],"rounded-se":[{"rounded-se":G()}],"rounded-ee":[{"rounded-ee":G()}],"rounded-es":[{"rounded-es":G()}],"rounded-tl":[{"rounded-tl":G()}],"rounded-tr":[{"rounded-tr":G()}],"rounded-br":[{"rounded-br":G()}],"rounded-bl":[{"rounded-bl":G()}],"border-w":[{border:eo()}],"border-w-x":[{"border-x":eo()}],"border-w-y":[{"border-y":eo()}],"border-w-s":[{"border-s":eo()}],"border-w-e":[{"border-e":eo()}],"border-w-t":[{"border-t":eo()}],"border-w-r":[{"border-r":eo()}],"border-w-b":[{"border-b":eo()}],"border-w-l":[{"border-l":eo()}],"divide-x":[{"divide-x":eo()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":eo()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ec(),"hidden","none"]}],"divide-style":[{divide:[...ec(),"hidden","none"]}],"border-color":[{border:D()}],"border-color-x":[{"border-x":D()}],"border-color-y":[{"border-y":D()}],"border-color-s":[{"border-s":D()}],"border-color-e":[{"border-e":D()}],"border-color-t":[{"border-t":D()}],"border-color-r":[{"border-r":D()}],"border-color-b":[{"border-b":D()}],"border-color-l":[{"border-l":D()}],"divide-color":[{divide:D()}],"outline-style":[{outline:[...ec(),"none","hidden"]}],"outline-offset":[{"outline-offset":[L,et,Y]}],"outline-w":[{outline:["",L,er,J]}],"outline-color":[{outline:D()}],shadow:[{shadow:["","none",d,el,ee]}],"shadow-color":[{shadow:D()}],"inset-shadow":[{"inset-shadow":["none",m,el,ee]}],"inset-shadow-color":[{"inset-shadow":D()}],"ring-w":[{ring:eo()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:D()}],"ring-offset-w":[{"ring-offset":[L,J]}],"ring-offset-color":[{"ring-offset":D()}],"inset-ring-w":[{"inset-ring":eo()}],"inset-ring-color":[{"inset-ring":D()}],"text-shadow":[{"text-shadow":["none",x,el,ee]}],"text-shadow-color":[{"text-shadow":D()}],opacity:[{opacity:[L,et,Y]}],"mix-blend":[{"mix-blend":[...ed(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ed()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[L]}],"mask-image-linear-from-pos":[{"mask-linear-from":em()}],"mask-image-linear-to-pos":[{"mask-linear-to":em()}],"mask-image-linear-from-color":[{"mask-linear-from":D()}],"mask-image-linear-to-color":[{"mask-linear-to":D()}],"mask-image-t-from-pos":[{"mask-t-from":em()}],"mask-image-t-to-pos":[{"mask-t-to":em()}],"mask-image-t-from-color":[{"mask-t-from":D()}],"mask-image-t-to-color":[{"mask-t-to":D()}],"mask-image-r-from-pos":[{"mask-r-from":em()}],"mask-image-r-to-pos":[{"mask-r-to":em()}],"mask-image-r-from-color":[{"mask-r-from":D()}],"mask-image-r-to-color":[{"mask-r-to":D()}],"mask-image-b-from-pos":[{"mask-b-from":em()}],"mask-image-b-to-pos":[{"mask-b-to":em()}],"mask-image-b-from-color":[{"mask-b-from":D()}],"mask-image-b-to-color":[{"mask-b-to":D()}],"mask-image-l-from-pos":[{"mask-l-from":em()}],"mask-image-l-to-pos":[{"mask-l-to":em()}],"mask-image-l-from-color":[{"mask-l-from":D()}],"mask-image-l-to-color":[{"mask-l-to":D()}],"mask-image-x-from-pos":[{"mask-x-from":em()}],"mask-image-x-to-pos":[{"mask-x-to":em()}],"mask-image-x-from-color":[{"mask-x-from":D()}],"mask-image-x-to-color":[{"mask-x-to":D()}],"mask-image-y-from-pos":[{"mask-y-from":em()}],"mask-image-y-to-pos":[{"mask-y-to":em()}],"mask-image-y-from-color":[{"mask-y-from":D()}],"mask-image-y-to-color":[{"mask-y-to":D()}],"mask-image-radial":[{"mask-radial":[et,Y]}],"mask-image-radial-from-pos":[{"mask-radial-from":em()}],"mask-image-radial-to-pos":[{"mask-radial-to":em()}],"mask-image-radial-from-color":[{"mask-radial-from":D()}],"mask-image-radial-to-color":[{"mask-radial-to":D()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":j()}],"mask-image-conic-pos":[{"mask-conic":[L]}],"mask-image-conic-from-pos":[{"mask-conic-from":em()}],"mask-image-conic-to-pos":[{"mask-conic-to":em()}],"mask-image-conic-from-color":[{"mask-conic-from":D()}],"mask-image-conic-to-color":[{"mask-conic-to":D()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:O()}],"mask-repeat":[{mask:B()}],"mask-size":[{mask:U()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",et,Y]}],filter:[{filter:["","none",et,Y]}],blur:[{blur:ex()}],brightness:[{brightness:[L,et,Y]}],contrast:[{contrast:[L,et,Y]}],"drop-shadow":[{"drop-shadow":["","none",u,el,ee]}],"drop-shadow-color":[{"drop-shadow":D()}],grayscale:[{grayscale:["",L,et,Y]}],"hue-rotate":[{"hue-rotate":[L,et,Y]}],invert:[{invert:["",L,et,Y]}],saturate:[{saturate:[L,et,Y]}],sepia:[{sepia:["",L,et,Y]}],"backdrop-filter":[{"backdrop-filter":["","none",et,Y]}],"backdrop-blur":[{"backdrop-blur":ex()}],"backdrop-brightness":[{"backdrop-brightness":[L,et,Y]}],"backdrop-contrast":[{"backdrop-contrast":[L,et,Y]}],"backdrop-grayscale":[{"backdrop-grayscale":["",L,et,Y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[L,et,Y]}],"backdrop-invert":[{"backdrop-invert":["",L,et,Y]}],"backdrop-opacity":[{"backdrop-opacity":[L,et,Y]}],"backdrop-saturate":[{"backdrop-saturate":[L,et,Y]}],"backdrop-sepia":[{"backdrop-sepia":["",L,et,Y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",et,Y]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[L,"initial",et,Y]}],ease:[{ease:["linear","initial",g,et,Y]}],delay:[{delay:[L,et,Y]}],animate:[{animate:["none",b,et,Y]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,et,Y]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:eu()}],"rotate-x":[{"rotate-x":eu()}],"rotate-y":[{"rotate-y":eu()}],"rotate-z":[{"rotate-z":eu()}],scale:[{scale:eh()}],"scale-x":[{"scale-x":eh()}],"scale-y":[{"scale-y":eh()}],"scale-z":[{"scale-z":eh()}],"scale-3d":["scale-3d"],skew:[{skew:ep()}],"skew-x":[{"skew-x":ep()}],"skew-y":[{"skew-y":ep()}],transform:[{transform:[et,Y,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ef()}],"translate-x":[{"translate-x":ef()}],"translate-y":[{"translate-y":ef()}],"translate-z":[{"translate-z":ef()}],"translate-none":["translate-none"],accent:[{accent:D()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:D()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",et,Y]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",et,Y]}],fill:[{fill:["none",...D()]}],"stroke-w":[{stroke:[L,er,J,X]}],stroke:[{stroke:["none",...D()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function eb(...e){return eg(m(e))}function ey(e,t=2){return null==e||isNaN(e)?"-":e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:t})}var ej=e.i(91568);let ev=(0,ej.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),eN=(0,ej.default)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),ew=(0,ej.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ek=(0,ej.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),ez=(0,ej.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),eP=(0,ej.default)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),eS=[{label:"總覽儀表板",href:"/",icon:ev},{label:"地圖模式",href:"/map",icon:eN},{label:"分析報告",href:"/reports",icon:ek},{label:"開發者日誌",href:"https://medium.com/@sqmtalk7",icon:(0,ej.default)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),isExternal:!0},{label:"Threads",href:"https://www.threads.net/@sqm.talk",icon:(0,ej.default)("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),isExternal:!0}];function eM(){let e=(0,d.usePathname)();return(0,l.jsxs)("aside",{className:"hidden h-screen w-64 flex-col border-r border-white/5 bg-zinc-950 lg:flex fixed left-0 top-0 z-50",children:[(0,l.jsx)("div",{className:"flex h-16 items-center border-b border-white/5 px-6",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 font-bold text-xl tracking-tight text-white",children:[(0,l.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-violet-600 text-white shadow-lg shadow-violet-500/30",children:(0,l.jsx)(eP,{className:"h-5 w-5"})}),(0,l.jsx)("span",{children:"平米內參"})]})}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto py-6 px-3",children:[(0,l.jsx)("nav",{className:"flex flex-col gap-1 space-y-1",children:eS.map(t=>{let r=e===t.href,s=t.isExternal;return(0,l.jsxs)(c.default,{href:t.href,target:s?"_blank":void 0,rel:s?"noopener noreferrer":void 0,className:eb("flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition-all duration-200",r?"bg-violet-500/10 text-violet-400 font-semibold":"text-zinc-400 hover:bg-zinc-900 hover:text-zinc-100"),children:[(0,l.jsx)(t.icon,{className:eb("h-4 w-4",r?"text-violet-400":"text-zinc-500")}),t.label]},t.href)})}),(0,l.jsx)("div",{className:"my-6 border-t border-white/5 mx-3"}),(0,l.jsx)("nav",{className:"flex flex-col gap-1 space-y-1",children:(0,l.jsxs)(c.default,{href:"/settings",className:"flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium text-zinc-400 hover:bg-zinc-900 hover:text-zinc-100 transition-colors",children:[(0,l.jsx)(ew,{className:"h-4 w-4 text-zinc-500"}),"系統設定"]})})]}),(0,l.jsx)("div",{className:"border-t border-white/5 p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-lg bg-zinc-900/50 p-3 hover:bg-zinc-900 transition-colors cursor-pointer border border-transparent hover:border-white/5",children:[(0,l.jsx)("div",{className:"h-9 w-9 rounded-full bg-gradient-to-br from-violet-500 to-indigo-600 flex items-center justify-center text-xs font-bold text-white ring-2 ring-zinc-950",children:"KT"}),(0,l.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,l.jsx)("p",{className:"truncate text-sm font-medium text-zinc-200",children:"KT Pro"}),(0,l.jsx)("p",{className:"truncate text-xs text-zinc-500",children:"ktpro@vibe.co"})]}),(0,l.jsx)(ez,{className:"h-4 w-4 text-zinc-500 hover:text-white transition-colors"})]})})]})}let eC=(0,ej.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),eA=(0,ej.default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),eR=(0,ej.default)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);function eF(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function eE(...e){return t=>{let r=!1,s=e.map(e=>{let s=eF(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():eF(e[t],null)}}}}function eT(...e){return o.useCallback(eE(...e),e)}var eD=Symbol.for("react.lazy"),eO=o[" use ".trim().toString()];function e$(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===eD&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var eL=((a=o.forwardRef((e,t)=>{let{children:r,...s}=e;if(e$(r)&&"function"==typeof eO&&(r=eO(r._payload)),o.isValidElement(r)){var n;let e,i,a=(n=r,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),l=function(e,t){let r={...t};for(let s in t){let n=e[s],i=t[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...e)=>{let t=i(...e);return n(...e),t}:n&&(r[s]=n):"style"===s?r[s]={...n,...i}:"className"===s&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==o.Fragment&&(l.ref=t?eE(t,a):a),o.cloneElement(r,l)}return o.Children.count(r)>1?o.Children.only(null):null})).displayName="Slot.SlotClone",t=a,(r=o.forwardRef((e,r)=>{let{children:s,...n}=e;e$(s)&&"function"==typeof eO&&(s=eO(s._payload));let i=o.Children.toArray(s),a=i.find(e_);if(a){let e=a.props.children,s=i.map(t=>t!==a?t:o.Children.count(e)>1?o.Children.only(null):o.isValidElement(e)?e.props.children:null);return(0,l.jsx)(t,{...n,ref:r,children:o.isValidElement(e)?o.cloneElement(e,void 0,s):null})}return(0,l.jsx)(t,{...n,ref:r,children:s})})).displayName="Slot.Slot",r),eI=Symbol("radix.slottable");function e_(e){return o.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===eI}let eq=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,eV=(s="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",n={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-lg shadow-violet-500/20",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-zinc-900/50 hover:bg-zinc-800 hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",glass:"bg-white/5 backdrop-blur-sm border border-white/10 hover:bg-white/10 text-zinc-100"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}},e=>{var t;if((null==n?void 0:n.variants)==null)return m(s,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:r,defaultVariants:i}=n,a=Object.keys(r).map(t=>{let s=null==e?void 0:e[t],n=null==i?void 0:i[t];if(null===s)return null;let a=eq(s)||eq(n);return r[t][a]}),l=e&&Object.entries(e).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return m(s,a,null==n||null==(t=n.compoundVariants)?void 0:t.reduce((e,t)=>{let{class:r,className:s,...n}=t;return Object.entries(n).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...l}[t]):({...i,...l})[t]===r})?[...e,r,s]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)}),eB=o.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...n},i)=>(0,l.jsx)(s?eL:"button",{className:eb(eV({variant:t,size:r,className:e})),ref:i,...n}));eB.displayName="Button";let eU=o.forwardRef(({className:e,type:t,...r},s)=>(0,l.jsx)("input",{type:t,className:eb("flex h-10 w-full rounded-md border border-input bg-zinc-950/50 px-3 py-2 text-sm text-zinc-100 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));function eW(){let[e,t]=o.default.useState(!1);return(0,l.jsxs)("header",{className:"sticky top-0 z-40 flex h-16 w-full items-center border-b border-white/5 bg-zinc-950/80 backdrop-blur-md px-6 shadow-sm",children:[(0,l.jsx)("div",{className:"flex items-center gap-4 lg:hidden",children:(0,l.jsx)(eB,{variant:"ghost",size:"icon",className:"-ml-2",onClick:()=>t(!e),children:(0,l.jsx)(eR,{className:"h-5 w-5"})})}),(0,l.jsxs)("div",{className:"flex flex-1 items-center justify-between gap-4",children:[(0,l.jsx)("div",{className:"hidden lg:flex max-w-sm flex-1 items-center gap-2",children:(0,l.jsxs)("div",{className:"relative w-full",children:[(0,l.jsx)(eC,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-zinc-500"}),(0,l.jsx)(eU,{placeholder:"全站搜尋...",className:"w-full bg-zinc-900/50 pl-9 border-zinc-800 focus:border-violet-500/50"})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.default,{href:"/login",className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 px-3 text-zinc-400 hover:text-white",children:"Login"}),(0,l.jsx)(c.default,{href:"/admin/uploader",className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 px-3 text-zinc-400 hover:text-white",children:"Uploader"}),(0,l.jsx)("div",{className:"h-4 w-[1px] bg-zinc-800 mx-2"}),(0,l.jsxs)(eB,{variant:"ghost",size:"icon",className:"relative text-zinc-400 hover:text-white hover:bg-zinc-800",children:[(0,l.jsx)(eA,{className:"h-5 w-5"}),(0,l.jsx)("span",{className:"absolute top-2 right-2 h-2 w-2 rounded-full bg-violet-500 ring-2 ring-zinc-950 block"})]})]})]}),e&&(0,l.jsx)("div",{className:"absolute top-16 left-0 w-full bg-zinc-950 border-b border-zinc-800 p-4 shadow-xl lg:hidden animate-in slide-in-from-top-2",children:(0,l.jsx)("nav",{className:"flex flex-col gap-2",children:eS.map(e=>{let r=e.isExternal;return(0,l.jsxs)(c.default,{href:e.href,target:r?"_blank":void 0,rel:r?"noopener noreferrer":void 0,onClick:()=>t(!1),className:"flex items-center gap-3 rounded-md px-3 py-3 text-sm font-medium text-zinc-400 hover:bg-zinc-900 hover:text-zinc-100 transition-colors",children:[(0,l.jsx)(e.icon,{className:"h-5 w-5 text-zinc-500"}),e.label]},e.href)})})})]})}function eG({children:e}){return(0,l.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100 flex",children:[(0,l.jsx)(eM,{}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-64 min-w-0 transition-all duration-300",children:[(0,l.jsx)(eW,{}),(0,l.jsx)("main",{className:"flex-1 p-4 md:p-6 lg:p-8 overflow-y-auto",children:(0,l.jsx)("div",{className:"container-custom py-6 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:e})})]})]})}eU.displayName="Input";let eH=e=>{let t,r=new Set,s=(e,s)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=s?s:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,i={setState:s,getState:n,getInitialState:()=>a,subscribe:e=>(r.add(e),()=>r.delete(e))},a=t=e(s,n,i);return i},eK=e=>{let t=e?eH(e):eH,r=e=>(function(e,t=e=>e){let r=o.default.useSyncExternalStore(e.subscribe,o.default.useCallback(()=>t(e.getState()),[e,t]),o.default.useCallback(()=>t(e.getInitialState()),[e,t]));return o.default.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},eY={counties:[],districts:[],transactionType:"預售交易",buildingType:"",projectNames:[],dateRange:"1y",startDate:"",endDate:"",excludeCommercial:!1,floorPremium:.3,rankingCurrentPage:1,rankingPageSize:10,currentSort:{key:"saleAmountSum",order:"desc"},currentAverageType:"arithmetic",velocityView:"monthly",velocityMetric:"count"},eJ=(i=e=>({...eY,setCounties:t=>e({counties:t,districts:[]}),setDistricts:t=>e({districts:t}),setTransactionType:t=>e({transactionType:t}),setBuildingType:t=>e({buildingType:t}),setProjectNames:t=>e({projectNames:t}),setDateRange:(t,r,s)=>e(e=>({dateRange:t,startDate:r||e.startDate,endDate:s||e.endDate})),setCustomDate:(t,r)=>e({startDate:t,endDate:r,dateRange:"custom"}),setExcludeCommercial:t=>e({excludeCommercial:t}),setFloorPremium:t=>e({floorPremium:t}),setRankingCurrentPage:t=>e({rankingCurrentPage:t}),setRankingPageSize:t=>e({rankingPageSize:t}),setCurrentSort:t=>e({currentSort:t}),setCurrentAverageType:t=>e({currentAverageType:t}),setVelocityView:t=>e({velocityView:t}),setVelocityMetric:t=>e({velocityMetric:t}),resetFilters:()=>e(eY)}))?eK(i):eK,eX=(0,ej.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),eZ=(0,ej.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),eQ=(0,o.forwardRef)(({options:e,value:t,onChange:r,placeholder:s="Select...",maxItems:n,disabled:i=!1,className:a,onSearch:c,loading:d=!1},m)=>{let[x,u]=(0,o.useState)(""),[h,p]=(0,o.useState)(!1),f=(0,o.useRef)(null),g=(0,o.useRef)(null),b=c?e:e.filter(e=>e.label.toLowerCase().includes(x.toLowerCase()));return t.map(t=>{let r=e.find(e=>e.value===t);return r?r.label:t}),(0,o.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,o.useEffect)(()=>{c&&c(x)},[x,c]),(0,l.jsxs)("div",{className:eb("relative w-full",a),ref:f,children:[(0,l.jsxs)("div",{className:eb("flex items-center gap-2 bg-zinc-950/50 border border-input rounded-md px-2 py-1.5 h-[42px] overflow-x-auto custom-scrollbar cursor-text transition-all",h&&"ring-2 ring-ring ring-offset-0 border-ring",i&&"bg-zinc-900/50 cursor-not-allowed opacity-50"),onClick:()=>!i&&g.current?.focus(),children:[t.map(s=>{let n=e.find(e=>e.value===s),a=n?n.label:s;return(0,l.jsxs)("span",{className:"bg-violet-500/20 text-violet-200 border border-violet-500/30 text-xs rounded-full px-2 py-0.5 flex items-center gap-1 animate-in fade-in zoom-in-95 duration-100 whitespace-nowrap shrink-0",children:[a,!i&&(0,l.jsx)(eX,{size:12,className:"cursor-pointer hover:text-white transition-colors",onClick:e=>{e.stopPropagation(),r(t.filter(e=>e!==s))}})]},s)}),(0,l.jsx)("input",{ref:g,type:"text",value:x,onChange:e=>u(e.target.value),onFocus:()=>p(!0),onKeyDown:e=>{"Backspace"===e.key&&""===x&&t.length>0&&r(t.slice(0,-1))},placeholder:0===t.length?s:"",className:eb("bg-transparent outline-none flex-grow min-w-[60px] text-zinc-100 placeholder:text-zinc-500 text-sm",i&&"cursor-not-allowed"),disabled:i})]}),h&&!i&&(0,l.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-zinc-900 border border-zinc-700 rounded-md shadow-xl max-h-60 overflow-y-auto custom-scrollbar animate-in fade-in slide-in-from-top-2 duration-100",children:d?(0,l.jsx)("div",{className:"p-2 text-center text-zinc-500 text-sm",children:"Loading..."}):0===b.length?(0,l.jsx)("div",{className:"p-2 text-center text-zinc-500 text-sm",children:"No options found"}):b.map((e,s)=>{let i=0===s||e.group!==b[s-1].group;return(0,l.jsxs)(o.default.Fragment,{children:[i&&e.group&&(0,l.jsx)("div",{className:"px-2 py-1 bg-zinc-800/50 text-xs font-semibold text-zinc-400 sticky top-0 backdrop-blur-sm z-10",children:e.group}),(0,l.jsxs)("div",{className:eb("px-3 py-2 cursor-pointer text-sm flex items-start justify-between hover:bg-zinc-800 transition-colors",t.includes(e.value)&&"bg-violet-500/10 text-violet-400"),onClick:()=>(e=>{if(t.includes(e))r(t.filter(t=>t!==e));else{if(n&&t.length>=n)return;r([...t,e])}u("")})(e.value),children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"font-medium",children:e.label}),e.details&&(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(e.details.county||e.details.district)&&(0,l.jsxs)("span",{className:"text-xs text-zinc-500 bg-zinc-800/80 px-1.5 rounded border border-zinc-700",children:[e.details.county,e.details.district]}),e.details.date&&(0,l.jsx)("span",{className:"text-xs text-zinc-600 font-mono",children:e.details.date.substring(0,7)})]})]}),t.includes(e.value)&&(0,l.jsx)(eZ,{size:16,className:"mt-1"})]})]},e.value)})})]})});eQ.displayName="MultiSelect";let e0=(0,ej.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),e1=o.forwardRef(({className:e,children:t,...r},s)=>(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("select",{className:eb("flex h-10 w-full appearance-none rounded-md border border-input bg-zinc-950/50 px-3 py-2 text-sm text-zinc-100 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 pr-8",e),ref:s,...r,children:t}),(0,l.jsx)(e0,{className:"absolute right-3 top-2.5 h-4 w-4 opacity-50 pointer-events-none"})]}));e1.displayName="Select";let e2=(0,ej.default)("chart-line",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),e4=(0,ej.default)("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),e5=(0,ej.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.i(20585);let e3="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp4Ym1iYmZyemJ0dXVleXNpY29jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA2ODg5ODksImV4cCI6MjA2NjI2NDk4OX0.1IUynv5eK1xF_3pb-oasqaTrPvbeAOC4Sc1oykPBy4M",e6="https://zxbmbbfrzbtuueysicoc.supabase.co/functions/v1",e9={QUERY_DATA:`${e6}/query-data`,SUB_DATA:`${e6}/query-sub-data`,PROJECT_NAMES:`${e6}/query-names`,RANKING_ANALYSIS:`${e6}/analyze-project-ranking`,GENERATE_SHARE_LINK:`${e6}/generate-share-link`},e8={臺北市:["中正區","大同區","中山區","松山區","大安區","萬華區","信義區","士林區","北投區","內湖區","南港區","文山區"],新北市:["板橋區","三重區","中和區","永和區","新莊區","新店區","樹林區","鶯歌區","三峽區","淡水區","汐止區","瑞芳區","土城區","蘆洲區","五股區","泰山區","林口區","深坑區","石碇區","坪林區","三芝區","石門區","八里區","平溪區","雙溪區","貢寮區","金山區","萬里區","烏來區"],桃園市:["桃園區","中壢區","大溪區","楊梅區","蘆竹區","大園區","龜山區","八德區","龍潭區","平鎮區","新屋區","觀音區","復興區"],臺中市:["中區","東區","南區","西區","北區","北屯區","西屯區","南屯區","太平區","大里區","霧峰區","烏日區","豐原區","后里區","石岡區","東勢區","和平區","新社區","潭子區","大雅區","神岡區","大肚區","沙鹿區","龍井區","梧棲區","清水區","大甲區","外埔區","大安區"],臺南市:["中西區","東區","南區","北區","安平區","安南區","永康區","歸仁區","新化區","左鎮區","玉井區","楠西區","南化區","仁德區","關廟區","龍崎區","官田區","麻豆區","佳里區","西港區","七股區","將軍區","學甲區","北門區","新營區","後壁區","白河區","東山區","六甲區","下營區","柳營區","鹽水區","善化區","大內區","山上區","新市區","安定區"],高雄市:["新興區","前金區","苓雅區","鹽埕區","鼓山區","旗津區","前鎮區","三民區","楠梓區","小港區","左營區","仁武區","大社區","岡山區","路竹區","阿蓮區","田寮區","燕巢區","橋頭區","梓官區","彌陀區","永安區","湖內區","鳳山區","大寮區","林園區","鳥松區","大樹區","旗山區","美濃區","六龜區","內門區","杉林區","甲仙區","桃源區","那瑪夏區","茂林區","茄萣區"],基隆市:["仁愛區","信義區","中正區","中山區","安樂區","暖暖區","七堵區"],新竹市:["東區","北區","香山區"],嘉義市:["東區","西區"],宜蘭縣:["宜蘭市","羅東鎮","蘇澳鎮","頭城鎮","礁溪鄉","壯圍鄉","員山鄉","冬山鄉","五結鄉","三星鄉","大同鄉","南澳鄉"],新竹縣:["竹北市","竹東鎮","新埔鎮","關西鎮","湖口鄉","新豐鄉","芎林鄉","橫山鄉","北埔鄉","寶山鄉","峨眉鄉","尖石鄉","五峰鄉"],苗栗縣:["苗栗市","苑裡鎮","通霄鎮","竹南鎮","頭份鎮","後龍鎮","卓蘭鎮","大湖鄉","公館鄉","銅鑼鄉","南庄鄉","頭屋鄉","三義鄉","西湖鄉","造橋鄉","三灣鄉","獅潭鄉","泰安鄉"],彰化縣:["彰化市","鹿港鎮","和美鎮","線西鄉","伸港鄉","福興鄉","秀水鄉","花壇鄉","芬園鄉","員林鎮","溪湖鎮","田中鎮","大村鄉","埔鹽鄉","埔心鄉","永靖鄉","社頭鄉","二水鄉","北斗鎮","二林鎮","田尾鄉","埤頭鄉","芳苑鄉","大城鄉","竹塘鄉","溪州鄉"],南投縣:["南投市","埔里鎮","草屯鎮","竹山鎮","集集鎮","名間鄉","鹿谷鄉","中寮鄉","魚池鄉","國姓鄉","水里鄉","信義鄉","仁愛鄉"],雲林縣:["斗六市","斗南鎮","虎尾鎮","西螺鎮","土庫鎮","北港鎮","古坑鄉","大埤鄉","莿桐鄉","林內鄉","二崙鄉","崙背鄉","麥寮鄉","東勢鄉","褒忠鄉","台西鄉","元長鄉","四湖鄉","口湖鄉","水林鄉"],嘉義縣:["太保市","朴子市","布袋鎮","大林鎮","民雄鄉","溪口鄉","新港鄉","六腳鄉","東石鄉","義竹鄉","鹿草鄉","水上鄉","中埔鄉","竹崎鄉","梅山鄉","番路鄉","大埔鄉","阿里山鄉"],屏東縣:["屏東市","潮州鎮","東港鎮","恆春鎮","萬丹鄉","長治鄉","麟洛鄉","九如鄉","里港鄉","鹽埔鄉","高樹鄉","萬巒鄉","內埔鄉","竹田鄉","新埤鄉","枋寮鄉","新園鄉","崁頂鄉","林邊鄉","南州鄉","佳冬鄉","琉球鄉","車城鄉","滿州鄉","枋山鄉","霧台鄉","瑪家鄉","泰武鄉","來義鄉","春日鄉","獅子鄉","牡丹鄉","三地門鄉"],花蓮縣:["花蓮市","鳳林鎮","玉里鎮","新城鄉","吉安鄉","壽豐鄉","光復鄉","豐濱鄉","瑞穗鄉","富里鄉","秀林鄉","萬榮鄉","卓溪鄉"],臺東縣:["臺東市","成功鎮","關山鎮","卑南鄉","鹿野鄉","池上鄉","東河鄉","長濱鄉","太麻里鄉","大武鄉","綠島鄉","海端鄉","延平鄉","金峰鄉","達仁鄉","蘭嶼鄉"],澎湖縣:["馬公市","湖西鄉","白沙鄉","西嶼鄉","望安鄉","七美鄉"],金門縣:["金城鎮","金湖鎮","金沙鄉","金寧鄉","烈嶼鄉","烏坵鄉"],連江縣:["南竿鄉","北竿鄉","莒光鄉","東引鄉"]},e7={臺北市:"A",新北市:"F",桃園市:"H",臺中市:"B",臺南市:"D",高雄市:"E",基隆市:"C",新竹市:"O",嘉義市:"I",新竹縣:"J",苗栗縣:"K",彰化縣:"N",南投縣:"M",雲林縣:"P",嘉義縣:"Q",屏東縣:"T",宜蘭縣:"G",花蓮縣:"U",臺東縣:"V",澎湖縣:"X",金門縣:"W",連江縣:"Z"};var te=e.i(41097);async function tt(){let{data:{session:e}}=await te.supabase.auth.getSession();return{"Content-Type":"application/json",apikey:e3,Authorization:`Bearer ${e?.access_token||e3}`}}async function tr(e){let t=await tt(),r=await fetch(e9.RANKING_ANALYSIS,{method:"POST",headers:t,body:JSON.stringify({filters:e})});if(!r.ok)throw Error((await r.json().catch(()=>({error:`Analysis request failed: ${r.status}`}))).error||"Analyze data failed");return r.json()}let ts=async function(e,t,r=[]){let s=await tt(),n=await fetch(e9.PROJECT_NAMES,{method:"POST",headers:s,body:JSON.stringify({countyCode:e,query:t,districts:r,detailed:!0})});if(!n.ok)throw Error(`Server error: ${n.status}`);return n.json()},tn=e=>{let t=new Date,r=new Date;switch(e){case"1q":r.setMonth(t.getMonth()-3);break;case"2q":r.setMonth(t.getMonth()-6);break;case"3q":r.setMonth(t.getMonth()-9);break;case"1y":r.setFullYear(t.getFullYear()-1);break;case"this_year":r=new Date(t.getFullYear(),0,1);break;case"last_2_years":r=new Date(t.getFullYear()-1,0,1);break;case"last_3_years":r=new Date(t.getFullYear()-2,0,1);break;default:return{startDate:"",endDate:""}}return{startDate:r.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0]}};function ti({onAnalyze:e,isLoading:t}){let{counties:r,districts:s,transactionType:n,buildingType:i,projectNames:a,dateRange:c,startDate:d,endDate:m,excludeCommercial:x,setCounties:u,setDistricts:h,setTransactionType:p,setBuildingType:f,setProjectNames:g,setDateRange:b,setCustomDate:y,setExcludeCommercial:j,resetFilters:v}=eJ(),[N,w]=(0,o.useState)(!1),[k,z]=(0,o.useState)([]),[P,S]=(0,o.useState)(!1),M=Object.keys(e7).map(e=>({label:e,value:e})),C=o.default.useMemo(()=>0===r.length?[]:r.flatMap(e=>(e8[e]||[]).map(t=>({label:t,value:t,group:e}))),[r]),A=(0,o.useRef)(null),[R,F]=(0,o.useState)(null),E=(0,o.useCallback)(async e=>{if(!e||e.length<1||0===r.length)return void z([]);S(!0),F(null);try{let t=r.map(async t=>{let r=e7[t],n=s.filter(e=>e8[t]?.includes(e));return ts(r,e,n).then(e=>{let r=[];return Array.isArray(e)?r=e:e&&e.data&&Array.isArray(e.data)?r=e.data:e&&e.names&&Array.isArray(e.names)&&(r=e.names),r.map(e=>{let r="string"==typeof e,s=r?e:e.name||e.建案名稱||String(e);return{label:s,value:s,group:t,details:r?void 0:{county:t,district:e.district||e.行政區,date:e.earliestDate||e.交易日}}})}).catch(e=>(console.error(`Failed to fetch projects for ${t}:`,e),[]))}),n=(await Promise.all(t)).flat(),i=Array.from(new Map(n.map(e=>[e.value,e])).values());z(i),0===i.length&&e.length>=2&&console.log(`No projects found for query "${e}" in counties: ${r.join(", ")}`)}catch(e){console.error("Project search error:",e),F("搜尋失敗，請稍後再試")}finally{S(!1)}},[r,s]),T=(0,o.useCallback)(e=>{A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{E(e)},300)},[E]);return(0,o.useEffect)(()=>()=>{A.current&&clearTimeout(A.current)},[]),(0,l.jsxs)("div",{className:"p-4 md:p-6 glass-card rounded-xl shadow-lg animate-in fade-in slide-in-from-top-4 duration-500",children:[(0,l.jsxs)("div",{className:"flex md:hidden items-center justify-between mb-4",children:[(0,l.jsxs)("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,l.jsx)(e5,{className:"h-5 w-5 text-violet-500"}),"篩選條件"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(eB,{variant:"outline",size:"sm",onClick:()=>w(!N),className:"border-zinc-700 text-zinc-300",children:[N?(0,l.jsx)(eX,{className:"h-4 w-4"}):(0,l.jsx)(e5,{className:"h-4 w-4"}),N?"收起":"展開"]}),(0,l.jsx)(eB,{variant:"default",size:"sm",className:"bg-violet-600 text-white",disabled:0===r.length||t,onClick:e,children:t?"...":"分析"})]})]}),(0,l.jsxs)("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-4 items-end ${N?"block":"hidden md:grid"}`,children:[(0,l.jsxs)("div",{className:"xl:col-span-1",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium text-zinc-300",children:"縣市"}),r.length>3&&(0,l.jsxs)("span",{className:"text-xs text-amber-500 font-normal animate-in fade-in",children:["(已選 ",r.length,"/6)"]})]}),r.length>0&&(0,l.jsx)("button",{onClick:()=>u([]),className:"text-xs text-cyan-400 hover:text-cyan-300",children:"清除"})]}),(0,l.jsx)(eQ,{options:M,value:r,onChange:e=>{e.length>6||u(e)},placeholder:"請選擇縣市...",maxItems:6})]}),(0,l.jsxs)("div",{className:"xl:col-span-1",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium text-zinc-300",children:"行政區"}),s.length>0&&(0,l.jsx)("button",{onClick:()=>h([]),className:"text-xs text-cyan-400 hover:text-cyan-300",children:"清除"})]}),(0,l.jsx)(eQ,{options:C,value:s,onChange:e=>{h(e)},placeholder:r.length>0?"請選擇行政區...":"請先選縣市",disabled:0===r.length})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"交易類型"}),(0,l.jsxs)(e1,{value:n,onChange:e=>p(e.target.value),children:[(0,l.jsx)("option",{value:"預售交易",children:"預售交易"}),(0,l.jsx)("option",{value:"中古交易",disabled:!0,children:"中古交易 (開發中)"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"建物型態"}),(0,l.jsxs)(e1,{value:i,onChange:e=>f(e.target.value),children:[(0,l.jsx)("option",{value:"",children:"全部"}),(0,l.jsx)("option",{value:"住宅大樓(11層含以上有電梯)",children:"住宅大樓"}),(0,l.jsx)("option",{value:"華廈(10層含以下有電梯)",children:"華廈"}),(0,l.jsx)("option",{value:"公寓(5層含以下無電梯)",children:"公寓"}),(0,l.jsx)("option",{value:"套房(1房(1廳)1衛)",children:"套房"}),(0,l.jsx)("option",{value:"透天厝",children:"透天厝"}),(0,l.jsx)("option",{value:"店面(店鋪)",children:"店面"}),(0,l.jsx)("option",{value:"辦公商業大樓",children:"辦公商業大樓"}),(0,l.jsx)("option",{value:"工廠",children:"工廠/廠辦"}),(0,l.jsx)("option",{value:"其他",children:"其他"})]})]}),(0,l.jsxs)("div",{className:"xl:col-span-3",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium text-zinc-300",children:"建案名稱"}),a.length>0&&(0,l.jsx)("button",{onClick:()=>g([]),className:"text-xs text-cyan-400 hover:text-cyan-300",children:"清除"})]}),(0,l.jsx)(eQ,{options:k,value:a,onChange:g,placeholder:r.length>0?"輸入建案名稱搜尋...":"請先選縣市",disabled:0===r.length,onSearch:T,loading:P}),R&&(0,l.jsx)("span",{className:"text-xs text-red-400 mt-1",children:R})]}),(0,l.jsxs)("div",{className:"xl:col-span-3 sm:col-span-2 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"快捷時間"}),(0,l.jsxs)(e1,{value:c,onChange:e=>{let t=e.target.value;if("custom"===t)b("custom",d,m);else{let{startDate:e,endDate:r}=tn(t);e&&r&&b(t,e,r)}},children:[(0,l.jsx)("option",{value:"custom",children:"自訂範圍"}),(0,l.jsx)("option",{value:"1q",children:"近一季 (3個月)"}),(0,l.jsx)("option",{value:"2q",children:"近兩季 (6個月)"}),(0,l.jsx)("option",{value:"3q",children:"近三季 (9個月)"}),(0,l.jsx)("option",{value:"1y",children:"近一年 (12個月)"}),(0,l.jsx)("option",{value:"this_year",children:"今年以來"}),(0,l.jsx)("option",{value:"last_2_years",children:"去年＋今年"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"起始日期"}),(0,l.jsx)(eU,{type:"date",value:d,onChange:e=>y(e.target.value,m),className:"bg-zinc-950/50 border-input text-zinc-100"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-zinc-300",children:"結束日期"}),(0,l.jsx)("button",{onClick:()=>{y(d,new Date().toISOString().split("T")[0])},className:"text-xs text-cyan-400 hover:text-cyan-300",children:"抓取今日"})]}),(0,l.jsx)(eU,{type:"date",value:m,onChange:e=>y(d,e.target.value),className:"bg-zinc-950/50 border-input text-zinc-100"})]})]}),(0,l.jsxs)("div",{className:"xl:col-span-4 sm:col-span-2 flex items-end gap-4 justify-end mt-4 md:mt-0",children:[(0,l.jsx)("div",{className:"flex items-center gap-4 mr-auto",children:(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm text-zinc-300 cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",checked:x,onChange:e=>j(e.target.checked),className:"rounded border-zinc-600 bg-zinc-800 text-violet-500 focus:ring-violet-500 accent-violet-500"}),(0,l.jsx)("span",{children:"排除商辦/店面"})]})}),(0,l.jsxs)(eB,{variant:"outline",className:"hidden xl:flex bg-green-900/20 border-green-500/30 text-green-400 hover:bg-green-900/40 hover:text-green-300",children:[(0,l.jsx)(e4,{className:"mr-2 h-4 w-4"}),"輸出報表"]}),(0,l.jsxs)(eB,{variant:"default",className:"bg-violet-600 hover:bg-violet-500 text-white min-w-[120px] hidden md:flex",disabled:0===r.length||t,onClick:e,children:[t?(0,l.jsx)("span",{className:"animate-spin mr-2",children:"⟳"}):(0,l.jsx)(e2,{className:"mr-2 h-4 w-4"}),t?"分析中...":"分析報表"]})]})]})]})}let ta=o.forwardRef(({className:e,...t},r)=>(0,l.jsx)("div",{ref:r,className:eb("glass-panel rounded-xl text-card-foreground",e),...t}));function tl({title:e,description:t,children:r,action:s,className:n}){return(0,l.jsxs)(ta,{className:eb("bg-zinc-900/50 border-white/5 overflow-hidden",n),children:[(0,l.jsxs)("div",{className:"p-6 border-b border-white/5 flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-white tracking-tight",children:e}),t&&(0,l.jsx)("p",{className:"text-sm text-zinc-400",children:t})]}),s&&(0,l.jsx)("div",{className:"flex items-center gap-2",children:s})]}),(0,l.jsx)("div",{className:"p-6",children:r})]})}ta.displayName="Card",o.forwardRef(({className:e,...t},r)=>(0,l.jsx)("div",{ref:r,className:eb("flex flex-col space-y-1.5 p-6",e),...t})).displayName="CardHeader",o.forwardRef(({className:e,...t},r)=>(0,l.jsx)("h3",{ref:r,className:eb("text-lg font-semibold leading-none tracking-tight text-white",e),...t})).displayName="CardTitle",o.forwardRef(({className:e,...t},r)=>(0,l.jsx)("p",{ref:r,className:eb("text-sm text-zinc-400",e),...t})).displayName="CardDescription",o.forwardRef(({className:e,...t},r)=>(0,l.jsx)("div",{ref:r,className:eb("p-6 pt-0",e),...t})).displayName="CardContent",o.forwardRef(({className:e,...t},r)=>(0,l.jsx)("div",{ref:r,className:eb("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";let to=(0,e.i(67123).default)(()=>e.A(31593),{loadableGenerated:{modules:[94861]},ssr:!1});function tc({type:e,series:t,options:r,height:s=350,title:n,description:i,className:a,loading:o}){let c={chart:{background:"transparent",toolbar:{show:!1}},theme:{mode:"dark",palette:"palette1"},dataLabels:{enabled:!1},grid:{borderColor:"#374151",strokeDashArray:4},xaxis:{labels:{style:{colors:"#9ca3af"}},axisBorder:{color:"#4b5563"},axisTicks:{color:"#4b5563"}},yaxis:{labels:{style:{colors:"#9ca3af"}}},tooltip:{theme:"dark",style:{fontSize:"12px"},x:{show:!0}}},d={...c,...r,chart:{...c.chart,...r.chart}};return(0,l.jsxs)(ta,{className:`p-4 ${a}`,children:[(n||i)&&(0,l.jsxs)("div",{className:"mb-4",children:[n&&(0,l.jsx)("h3",{className:"text-lg font-bold text-white mb-1",children:n}),i&&(0,l.jsx)("p",{className:"text-sm text-gray-400",children:i})]}),o?(0,l.jsx)("div",{className:"flex items-center justify-center",style:{height:s},children:(0,l.jsx)("div",{className:"loader"})}):(0,l.jsx)(to,{options:d,series:t,type:e,height:s,width:"100%"})]})}function td({data:e,sortKey:t}){let r=(0,o.useMemo)(()=>["averagePrice","minPrice","maxPrice","medianPrice","avgParkingPrice"].includes(t)?"bar":"treemap",[t]),s=(0,o.useMemo)(()=>({averagePrice:{title:"建案平均單價排行",unit:"萬/坪"},minPrice:{title:"建案最低單價排行",unit:"萬/坪"},maxPrice:{title:"建案最高單價排行",unit:"萬/坪"},medianPrice:{title:"建案單價中位數排行",unit:"萬/坪"},avgParkingPrice:{title:"車位平均單價排行",unit:"萬"},saleAmountSum:{title:"建案銷售總額佔比",unit:"萬",yLabel:"銷售總額"},houseAreaSum:{title:"建案房屋面積佔比",unit:"坪",yLabel:"房屋面積"},transactionCount:{title:"建案交易筆數佔比",unit:"筆",yLabel:"資料筆數"}})[t]||{title:"建案分析圖表",unit:"",yLabel:"數值"},[t]),n=(0,o.useMemo)(()=>{if(!e||0===e.length)return[];if("bar"!==r)return e.reduce((e,r)=>e+(r[t]||0),0),[{name:s.yLabel||s.unit,data:e.map(e=>({x:e.projectName,y:parseFloat((e[t]||0).toFixed(2))}))}];{let r=[...e].filter(e=>e[t]>0).sort((e,r)=>e[t]-r[t]).slice(-30);return[{name:s.unit,data:r.map(e=>({x:e.projectName,y:parseFloat((e[t]||0).toFixed(2))}))}]}},[e,t,r,s]),i=(0,o.useMemo)(()=>{let i={title:{text:s.title,align:"center",style:{fontSize:"16px",fontWeight:600,color:"#e5e7eb"}},tooltip:{theme:"dark",y:{formatter:e=>`${e.toLocaleString()} ${s.unit}`}}};if("bar"===r){let e=Math.max(400,32*(n[0]?.data.length||0));return{...i,chart:{type:"bar",height:e,toolbar:{show:!0},animations:{enabled:!1}},plotOptions:{bar:{horizontal:!0,barHeight:"70%",borderRadius:6,distributed:!0}},dataLabels:{enabled:!0,textAnchor:"start",offsetX:0,formatter:e=>e.toLocaleString(),style:{colors:["#fff"]}},xaxis:{labels:{style:{colors:"#9ca3af"}}},yaxis:{labels:{maxWidth:200,style:{colors:"#e5e7eb",fontSize:"12px",fontWeight:500}}},legend:{show:!1}}}{let r=e.reduce((e,r)=>e+(r[t]||0),0);return{...i,chart:{type:"treemap",height:450,toolbar:{show:!0}},plotOptions:{treemap:{distributed:!0,enableShades:!1,colorScale:{ranges:[{from:0,to:.1*r,color:"#06b6d4"},{from:.1*r,to:.3*r,color:"#3b82f6"},{from:.3*r,to:.6*r,color:"#8b5cf6"},{from:.6*r,to:1/0,color:"#d946ef"}]}}},dataLabels:{enabled:!0,style:{fontSize:"11px",fontWeight:500,colors:["#fff"]},formatter:function(e,t){return e},offsetY:-2},tooltip:{...i.tooltip,y:{formatter:e=>{let t=r>0?(e/r*100).toFixed(2):0;return`${e.toLocaleString()} ${s.unit} (${t}%)`}}}}}},[r,n,s,e,t]);return e&&0!==e.length?(0,l.jsx)(tc,{type:"bar"===r?"bar":"treemap",series:n,options:i,height:"bar"===r?i.chart?.height||400:450,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無排名資料可顯示"})}var tm=e.i(67690);let tx=(0,ej.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),tu=(0,ej.default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),th=(0,ej.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),tp=(0,ej.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);function tf({data:e}){let{rankingCurrentPage:t,rankingPageSize:r,setRankingCurrentPage:s,setRankingPageSize:n}=eJ(),[i,a]=(0,o.useState)(1),[c,d]=(0,o.useState)(10),[m,x]=(0,o.useState)({key:"saleAmountSum",order:"desc"});if(!e)return null;let{coreMetrics:u,projectRanking:h}=e,p=(0,o.useMemo)(()=>h?[...h].sort((e,t)=>{let r=e[m.key]||0,s=t[m.key]||0;return"desc"===m.order?s-r:r-s}):[],[h,m]),f=Math.ceil(p.length/c),g=p.slice((i-1)*c,i*c),b=({title:e,value:t,unit:r})=>(0,l.jsxs)("div",{className:"bg-zinc-800/50 rounded-lg p-4 border border-white/5 flex flex-col items-center justify-center text-center",children:[(0,l.jsx)("div",{className:"text-zinc-400 text-sm mb-1",children:e}),(0,l.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,l.jsx)("span",{className:"text-2xl font-bold text-white",children:t}),(0,l.jsx)("span",{className:"text-xs text-zinc-500",children:r})]})]});return(0,l.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsx)(b,{title:"市場去化總銷售金額",value:u.totalSaleAmount.toLocaleString(),unit:"萬"}),(0,l.jsx)(b,{title:"總銷去化房屋坪數",value:u.totalHouseArea.toLocaleString(void 0,{maximumFractionDigits:2}),unit:"坪"}),(0,l.jsx)(b,{title:"總平均單價",value:u.overallAveragePrice.toLocaleString(void 0,{maximumFractionDigits:2}),unit:"萬/坪"}),(0,l.jsx)(b,{title:"總交易筆數",value:u.transactionCount.toLocaleString(),unit:"筆"})]}),(0,l.jsx)(tl,{title:"建案分析圖表",description:"根據排序指標顯示前30名建案",children:(0,l.jsx)(td,{data:p,sortKey:m.key})}),(0,l.jsxs)(tl,{title:"區域建案排行列表",description:"點擊表頭可進行排序",children:[(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/80 text-zinc-400 uppercase text-xs font-semibold",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3 cursor-default",children:"排名"}),(0,l.jsx)("th",{className:"px-4 py-3 cursor-default",children:"建案名稱"}),[{key:"saleAmountSum",label:(0,l.jsxs)(l.Fragment,{children:["交易",(0,l.jsx)("br",{}),"總價(萬)"]})},{key:"houseAreaSum",label:(0,l.jsxs)(l.Fragment,{children:["房屋",(0,l.jsx)("br",{}),"面積(坪)"]})},{key:"transactionCount",label:(0,l.jsxs)(l.Fragment,{children:["資料",(0,l.jsx)("br",{}),"筆數"]})},{key:"marketShare",label:(0,l.jsxs)(l.Fragment,{children:["市場",(0,l.jsx)("br",{}),"佔比(%)"]})},{key:"averagePrice",label:(0,l.jsxs)(l.Fragment,{children:["平均",(0,l.jsx)("br",{}),"單價"]})},{key:"minPrice",label:(0,l.jsxs)(l.Fragment,{children:["最低",(0,l.jsx)("br",{}),"單價"]})},{key:"maxPrice",label:(0,l.jsxs)(l.Fragment,{children:["最高",(0,l.jsx)("br",{}),"單價"]})},{key:"medianPrice",label:(0,l.jsxs)(l.Fragment,{children:["中位數",(0,l.jsx)("br",{}),"單價"]})},{key:"avgParkingPrice",label:(0,l.jsxs)(l.Fragment,{children:["車位",(0,l.jsx)("br",{}),"均價"]})}].map(e=>(0,l.jsx)("th",{className:"px-3 py-3 cursor-pointer hover:text-white transition-colors text-center whitespace-nowrap",onClick:()=>{var t;return t=e.key,void x(e=>({key:t,order:e.key===t&&"desc"===e.order?"asc":"desc"}))},children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,l.jsx)("span",{className:"leading-tight",children:e.label}),m.key===e.key?"desc"===m.order?(0,l.jsx)(tp,{size:12,className:"text-violet-500"}):(0,l.jsx)(th,{size:12,className:"text-violet-500"}):(0,l.jsx)(tu,{size:12,className:"opacity-30"})]})},e.key))]})}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:g.map((e,t)=>(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/50 transition-colors",children:[(0,l.jsx)("td",{className:"px-4 py-3 text-zinc-500 font-mono",children:(i-1)*c+t+1}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"font-medium text-white",children:e.projectName}),(0,l.jsxs)("div",{className:"flex gap-1 mt-1",children:[e.county&&(0,l.jsx)("span",{className:"text-[10px] bg-zinc-800 text-zinc-400 px-1 py-0.5 rounded",children:e.county}),e.district&&(0,l.jsx)("span",{className:"text-[10px] bg-zinc-800 text-zinc-400 px-1 py-0.5 rounded",children:e.district})]})]})}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-300",children:e.saleAmountSum.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-300",children:e.houseAreaSum.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-300",children:e.transactionCount.toLocaleString()}),(0,l.jsxs)("td",{className:"px-4 py-3 font-mono text-zinc-300",children:[e.marketShare.toFixed(2),"%"]}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-cyan-400",children:e.averagePrice.toFixed(1)}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-500",children:e.minPrice.toFixed(1)}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-500",children:e.maxPrice.toFixed(1)}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-400",children:e.medianPrice.toFixed(1)}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-400",children:e.avgParkingPrice>0?e.avgParkingPrice.toLocaleString():"-"})]},t))}),(0,l.jsx)("tfoot",{className:"bg-zinc-900/80 font-bold border-t-2 border-zinc-700",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:2,className:"px-4 py-3 text-center text-zinc-300",children:"總計"}),(0,l.jsx)("td",{className:"px-4 py-3 text-zinc-300",children:u.totalSaleAmount.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 text-zinc-300",children:u.totalHouseArea.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 text-zinc-300",children:u.transactionCount.toLocaleString()}),(0,l.jsx)("td",{colSpan:6})]})})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-4 border-t border-white/5 pt-4",children:[(0,l.jsxs)("div",{className:"text-sm text-zinc-500",children:["顯示 ",(i-1)*c+1," 到 ",Math.min(i*c,p.length)," 筆，共 ",p.length," 筆"]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(eB,{variant:"outline",size:"sm",onClick:()=>a(e=>Math.max(1,e-1)),disabled:1===i,children:(0,l.jsx)(tm.ChevronLeft,{size:16})}),(0,l.jsxs)("span",{className:"text-sm text-zinc-300",children:["Page ",i," of ",f]}),(0,l.jsx)(eB,{variant:"outline",size:"sm",onClick:()=>a(e=>Math.min(f,e+1)),disabled:i===f,children:(0,l.jsx)(tx,{size:16})})]})]})]})]})}function tg({data:e}){let t=(0,o.useMemo)(()=>e&&0!==e.length?[{name:"總價分佈",type:"boxPlot",data:e.map(e=>{let t=[e.minPrice,e.q1Price,e.medianPrice,e.q3Price,e.maxPrice];return t.some(e=>"number"!=typeof e||isNaN(e))?null:{x:null!==e.bathrooms?`${e.roomType}-${e.bathrooms}衛`:e.roomType,y:t.map(e=>Math.round(e))}}).filter(Boolean)}]:[],[e]),r=(0,o.useMemo)(()=>{if(0===t.length||0===t[0].data.length)return{};let e=t[0].data.flatMap(e=>e.y),r=Math.min(...e),s=Math.max(...e),n=s-r,i=0===n?Math.max(.1*r,100):.1*n;return{chart:{type:"boxPlot",height:450,background:"transparent",toolbar:{show:!0},foreColor:"#e5e7eb"},title:{text:"各房型總價帶分佈箱型圖",align:"center",style:{fontSize:"16px",color:"#e5e7eb"}},plotOptions:{boxPlot:{colors:{upper:"#06b6d4",lower:"#8b5cf6"},stroke:{colors:["#e5e7eb"]}}},xaxis:{type:"category",labels:{style:{colors:"#9ca3af"},rotate:-45,offsetY:5}},yaxis:{min:Math.max(0,r-i),max:s+i,title:{text:"房屋總價 (萬)",style:{color:"#9ca3af"}},labels:{formatter:e=>`${Math.round(e).toLocaleString()} 萬`,style:{colors:"#9ca3af"}}},tooltip:{custom:function({seriesIndex:e,dataPointIndex:t,w:r}){let s=r.globals.initialSeries[e].data[t].y;if(Array.isArray(s)&&5===s.length){let[e,t,r,n,i]=s;return`
                    <div class="apexcharts-tooltip-box" style="background: #18181b; border: 1px solid #27272a; padding: 8px 12px; border-radius: 8px; color: #fff;">
                        <div><strong>最高總價:</strong> ${i.toLocaleString()} 萬</div>
                        <div><strong>3/4位總價:</strong> ${n.toLocaleString()} 萬</div>
                        <div><strong>中位數總價:</strong> ${r.toLocaleString()} 萬</div>
                        <div><strong>1/4位總價:</strong> ${t.toLocaleString()} 萬</div>
                        <div><strong>最低總價:</strong> ${e.toLocaleString()} 萬</div>
                    </div>
                `}return""}}}},[t]);return e&&0!==e.length&&0!==t.length?(0,l.jsx)(tc,{type:"boxPlot",series:t,options:r,height:450,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無總價帶資料可顯示"})}function tb({roomTypes:e,locations:t,crossTable:r,dimension:s}){let n=(0,o.useMemo)(()=>e&&t&&r?e.map(e=>{let s=t.map(t=>r[e]&&r[e][t]||0);return{name:e,data:s}}):[],[e,t,r]),i=(0,o.useMemo)(()=>{let e="county"===s?"縣市":"行政區";return{chart:{type:"bar",height:Math.max(350,35*t.length),stacked:!0,background:"transparent",toolbar:{show:!0},foreColor:"#e5e7eb"},plotOptions:{bar:{horizontal:!0,barHeight:"70%",borderRadius:4,dataLabels:{total:{enabled:!0,offsetX:5,style:{fontSize:"11px",fontWeight:600,color:"#e5e7eb"},formatter:function(e,t){let r=t.w.config.series,s=t.dataPointIndex,n=0;return r.forEach(e=>{n+=e.data[s]||0}),n>0?n.toString():""}}}}},colors:["#06b6d4","#8b5cf6","#10b981","#f59e0b","#ef4444","#3b82f6","#ec4899","#84cc16","#6366f1","#14b8a6"],dataLabels:{enabled:!1},xaxis:{categories:t,title:{text:"成交筆數",style:{color:"#9ca3af"}},labels:{style:{colors:"#9ca3af"}}},yaxis:{title:{text:e,style:{color:"#9ca3af"}},labels:{style:{colors:"#e5e7eb"},maxWidth:150}},legend:{position:"top",horizontalAlign:"center",labels:{colors:"#e5e7eb"}},tooltip:{theme:"dark",y:{formatter:function(e){return e+" 筆"}}},grid:{borderColor:"#374151"},title:{text:`各${e}房型成交筆數分佈`,align:"center",style:{fontSize:"16px",color:"#e5e7eb"}}}},[t,s]);return n&&0!==n.length?(0,l.jsx)(tc,{type:"bar",series:n,options:i,height:i.chart?.height||350,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無區域分佈資料"})}function ty({isOpen:e,onClose:t,title:r,projects:s}){let n=(0,o.useRef)(null);return((0,o.useEffect)(()=>{let r=e=>{"Escape"===e.key&&t()};return e&&(document.addEventListener("keydown",r),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",r),document.body.style.overflow=""}},[e,t]),e)?(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e=>{n.current&&!n.current.contains(e.target)&&t()},children:(0,l.jsxs)("div",{ref:n,className:"bg-zinc-900 border border-white/10 rounded-xl shadow-2xl max-w-md w-full mx-4 animate-in zoom-in-95 duration-200",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/5",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:r}),(0,l.jsx)("button",{onClick:t,className:"p-1 rounded hover:bg-white/10 text-zinc-400 hover:text-white transition-colors",children:(0,l.jsx)(eX,{size:20})})]}),(0,l.jsx)("div",{className:"px-5 py-4 max-h-[50vh] overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-700",children:0===s.length?(0,l.jsx)("p",{className:"text-zinc-500 text-center py-4",children:"無建案資料"}):(0,l.jsx)("ul",{className:"space-y-2",children:s.map((e,t)=>(0,l.jsx)("li",{className:eb("px-3 py-2 rounded-lg text-zinc-200 text-sm","bg-zinc-800/50 hover:bg-zinc-800 transition-colors","border border-white/5"),children:e},t))})}),(0,l.jsxs)("div",{className:"px-5 py-3 border-t border-white/5 flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"text-xs text-zinc-500",children:["共 ",s.length," 個建案"]}),(0,l.jsx)("button",{onClick:t,className:"px-4 py-1.5 text-sm rounded-lg bg-zinc-800 text-zinc-300 hover:bg-zinc-700 transition-colors",children:"關閉"})]})]})}):null}function tj({data:e}){let t=["套房","1房","2房","3房","4房","毛胚"],[r,s]=(0,o.useState)(t),[n,i]=(0,o.useState)("district"),[a,c]=(0,o.useState)(!1),[d,m]=(0,o.useState)(""),[x,u]=(0,o.useState)([]),[h,p]=(0,o.useState)(null),f=(0,o.useMemo)(()=>{if(!e?.transactionDetails)return[];let t=new Set;return e.transactionDetails.forEach(e=>{e["縣市"]&&t.add(e["縣市"])}),Array.from(t).sort()},[e?.transactionDetails]);o.default.useEffect(()=>{!h&&f.length>0&&p(f[0])},[f,h]);let g=(e,t,r)=>{m(`${e}${null!==t?` / ${t}衛`:""} 建案組成`),u(r),c(!0)};if(!e||!e.details)return null;let{details:b,locationCrossTable:y,allDistricts:j,transactionDetails:v}=e,N=(0,o.useMemo)(()=>Array.from(new Set(b.map(e=>e.roomType))),[b]),w=(0,o.useMemo)(()=>b.filter(e=>r.includes(e.roomType)),[b,r]),[k,z]=(0,o.useState)(!0),P=(0,o.useMemo)(()=>{let e=b.filter(e=>r.includes(e.roomType));if(!k)return e;let s=new Map;return e.forEach(e=>{let t=e.roomType;s.has(t)||s.set(t,{...e,bathrooms:null,projectNames:e.projectNames?[...e.projectNames]:[],count:0,avgPrice:0});let r=s.get(t),n=r.avgPrice*r.count,i=e.avgPrice*e.count,a=r.count+e.count;r.count=a,r.avgPrice=a>0?(n+i)/a:0,r.minPrice=Math.min(r.minPrice,e.minPrice),r.maxPrice=Math.max(r.maxPrice,e.maxPrice);let l=r.count-e.count,o=e.count;if(r.medianPrice=(r.medianPrice*l+e.medianPrice*o)/a,r.q1Price=(r.q1Price*l+e.q1Price*o)/a,r.q3Price=(r.q3Price*l+e.q3Price*o)/a,e.projectNames){let t=new Set([...r.projectNames||[],...e.projectNames]);r.projectNames=Array.from(t)}}),Array.from(s.values()).sort((e,r)=>t.indexOf(e.roomType)-t.indexOf(r.roomType))},[b,r,k,t]),S=(0,o.useMemo)(()=>{if("county"===n&&v){let e={},t=new Set;v.forEach(r=>{let s=r["房型"]||r.roomType||r["戶型"];if(!s||"其他"===s){let e=Number(r["房數"]);s=!isNaN(e)&&e>0?`${e}房`:"其他"}let n="string"==typeof s?s.replace(/\s+/g,""):s;("number"==typeof n||"string"==typeof n&&/^\d+$/.test(n))&&(n=`${n}房`);let i=r["縣市"]||"未知";e[n]||(e[n]={}),e[n][i]=(e[n][i]||0)+1,t.add(i)});let s=Array.from(t).sort(),n={},i=0;s.forEach(e=>n[e]=0);let a=r.map(t=>{let r=e[t]||{},a=0,l=s.map(e=>{let t=r[e]||0;return a+=t,n[e]+=t,t});return i+=a,{roomType:t,cells:l,rowTotal:a}});return{locations:s,rows:a,locationTotals:n,grandTotal:i}}if("district"===n){let e={},t=new Set;if(v)v.forEach(r=>{let s=r["房型"]||r.roomType||r["戶型"];if(!s||"其他"===s){let e=Number(r["房數"]);s=!isNaN(e)&&e>0?`${e}房`:"其他"}let n="string"==typeof s?s.replace(/\s+/g,""):s;("number"==typeof n||"string"==typeof n&&/^\d+$/.test(n))&&(n=`${n}房`);let i=r["行政區"]||"未知",a=r["縣市"]||"未知";h&&a!==h||(e[n]||(e[n]={}),e[n][i]=(e[n][i]||0)+1,t.add(i))});else if(y){let s=new Set;r.forEach(e=>{let t=y[e];t&&Object.keys(t).forEach(e=>s.add(e))}),s.forEach(e=>t.add(e)),r.forEach(t=>{let r=y[t];r&&(e[t]=r)})}let s=Array.from(t).sort(),n={},i=0;s.forEach(e=>n[e]=0);let a=r.map(t=>{let r=e[t]||{},a=0,l=s.map(e=>{let t=r[e]||0;return a+=t,n[e]+=t,t});return i+=a,{roomType:t,cells:l,rowTotal:a}});return{locations:s,rows:a,locationTotals:n,grandTotal:i}}return null},[y,v,r,n,h]),[M,C]=(0,o.useState)(new Set);return(0,l.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:N.map(e=>(0,l.jsx)("button",{onClick:()=>{s(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:eb("px-3 py-1 rounded-full text-xs font-medium transition-colors border",r.includes(e)?"bg-violet-500/20 border-violet-500 text-violet-200":"bg-zinc-800/50 border-zinc-700 text-zinc-500 hover:bg-zinc-800"),children:e},e))}),(0,l.jsxs)("div",{className:"flex items-center gap-2 bg-zinc-800/50 p-1 rounded-lg border border-white/5",children:[(0,l.jsx)("span",{className:"text-xs text-zinc-400 pl-2",children:"表格顯示:"}),(0,l.jsx)("button",{onClick:()=>z(!k),className:eb("px-3 py-1 text-xs font-medium rounded-md transition-all",k?"bg-violet-500 text-white shadow-sm":"text-zinc-400 hover:text-white hover:bg-zinc-700"),children:k?"依房型合併":"顯示衛浴細節"})]})]}),(0,l.jsx)(tl,{title:"各房型總價帶分佈箱型圖",description:"顯示各房型總價的中位數與四分位距",children:(0,l.jsx)(tg,{data:P})}),(0,l.jsx)(tl,{title:"總價帶詳細數據",description:k?"各房型合併統計 (點擊「全部」可展開細節)":"各房型詳細價格統計",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/80 text-zinc-400 uppercase text-xs font-semibold",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"房型"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"衛浴"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"建案數"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"筆數"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"平均總價"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"最低總價"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"1/4位總價"}),(0,l.jsx)("th",{className:"px-4 py-3 text-violet-400",children:"中位數總價"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"3/4位總價"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"最高總價"})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-white/5",children:[P.map((e,t)=>{let r,s=k&&null===e.bathrooms,n=M.has(e.roomType),i=s&&n?(r=e.roomType,b.filter(e=>e.roomType===r).sort((e,t)=>(Number(e.bathrooms)||0)-(Number(t.bathrooms)||0))):[];return(0,l.jsxs)(o.default.Fragment,{children:[(0,l.jsxs)("tr",{className:eb("hover:bg-zinc-800/50 transition-colors",n&&"bg-zinc-800/30"),children:[(0,l.jsx)("td",{className:"px-4 py-3 font-medium text-white",children:e.roomType}),(0,l.jsx)("td",{className:"px-4 py-3 text-zinc-400",children:s?(0,l.jsxs)("button",{onClick:()=>{var t;return t=e.roomType,void C(e=>{let r=new Set(e);return r.has(t)?r.delete(t):r.add(t),r})},className:"flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-zinc-700/50 hover:bg-zinc-600 hover:text-white transition-colors cursor-pointer",children:[(0,l.jsx)("span",{children:"全部"}),(0,l.jsx)("span",{className:eb("transform transition-transform text-[10px]",n?"rotate-180":""),children:"▼"})]}):e.bathrooms??"-"}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.projectNames&&e.projectNames.length>0?(0,l.jsxs)("button",{onClick:()=>g(e.roomType,e.bathrooms,e.projectNames||[]),className:"px-2 py-1 text-xs font-medium rounded-full bg-violet-500/20 border border-violet-500/50 text-violet-300 hover:bg-violet-500/30 transition-colors cursor-pointer",children:[e.projectNames.length," 個建案"]}):(0,l.jsx)("span",{className:"text-zinc-500",children:"-"})}),(0,l.jsx)("td",{className:"px-4 py-3 text-zinc-300",children:e.count.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-300",children:e.avgPrice.toLocaleString(void 0,{maximumFractionDigits:0})}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-500",children:e.minPrice.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-500",children:e.q1Price.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-violet-400 font-bold",children:e.medianPrice.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-500",children:e.q3Price.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-3 font-mono text-zinc-500",children:e.maxPrice.toLocaleString()})]}),i.map((e,r)=>(0,l.jsxs)("tr",{className:"bg-zinc-900/50 hover:bg-zinc-900 border-l-2 border-l-violet-500/30",children:[(0,l.jsxs)("td",{className:"px-4 py-2 font-medium text-zinc-500 text-xs pl-8",children:["↳ ",e.roomType]}),(0,l.jsxs)("td",{className:"px-4 py-2 text-zinc-400 text-xs",children:[e.bathrooms," 衛"]}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.projectNames&&e.projectNames.length>0?(0,l.jsxs)("button",{onClick:()=>g(e.roomType,e.bathrooms,e.projectNames||[]),className:"text-xs text-zinc-500 hover:text-zinc-300 underline decoration-zinc-700",children:[e.projectNames.length," 建案"]}):"-"}),(0,l.jsx)("td",{className:"px-4 py-2 text-zinc-500 text-xs",children:e.count.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-zinc-500 text-xs",children:e.avgPrice.toLocaleString(void 0,{maximumFractionDigits:0})}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-zinc-600 text-xs",children:e.minPrice.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-zinc-600 text-xs",children:e.q1Price.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-zinc-500 text-xs font-medium",children:e.medianPrice.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-zinc-600 text-xs",children:e.q3Price.toLocaleString()}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-zinc-600 text-xs",children:e.maxPrice.toLocaleString()})]},`${t}-sub-${r}`))]},t)}),0===w.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:10,className:"p-8 text-center text-zinc-500",children:"請選擇房型顯示數據"})})]})]})})}),(S||v)&&(0,l.jsxs)("div",{className:"space-y-6 pt-4 border-t border-white/5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:"區域分組交叉分析"}),(0,l.jsxs)("div",{className:"flex bg-zinc-800 rounded-md p-0.5",children:[(0,l.jsx)("button",{onClick:()=>i("district"),className:eb("px-2 py-1 text-xs rounded transition-colors","district"===n?"bg-zinc-700 text-white":"text-zinc-400 hover:text-white"),children:"行政區"}),(0,l.jsx)("button",{onClick:()=>i("county"),className:eb("px-2 py-1 text-xs rounded transition-colors","county"===n?"bg-zinc-700 text-white":"text-zinc-400 hover:text-white"),children:"縣市"})]})]}),"district"===n&&f.length>1&&(0,l.jsxs)("div",{className:"flex items-center gap-2 pb-2",children:[(0,l.jsx)("span",{className:"text-sm text-zinc-500",children:"顯示縣市:"}),(0,l.jsx)("div",{className:"flex gap-1 bg-zinc-900 p-1 rounded-lg",children:f.map(e=>(0,l.jsx)("button",{onClick:()=>p(e),className:eb("px-3 py-1 text-xs font-medium rounded-md transition-all",h===e?"bg-violet-500/20 text-violet-300 shadow-sm border border-violet-500/50":"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800"),children:e},e))})]}),(0,l.jsx)(tl,{title:"區域房型成交分佈",description:"各區域不同房型的成交數量熱力分佈",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:S?(0,l.jsxs)("table",{className:"w-full text-sm text-left border-collapse",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/80 text-zinc-400 font-semibold",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-3 py-2 sticky left-0 bg-zinc-900 z-10 border-r border-white/5",children:"房型"}),S.locations.map(e=>(0,l.jsx)("th",{className:"px-3 py-2 text-center min-w-[80px]",children:e},e)),(0,l.jsx)("th",{className:"px-3 py-2 text-center border-l border-white/5 bg-zinc-900 font-bold text-white",children:"總計"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:S.rows.map((e,t)=>(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/30",children:[(0,l.jsx)("td",{className:"px-3 py-2 font-medium text-zinc-300 sticky left-0 bg-zinc-950/90 border-r border-white/5",children:e.roomType}),e.cells.map((e,t)=>{let r=e>0?Math.min(e/20,1):0,s=e>0?{backgroundColor:`rgba(6, 182, 212, ${.3*r})`}:{};return(0,l.jsx)("td",{className:"px-3 py-2 text-center text-zinc-400",style:s,children:e>0?e:"-"},t)}),(0,l.jsx)("td",{className:"px-3 py-2 text-center font-bold text-white border-l border-white/5 bg-zinc-900/50",children:e.rowTotal})]},t))}),(0,l.jsx)("tfoot",{className:"bg-zinc-900 font-bold border-t-2 border-zinc-700",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"px-3 py-2 sticky left-0 bg-zinc-900 border-r border-white/5 text-white",children:"總計"}),S.locations.map(e=>(0,l.jsx)("td",{className:"px-3 py-2 text-center text-white",children:S.locationTotals[e]},e)),(0,l.jsx)("td",{className:"px-3 py-2 text-center text-cyan-400 border-l border-white/5 bg-zinc-900",children:S.grandTotal})]})})]}):(0,l.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"無區域分佈數據"})})}),(0,l.jsx)(tl,{title:"區域成交佔比圖表",children:S&&(0,l.jsx)(tb,{roomTypes:r,locations:S.locations,crossTable:S.rows.reduce((e,t)=>{let r={};return S.locations.forEach((e,s)=>{r[e]=t.cells[s]}),e[t.roomType]=r,e},{}),dimension:n})})]}),(0,l.jsx)(ty,{isOpen:a,onClose:()=>c(!1),title:d,projects:x})]})}function tv({data:e,selectedRooms:t,metric:r}){let s=(0,o.useMemo)(()=>({count:{label:"交易筆數",unit:"筆",decimals:0},priceSum:{label:"產權總價",unit:"萬",decimals:0},areaSum:{label:"房屋坪數",unit:"坪",decimals:2}})[r],[r]),n=(0,o.useMemo)(()=>{if(!e||0===t.length)return[];let s=Object.keys(e).sort();return 0===s.length?[]:t.map(t=>({name:t,data:s.map(s=>e[s]?.[t]?.[r]||0)}))},[e,t,r]),i=(0,o.useMemo)(()=>({chart:{type:"line",height:350,background:"transparent",toolbar:{show:!0},zoom:{enabled:!1},foreColor:"#e5e7eb"},stroke:{curve:"smooth",width:2},dataLabels:{enabled:!1},xaxis:{categories:e?Object.keys(e).sort():[],labels:{style:{colors:"#9ca3af"}}},yaxis:{title:{text:s.label,style:{color:"#9ca3af"}},labels:{style:{colors:"#9ca3af"},formatter:e=>e.toLocaleString("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0})}},legend:{position:"top",horizontalAlign:"right"},tooltip:{theme:"dark",y:{formatter:e=>`${e.toLocaleString("zh-TW",{minimumFractionDigits:s.decimals,maximumFractionDigits:s.decimals})} ${s.unit}`}},grid:{borderColor:"#374151"}}),[e,s]);return e&&0!==Object.keys(e).length&&0!==t.length?(0,l.jsx)(tc,{type:"line",series:n,options:i,height:350,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"請選擇房型以顯示銷售趨勢"})}function tN({data:e,selectedRooms:t,minArea:r,maxArea:s,interval:n,onDataPointClick:i}){let a=(0,o.useMemo)(()=>[{from:0,to:0,color:"#27272a",name:"0 戶"},{from:1,to:5,color:"#facc15",name:"1-5 戶"},{from:6,to:20,color:"#fbbf24",name:"6-20 戶"},{from:21,to:50,color:"#f97316",name:"21-50 戶"},{from:51,to:1e4,color:"#dc2626",name:"> 50 戶"}],[]),{series:c,maxValue:d}=(0,o.useMemo)(()=>{if(!e||0===t.length)return{series:[],maxValue:0};let i=[];for(let e=r;e<s;e+=n)i.push(`${e.toFixed(1)}-${(e+n).toFixed(1)}`);let a=0;return{series:i.map(n=>{let[i,l]=n.split("-").map(parseFloat);return{name:n,data:t.map(t=>{let n=(e[t]||[]).filter(e=>e>=i&&e<l&&e>=r&&e<=s).length;return n>a&&(a=n),n})}}),maxValue:a}},[e,t,r,s,n]),m=(0,o.useMemo)(()=>({chart:{type:"heatmap",height:Math.max(400,22*c.length),background:"transparent",toolbar:{show:!0},foreColor:"#e5e7eb",events:{dataPointSelection:(e,r,s)=>{if(i){let{seriesIndex:e,dataPointIndex:r}=s,n=s.w.globals.seriesNames[e];i(t[r],n)}}}},plotOptions:{heatmap:{radius:0,useFillColorAsStroke:!0,enableShades:!1,colorScale:{ranges:a}}},dataLabels:{enabled:!0,style:{colors:[({value:e})=>0===e?"transparent":"#e5e7eb"]}},xaxis:{type:"category",categories:t},title:{text:"房型面積分佈熱力圖",align:"center",style:{color:"#e5e7eb",fontSize:"16px"}},grid:{borderColor:"#374151"},tooltip:{theme:"dark",y:{formatter:e=>0===e?"無成交紀錄":`${e} 戶`}}}),[c,t,a,i]);return e&&0!==c.length?(0,l.jsx)(tc,{type:"heatmap",series:c,options:m,height:m.chart?.height||400,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無面積分佈資料"})}function tw({data:e,viewType:t,selectedRooms:r}){if(!e||0===Object.keys(e).length)return(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無銷售速度資料"});let s=Object.keys(e).sort().reverse();return(0,l.jsx)("div",{className:"overflow-x-auto max-h-[600px] border border-white/5 rounded-lg",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left border-collapse",children:[(0,l.jsxs)("thead",{className:"bg-zinc-900 sticky top-0 z-20 shadow-md",children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{rowSpan:2,className:"px-4 py-3 sticky left-0 z-30 bg-zinc-900 border-r border-white/10 font-medium text-white min-w-[120px]",children:"時間"}),r.map(e=>(0,l.jsx)("th",{colSpan:3,className:"px-2 py-2 text-center border-l border-white/5 text-zinc-300 font-medium bg-zinc-900/90",children:e},e)),(0,l.jsx)("th",{colSpan:3,className:"px-2 py-2 text-center border-l-2 border-white/10 text-cyan-400 font-bold bg-zinc-900/90",children:"總計"})]}),(0,l.jsxs)("tr",{children:[r.map((e,t)=>(0,l.jsxs)(o.default.Fragment,{children:[(0,l.jsx)("th",{className:eb("px-2 py-2 text-center text-xs text-zinc-500 font-normal bg-zinc-900/90 border-b border-white/10",0===t&&"border-l border-white/5"),children:"筆數"}),(0,l.jsx)("th",{className:"px-2 py-2 text-center text-xs text-zinc-500 font-normal bg-zinc-900/90 border-b border-white/10",children:"總價(萬)"}),(0,l.jsx)("th",{className:"px-2 py-2 text-center text-xs text-zinc-500 font-normal bg-zinc-900/90 border-b border-white/10",children:"坪數"})]},e)),(0,l.jsx)("th",{className:"px-2 py-2 text-center text-xs text-zinc-400 font-medium bg-zinc-900/90 border-b border-white/10 border-l-2 border-white/10",children:"筆數"}),(0,l.jsx)("th",{className:"px-2 py-2 text-center text-xs text-zinc-400 font-medium bg-zinc-900/90 border-b border-white/10",children:"總價(萬)"}),(0,l.jsx)("th",{className:"px-2 py-2 text-center text-xs text-zinc-400 font-medium bg-zinc-900/90 border-b border-white/10",children:"坪數"})]})]}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:s.map(s=>{let n=e[s]||{},i={count:0,priceSum:0,areaSum:0};return(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/30 transition-colors",children:[(0,l.jsx)("td",{className:"px-4 py-2 sticky left-0 z-10 bg-zinc-950/90 border-r border-white/10 font-mono text-zinc-400",children:("weekly"===t&&s.includes("-W"),s)}),r.map((e,t)=>{let r=n[e];return r?(i.count+=r.count,i.priceSum+=r.priceSum,i.areaSum+=r.areaSum,(0,l.jsxs)(o.default.Fragment,{children:[(0,l.jsx)("td",{className:eb("px-2 py-2 text-center text-zinc-300",0===t&&"border-l border-white/5"),children:r.count>0?r.count.toLocaleString():"-"}),(0,l.jsx)("td",{className:"px-2 py-2 text-center text-zinc-500 font-mono text-xs",children:r.count>0?ey(r.priceSum,0):"-"}),(0,l.jsx)("td",{className:"px-2 py-2 text-center text-zinc-500 font-mono text-xs",children:r.count>0?ey(r.areaSum,1):"-"})]},e)):(0,l.jsxs)(o.default.Fragment,{children:[(0,l.jsx)("td",{className:eb("px-2 py-2 text-center text-zinc-700",0===t&&"border-l border-white/5"),children:"-"}),(0,l.jsx)("td",{className:"px-2 py-2 text-center text-zinc-700",children:"-"}),(0,l.jsx)("td",{className:"px-2 py-2 text-center text-zinc-700",children:"-"})]},e)}),(0,l.jsx)("td",{className:"px-2 py-2 text-center font-bold text-cyan-400 border-l-2 border-white/10",children:i.count.toLocaleString()}),(0,l.jsx)("td",{className:"px-2 py-2 text-center font-bold text-zinc-300 font-mono text-xs",children:ey(i.priceSum,0)}),(0,l.jsx)("td",{className:"px-2 py-2 text-center font-bold text-zinc-300 font-mono text-xs",children:ey(i.areaSum,1)})]},s)})})]})})}function tk({data:e}){let[t,r]=(0,o.useState)("monthly"),[s,n]=(0,o.useState)("count"),[i,a]=(0,o.useState)(15),[c,d]=(0,o.useState)(65),[m,x]=(0,o.useState)(5),[u,h]=(0,o.useState)([]),[p,f]=(0,o.useState)(null),[g,b]=(0,o.useState)(["2房","3房"]);if(!e)return null;let{salesVelocityAnalysis:y,areaDistributionAnalysis:j}=e,v=e=>Math.round(e)+"萬";return(0,l.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"p-4 bg-zinc-900/30 border border-white/5 rounded-lg flex flex-wrap gap-2 items-center sticky top-0 z-40 backdrop-blur-md",children:[(0,l.jsx)("span",{className:"text-zinc-400 text-sm mr-2",children:"分析房型:"}),["套房","1房","2房","3房","4房","毛胚","店舖","辦公/事務所"].map(e=>(0,l.jsx)("button",{onClick:()=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:eb("px-3 py-1 text-xs rounded-full border transition-colors",g.includes(e)?"bg-violet-500/20 border-violet-500 text-violet-200":"bg-zinc-800 border-zinc-700 text-zinc-500 hover:bg-zinc-700"),children:e},e))]}),(0,l.jsx)(tl,{title:"房型銷售速度與趨勢分析",action:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(e1,{value:t,onChange:e=>r(e.target.value),className:"w-[100px] h-8 text-xs bg-zinc-950/50",children:[(0,l.jsx)("option",{value:"weekly",children:"每週"}),(0,l.jsx)("option",{value:"monthly",children:"每月"}),(0,l.jsx)("option",{value:"quarterly",children:"每季"}),(0,l.jsx)("option",{value:"yearly",children:"每年"})]}),(0,l.jsxs)(e1,{value:s,onChange:e=>n(e.target.value),className:"w-[100px] h-8 text-xs bg-zinc-950/50",children:[(0,l.jsx)("option",{value:"count",children:"交易筆數"}),(0,l.jsx)("option",{value:"priceSum",children:"總銷金額"}),(0,l.jsx)("option",{value:"areaSum",children:"總銷坪數"})]})]}),children:(0,l.jsx)(tv,{data:y?.[t],selectedRooms:g,metric:s})}),(0,l.jsx)(tl,{title:"銷售速度明細表",description:"各時間段詳細銷售數據統計",children:(0,l.jsx)(tw,{data:y?.[t],viewType:t,selectedRooms:g})}),(0,l.jsxs)(tl,{title:"房型面積分佈熱力圖",description:"分析不同坪數區間的產品供給與去化分佈",action:(0,l.jsxs)("div",{className:"flex gap-2 items-center text-zinc-400 text-xs",children:[(0,l.jsx)("span",{children:"範圍:"}),(0,l.jsx)(eU,{type:"number",value:i,onChange:e=>a(Number(e.target.value)),className:"w-16 h-8 text-xs bg-zinc-950/50"}),(0,l.jsx)("span",{children:"-"}),(0,l.jsx)(eU,{type:"number",value:c,onChange:e=>d(Number(e.target.value)),className:"w-16 h-8 text-xs bg-zinc-950/50"}),(0,l.jsx)("span",{className:"ml-2",children:"級距:"}),(0,l.jsx)(eU,{type:"number",value:m,onChange:e=>x(Number(e.target.value)),className:"w-16 h-8 text-xs bg-zinc-950/50"})]}),children:[(0,l.jsx)(tN,{data:j,selectedRooms:g,minArea:i,maxArea:c,interval:m,onDataPointClick:(t,r)=>{let s=0,n=1/0;if(r.includes("<"))n=parseFloat(r.replace("<","").trim());else if(r.includes(">"))s=parseFloat(r.replace(">","").trim());else if(r.includes("-")){let e=r.split("-");s=parseFloat(e[0].trim()),n=parseFloat(e[1].trim())}let i=(e.transactionDetails||[]).filter(e=>{let r=function(e){let t=e=>e?String(e).normalize("NFKC").toUpperCase().replace(/\s+/g,""):"",r=t(e["建物型態"]||e.buildingType),s=t(e["主要用途"]||e.mainPurpose),n=t(e["戶別"]||e.unit),i=void 0!==e["房數"]?e["房數"]:e.rooms,a=void 0!==e["房屋面積(坪)"]?parseFloat(e["房屋面積(坪)"]):parseFloat(e.houseArea||0);if(r.includes("住宅大樓")&&n.includes("S")||n.includes("店舖")||n.includes("店面")||n.includes("店鋪"))return"店舖";if(n.includes("事務所")||n.includes("辦公"))return"辦公/事務所";if(r.includes("店舖")||r.includes("店面")||r.includes("店鋪"))return"店舖";if(r.includes("工廠")||r.includes("倉庫")||r.includes("廠辦"))return"廠辦/工廠";if(s.includes("商業")||r.includes("辦公")||r.includes("事務所"))return"辦公/事務所";if((r.includes("住宅大樓")||r.includes("華廈"))&&0===i){if(a>35)return"毛胚";if(a<=35)return"套房"}if("number"==typeof i&&!isNaN(i)){if(1===i)return"1房";if(2===i)return"2房";if(3===i)return"3房";if(4===i)return"4房";if(i>=5)return"5房以上"}return"其他"}(e),i=parseFloat(e["房屋面積(坪)"]||e.houseArea||(e["建物移轉平方公尺"]?.3025*e["建物移移轉平方公尺"]:0));if(!r)return!1;let a=i>=s&&i<n;return r===t&&a});console.log(`[Heatmap Click] Room: ${t}, Range: ${s}-${n}, Found: ${i.length}`);let a={};i.forEach(e=>{let t=e["建案名稱"]||e.projectName||"未知建案";a[t]||(a[t]=[]),a[t].push(e)});let l=Object.entries(a).map(([e,t])=>{let r=t.map(e=>e["產權總價"]||e["交易總價(萬)"]||e.totalPrice||0).filter(e=>e>0).sort((e,t)=>e-t),s=t.map(e=>e["房屋單價"]||e["房屋單價(萬)"]||e.unitPrice||0).filter(e=>e>0),n=0;if(r.length>0){let e=Math.floor(r.length/2);n=r.length%2!=0?r[e]:(r[e-1]+r[e])/2}return{projectName:e,count:t.length,priceRange:{min:r.length>0?r[0]:0,max:r.length>0?r[r.length-1]:0,median:n},unitPriceRange:{min:s.length>0?Math.min(...s):0,max:s.length>0?Math.max(...s):0},transactions:t.sort((e,t)=>{let r=e["房屋單價"]||e["房屋單價(萬)"]||e.unitPrice||0;return(t["房屋單價"]||t["房屋單價(萬)"]||t.unitPrice||0)-r}),isExpanded:!1}});l.sort((e,t)=>t.unitPriceRange.max-e.unitPriceRange.max),h(l),f({roomType:t,areaRange:r,totalCount:i.length})}}),p&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-zinc-900/50 border border-white/10 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"text-white font-medium flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-cyan-400",children:p.roomType}),(0,l.jsx)("span",{className:"text-zinc-500",children:"|"}),(0,l.jsxs)("span",{children:[p.areaRange," 坪"]})]}),(0,l.jsxs)("p",{className:"text-zinc-400 text-xs mt-1",children:["共找到 ",u.length," 個建案，合計 ",p.totalCount," 筆交易"]})]}),(0,l.jsx)("button",{onClick:()=>f(null),className:"text-zinc-400 hover:text-white text-sm bg-zinc-800/50 px-3 py-1 rounded-full hover:bg-zinc-700 transition-colors",children:"✕ 關閉"})]}),u.length>0?(0,l.jsx)("div",{className:"max-h-[500px] overflow-y-auto pr-1 custom-scrollbar",children:(0,l.jsxs)("table",{className:"w-full text-xs border-collapse",children:[(0,l.jsx)("thead",{className:"bg-zinc-800 text-zinc-300 sticky top-0 z-10 shadow-sm",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-3 text-left w-[25%]",children:"建案名稱 (戶數)"}),(0,l.jsx)("th",{className:"p-3 text-center w-[25%]",children:"成交單價範圍 (萬/坪)"}),(0,l.jsx)("th",{className:"p-3 text-center w-[15%]",children:"總價中位數"}),(0,l.jsx)("th",{className:"p-3 text-center w-[35%]",children:"成交總價範圍 (萬)"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:u.map((e,t)=>(0,l.jsxs)(o.default.Fragment,{children:[(0,l.jsxs)("tr",{className:eb("group transition-colors cursor-pointer select-none",e.isExpanded?"bg-zinc-800/60":"hover:bg-zinc-800/30"),onClick:()=>{h(e=>e.map((e,r)=>r===t?{...e,isExpanded:!e.isExpanded}:e))},children:[(0,l.jsxs)("td",{className:"p-3 font-medium text-white flex items-center gap-2",children:[(0,l.jsx)("span",{className:eb("text-zinc-500 transition-transform duration-200",e.isExpanded?"rotate-90":""),children:"▶"}),e.projectName,(0,l.jsx)("span",{className:"px-1.5 py-0.5 rounded-full bg-zinc-700 text-zinc-300 text-[10px] min-w-[24px] text-center",children:e.count})]}),(0,l.jsx)("td",{className:"p-3 text-center font-mono text-cyan-400",children:e.unitPriceRange.min===e.unitPriceRange.max?e.unitPriceRange.min.toFixed(1):`${e.unitPriceRange.min.toFixed(1)} ~ ${e.unitPriceRange.max.toFixed(1)}`}),(0,l.jsx)("td",{className:"p-3 text-center font-mono text-violet-400",children:v(e.priceRange.median||0)}),(0,l.jsx)("td",{className:"p-3 text-center font-mono text-zinc-300",children:e.priceRange.min===e.priceRange.max?v(e.priceRange.min):`${v(e.priceRange.min)} ~ ${v(e.priceRange.max)}`})]}),e.isExpanded&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:4,className:"p-0 bg-zinc-950/30 inset-shadow",children:(0,l.jsx)("div",{className:"p-2 pl-8 border-l-2 border-zinc-700/50 ml-4 my-1",children:(0,l.jsxs)("table",{className:"w-full text-xs bg-transparent opacity-80",children:[(0,l.jsx)("thead",{className:"text-zinc-500 border-b border-white/5",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-1 text-left font-normal pl-2",children:"樓層"}),(0,l.jsx)("th",{className:"py-1 text-left font-normal",children:"戶型"}),(0,l.jsx)("th",{className:"py-1 text-right font-normal",children:"坪數"}),(0,l.jsx)("th",{className:"py-1 text-right font-normal",children:"單價"}),(0,l.jsx)("th",{className:"py-1 text-right font-normal pr-2",children:"總價"})]})}),(0,l.jsxs)("tbody",{children:[e.transactions.slice(0,e.showAll?void 0:10).map((e,t)=>(0,l.jsxs)("tr",{className:"hover:text-white",children:[(0,l.jsx)("td",{className:"py-1 pl-2",children:e["樓層"]||e.floor||"-"}),(0,l.jsx)("td",{className:"py-1 text-left text-zinc-400",children:e["戶型"]||"-"}),(0,l.jsx)("td",{className:"py-1 text-right font-mono",children:(e["房屋面積(坪)"]||e.houseArea||0).toFixed(1)}),(0,l.jsx)("td",{className:"py-1 text-right font-mono text-cyan-500",children:(e["房屋單價(萬)"]||e.unitPrice||0).toFixed(1)}),(0,l.jsx)("td",{className:"py-1 text-right font-mono pr-2",children:v(e["交易總價(萬)"]||e.totalPrice||0)})]},t)),e.transactions.length>10&&!e.showAll&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"py-2 text-center",children:(0,l.jsxs)("button",{onClick:e=>{e.stopPropagation(),h(e=>e.map((e,r)=>r===t?{...e,showAll:!0}:e))},className:"text-zinc-500 hover:text-zinc-300 italic text-xs hover:underline",children:["... 還有 ",e.transactions.length-10," 筆 (點擊展開) ..."]})})}),e.transactions.length>10&&e.showAll&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"py-2 text-center",children:(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),h(e=>e.map((e,r)=>r===t?{...e,showAll:!1}:e))},className:"text-zinc-500 hover:text-zinc-300 italic text-xs hover:underline",children:"... 收合 ..."})})})]})]})})})})]},t))})]})}):(0,l.jsx)("p",{className:"text-zinc-500 text-center py-8 bg-zinc-900/30 rounded border border-dashed border-zinc-800",children:"無詳細資料"})]})]})]})}function tz({data:e}){let t=(0,o.useMemo)(()=>e?[e.withParking.count,e.withoutParking.count]:[],[e]),r=(0,o.useMemo)(()=>({chart:{type:"donut",background:"transparent",foreColor:"#e5e7eb"},labels:["含車位","無車位"],colors:["#a5b4fc","#4b5563"],plotOptions:{pie:{donut:{labels:{show:!0,total:{show:!0,label:"總交易",color:"#e5e7eb",formatter:e=>e.globals.seriesTotals.reduce((e,t)=>e+t,0).toLocaleString()+" 筆"}}}}},dataLabels:{enabled:!0,formatter:e=>`${e.toFixed(1)}%`},legend:{position:"bottom"},tooltip:{theme:"dark",y:{formatter:e=>`${e} 筆`}},stroke:{show:!1}}),[]);return e&&(0!==e.withParking.count||0!==e.withoutParking.count)?(0,l.jsx)(tc,{type:"donut",series:t,options:r,height:350,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無車位配比資料"})}function tP({data:e}){let[t,r]=(0,o.useState)(["B1","B2","B3","B4"]),[s,n]=(0,o.useState)(null);if(!e?.parkingAnalysis)return null;let{parkingRatio:i,avgPriceByType:a,rampPlanePriceByFloor:c}=e.parkingAnalysis,d=["B1","B2","B3","B4","B5_below","Unknown"],m=c?.filter(e=>d.includes(e.floor)&&e.count>0)||[],x=(0,o.useMemo)(()=>(function(e,t){let r=[];if(e.forEach(e=>{t.includes(e.floor)&&e.rawRecords&&e.rawRecords.forEach(e=>{"number"!=typeof e.parkingPrice||isNaN(e.parkingPrice)||r.push(e.parkingPrice)})}),0===r.length)return{avgPrice:0,medianPrice:0,q3Price:0,count:0};r.sort((e,t)=>e-t);let s=r.reduce((e,t)=>e+t,0)/r.length,n=r[Math.floor(r.length/2)],i=Math.floor(.75*r.length),a=r[i]||n;return{avgPrice:s,medianPrice:n,q3Price:a,count:r.length}})(m,t),[m,t]),u=(0,o.useCallback)(e=>{r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),h=(0,o.useCallback)(()=>{t.length===d.length?r([]):r([...d])},[t.length]),p={B1:"#06b6d4",B2:"#3b82f6",B3:"#6366f1",B4:"#8b5cf6",B5_below:"#a855f7",Unknown:"#71717a"};return(0,l.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsx)(tl,{title:"房車配比分析",description:"建案有購置車位的比例",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[(0,l.jsx)("div",{className:"w-full md:w-1/2",children:(0,l.jsx)(tz,{data:i})}),(0,l.jsx)("div",{className:"w-full md:w-1/2 space-y-4",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/50 text-zinc-500",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-2 text-left",children:"類型"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"筆數"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"佔比"})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-white/5",children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-2",children:"有搭車位"}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-300",children:i?.withParking?.count.toLocaleString()}),(0,l.jsxs)("td",{className:"p-2 text-right font-mono text-cyan-400",children:[i?.withParking?.percentage.toFixed(2),"%"]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-2",children:"無車位"}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-300",children:i?.withoutParking?.count.toLocaleString()}),(0,l.jsxs)("td",{className:"p-2 text-right font-mono text-zinc-500",children:[i?.withoutParking?.percentage.toFixed(2),"%"]})]})]})]})})]})}),(0,l.jsx)(tl,{title:"車位類型均價",description:"各類車位成交行情",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/50 text-zinc-500",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-2 text-left",children:"類型"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"均價(萬)"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"中位數"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"總數"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:a?.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/50",children:[(0,l.jsx)("td",{className:"p-2 font-medium",children:e.type}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-cyan-400",children:Math.round(e.avgPrice).toLocaleString()}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-300",children:Math.round(e.medianPrice).toLocaleString()}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-500",children:e.count.toLocaleString()})]},e.type))})]})})]}),(0,l.jsx)(tl,{title:"坡道平面車位坪數統計",description:"坡道平面車位的面積分佈",children:(()=>{let e=[];if(m.forEach(t=>{t.rawRecords&&t.rawRecords.forEach(t=>{let r=t.parkingArea||t["車位面積(坪)"];"number"==typeof r&&r>0&&e.push(r)})}),!(e.length>0))return(0,l.jsx)("p",{className:"text-zinc-500 text-center py-4",children:"無坡道平面車位坪數資料"});{e.sort((e,t)=>e-t);let t=e.reduce((e,t)=>e+t,0)/e.length,r=e[Math.floor(e.length/2)];return(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/50 text-zinc-500",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-2 text-left",children:"統計項目"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"數值"})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-white/5",children:[(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/50",children:[(0,l.jsx)("td",{className:"p-2",children:"統計車位數"}),(0,l.jsxs)("td",{className:"p-2 text-right font-mono text-zinc-300",children:[e.length.toLocaleString()," 位"]})]}),(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/50",children:[(0,l.jsx)("td",{className:"p-2",children:"平均坪數"}),(0,l.jsxs)("td",{className:"p-2 text-right font-mono text-cyan-400",children:[t.toFixed(2)," 坪"]})]}),(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/50",children:[(0,l.jsx)("td",{className:"p-2",children:"坪數中位數"}),(0,l.jsxs)("td",{className:"p-2 text-right font-mono text-zinc-300",children:[r.toFixed(2)," 坪"]})]})]})]})}})()}),(0,l.jsx)(tl,{title:"坡道平面車位 - 樓層價差分析",description:"勾選樓層以動態更新統計數據",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,l.jsx)("div",{className:"flex flex-col-reverse gap-2 items-center justify-center p-8 bg-zinc-900/30 rounded-xl relative",children:m.map((e,r)=>{let i=t.includes(e.floor),a=s===e.floor;return(0,l.jsxs)("div",{onMouseEnter:()=>n(e.floor),onMouseLeave:()=>n(null),className:eb("w-52 h-14 rounded-lg flex items-center justify-between px-4 shadow-lg transition-all duration-200 cursor-pointer",a&&"ring-2 ring-white scale-105",!i&&"opacity-30"),style:{backgroundColor:p[e.floor]||"#4b5563"},onClick:()=>u(e.floor),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:eb("w-5 h-5 rounded border-2 flex items-center justify-center",i?"bg-white border-white":"border-white/50"),children:i&&(0,l.jsx)(eZ,{size:14,className:"text-zinc-900"})}),(0,l.jsx)("span",{className:"font-bold text-white",children:e.floor})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"font-mono text-white text-sm",children:[Math.round(e.avgPrice).toLocaleString()," 萬"]}),(0,l.jsxs)("div",{className:"text-white/70 text-xs",children:[e.count," 位"]})]})]},e.floor)})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"p-4 bg-gradient-to-r from-cyan-500/10 to-violet-500/10 border border-cyan-500/30 rounded-lg",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-cyan-400 mb-3",children:"已選樓層統計"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-zinc-500",children:"車位數"}),(0,l.jsx)("div",{className:"text-lg font-bold text-white",children:x.count.toLocaleString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-zinc-500",children:"平均單價"}),(0,l.jsxs)("div",{className:"text-lg font-bold text-cyan-400",children:[Math.round(x.avgPrice).toLocaleString()," 萬"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-zinc-500",children:"中位數"}),(0,l.jsxs)("div",{className:"text-lg font-bold text-zinc-300",children:[Math.round(x.medianPrice).toLocaleString()," 萬"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-zinc-500",children:"3/4位數"}),(0,l.jsxs)("div",{className:"text-lg font-bold text-zinc-300",children:[Math.round(x.q3Price).toLocaleString()," 萬"]})]})]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/50 text-zinc-500",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-2 text-left",children:(0,l.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.length===d.length,onChange:h,className:"form-checkbox rounded bg-zinc-800 border-zinc-600 text-cyan-500"}),(0,l.jsx)("span",{children:"全選"})]})}),(0,l.jsx)("th",{className:"p-2 text-left",children:"樓層"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"均價(萬)"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"中位數"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"最高"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"最低"}),(0,l.jsx)("th",{className:"p-2 text-right",children:"車位數"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:m.map(e=>{let r=t.includes(e.floor),i=s===e.floor;return(0,l.jsxs)("tr",{onMouseEnter:()=>n(e.floor),onMouseLeave:()=>n(null),className:eb("transition-colors cursor-pointer",i?"bg-zinc-800":"hover:bg-zinc-800/50",!r&&"opacity-50"),onClick:()=>u(e.floor),children:[(0,l.jsx)("td",{className:"p-2",children:(0,l.jsx)("input",{type:"checkbox",checked:r,onChange:()=>u(e.floor),className:"form-checkbox rounded bg-zinc-800 border-zinc-600 text-cyan-500",onClick:e=>e.stopPropagation()})}),(0,l.jsx)("td",{className:"p-2 font-medium",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p[e.floor]}}),e.floor]})}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-cyan-400",children:Math.round(e.avgPrice).toLocaleString()}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-300",children:Math.round(e.medianPrice).toLocaleString()}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-500",children:Math.round(e.maxPrice).toLocaleString()}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-500",children:Math.round(e.minPrice).toLocaleString()}),(0,l.jsx)("td",{className:"p-2 text-right font-mono text-zinc-500",children:e.count.toLocaleString()})]},e.floor)})})]})})]})]})})]})}function tS({data:e,minPrice:t,maxPrice:r,interval:s,sizeMetric:n}){let{series:i,chartData:a}=(0,o.useMemo)(()=>{if(!e||0===e.length)return{series:[],chartData:[]};let i=[];for(let e=t;e<r;e+=s)i.push({min:e,max:Math.min(e+s,r),label:`${e}-${Math.min(e+s,r)}`,count:0,totalArea:0,avgPrice:0,transactions:[]});e.forEach(e=>{let n=e["房屋單價(萬)"],a=e["房屋面積(坪)"]||0;if("number"!=typeof n||n<t||n>=r)return;let l=Math.floor((n-t)/s);l>=0&&l<i.length&&(i[l].count++,i[l].totalArea+=a,i[l].transactions.push(e))});let a=i.filter(e=>e.count>0),l=Math.max(...a.map(e=>e.count)),o=Math.max(...a.map(e=>e.totalArea));return{series:[{name:"單價分佈",data:a.map(e=>{let t=(e.min+e.max)/2,r="count"===n?e.count:e.totalArea,s="count"===n?l:o;return{x:e.label,y:t,z:s>0?5+r/s*45:5,count:e.count,totalArea:e.totalArea,rangeLabel:e.label}})}],chartData:a}},[e,t,r,s,n]),c=(0,o.useMemo)(()=>({chart:{type:"bubble",height:450,toolbar:{show:!0},zoom:{enabled:!1}},dataLabels:{enabled:!0,style:{colors:["#fff"],fontWeight:600},formatter:(e,{seriesIndex:t,dataPointIndex:r,w:s})=>{let i=s.config.series[t].data[r];return"count"===n?i.count:Math.round(i.totalArea)}},fill:{opacity:.7,type:"gradient",gradient:{shade:"dark",type:"diagonal1",gradientToColors:["#8b5cf6"],inverseColors:!1,opacityFrom:.85,opacityTo:.5}},xaxis:{type:"category",title:{text:"單價區間 (萬/坪)",style:{color:"#9ca3af"}},labels:{rotate:-45,style:{colors:"#9ca3af"}}},yaxis:{title:{text:"平均單價點 (萬/坪)",style:{color:"#9ca3af"}},labels:{style:{colors:"#9ca3af"},formatter:e=>e.toFixed(0)},min:t-s,max:r+s},tooltip:{theme:"dark",custom:function({seriesIndex:e,dataPointIndex:t,w:r}){let s=r.config.series[e].data[t],i="count"===n?"成交件數":"總坪數",a="count"===n?s.count.toLocaleString()+" 筆":s.totalArea.toFixed(2)+" 坪";return`
                        <div style="background: #1f2937; border: 1px solid #374151; padding: 10px; border-radius: 8px;">
                            <div style="font-weight: 600; color: #06b6d4; margin-bottom: 6px;">單價區間：${s.x} 萬/坪</div>
                            <div style="color: #e5e7eb;">成交件數：${s.count.toLocaleString()} 筆</div>
                            <div style="color: #e5e7eb;">總坪數：${s.totalArea.toFixed(2)} 坪</div>
                            <div style="color: #a855f7; margin-top: 4px; font-weight: 500;">${i}影響力：${a}</div>
                        </div>
                    `}},theme:{mode:"dark"},grid:{borderColor:"#374151"}}),[t,r,s,n]);return e&&0!==e.length?(0,l.jsx)(tc,{type:"bubble",series:i,options:c,height:450,className:"w-full"}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無交易資料可顯示"})}function tM({title:e,stats:t,noDataMessage:r="無資料",className:s,averageType:n="weighted"}){if(!t||0===t.count)return(0,l.jsxs)("div",{className:eb("p-6 border border-white/5 rounded-lg bg-zinc-900/30",s),children:[(0,l.jsx)("h3",{className:"text-zinc-400 font-medium mb-4",children:e}),(0,l.jsx)("p",{className:"text-zinc-500 text-center py-4",children:r})]});let i="weighted"===n&&t.weightedAvgPrice?t.weightedAvgPrice:t.avgPrice;return(0,l.jsxs)("div",{className:eb("p-6 border border-white/5 rounded-lg bg-zinc-900/30",s),children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:e}),(0,l.jsxs)("span",{className:"text-xs text-zinc-500 bg-zinc-800 px-2 py-1 rounded",children:["樣本數: ",t.count]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,l.jsx)("div",{className:"space-y-1",children:(0,l.jsx)("table",{className:"w-full text-sm",children:(0,l.jsxs)("tbody",{className:"divide-y divide-white/5",children:[(0,l.jsxs)("tr",{className:"group",children:[(0,l.jsx)("td",{className:"py-2 text-zinc-400",children:"weighted"===n?"加權平均單價":"算術平均單價"}),(0,l.jsxs)("td",{className:"py-2 text-right font-mono text-white group-hover:text-cyan-400 transition-colors",children:[ey(i)," 萬/坪"]})]}),(0,l.jsxs)("tr",{className:"group",children:[(0,l.jsx)("td",{className:"py-2 text-zinc-400",children:"最低單價"}),(0,l.jsx)("td",{className:"py-2 text-right font-mono text-zinc-300 group-hover:text-white transition-colors",children:ey(t.minPrice)})]}),(0,l.jsxs)("tr",{className:"group",children:[(0,l.jsx)("td",{className:"py-2 text-zinc-400",children:"1/4分位數"}),(0,l.jsx)("td",{className:"py-2 text-right font-mono text-zinc-300 group-hover:text-white transition-colors",children:ey(t.q1Price)})]}),(0,l.jsxs)("tr",{className:"group",children:[(0,l.jsx)("td",{className:"py-2 text-violet-400 font-medium",children:"中位數單價"}),(0,l.jsx)("td",{className:"py-2 text-right font-mono text-violet-400 font-bold",children:ey(t.medianPrice)})]}),(0,l.jsxs)("tr",{className:"group",children:[(0,l.jsx)("td",{className:"py-2 text-zinc-400",children:"3/4分位數"}),(0,l.jsx)("td",{className:"py-2 text-right font-mono text-zinc-300 group-hover:text-white transition-colors",children:ey(t.q3Price)})]}),(0,l.jsxs)("tr",{className:"group",children:[(0,l.jsx)("td",{className:"py-2 text-zinc-400",children:"最高單價"}),(0,l.jsx)("td",{className:"py-2 text-right font-mono text-zinc-300 group-hover:text-white transition-colors",children:ey(t.maxPrice)})]})]})})}),(0,l.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,l.jsxs)("div",{className:"p-3 bg-zinc-950/50 rounded border border-white/5",children:[(0,l.jsx)("div",{className:"text-cyan-500 font-medium mb-1 text-xs uppercase tracking-wider",children:"最高價建案"}),(0,l.jsx)("div",{className:"text-white font-bold text-lg mb-1",children:t.maxPriceProject||"N/A"}),(0,l.jsxs)("div",{className:"flex gap-4 text-zinc-400 text-xs",children:[(0,l.jsxs)("span",{children:["戶型: ",t.maxPriceUnit||"-"]}),(0,l.jsxs)("span",{children:["樓層: ",t.maxPriceFloor||"-"]})]})]}),(0,l.jsxs)("div",{className:"p-3 bg-zinc-950/50 rounded border border-white/5",children:[(0,l.jsx)("div",{className:"text-green-500 font-medium mb-1 text-xs uppercase tracking-wider",children:"最低價建案"}),(0,l.jsx)("div",{className:"text-white font-bold text-lg mb-1",children:t.minPriceProject||"N/A"}),(0,l.jsxs)("div",{className:"flex gap-4 text-zinc-400 text-xs",children:[(0,l.jsxs)("span",{children:["戶型: ",t.minPriceUnit||"-"]}),(0,l.jsxs)("span",{children:["樓層: ",t.minPriceFloor||"-"]})]})]})]})]})]})}function tC({data:e}){if(!e||0===e.length)return(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無符合條件的建案可進行類型比較"});let t=Math.max(...e.map(e=>e.shopMultiple),1),r=Math.max(...e.map(e=>e.officeMultiple),1);return(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,l.jsx)("thead",{className:"bg-zinc-900/80 text-zinc-400 font-semibold uppercase text-xs",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"建案名稱"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right",children:"住宅均價"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right",children:"店舖均價"}),(0,l.jsx)("th",{className:"px-4 py-3 w-[200px]",children:"店舖倍數"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right",children:"事務所均價"}),(0,l.jsx)("th",{className:"px-4 py-3 w-[200px]",children:"事務所倍數"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-white/5",children:e.map((e,s)=>(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/30 transition-colors",children:[(0,l.jsxs)("td",{className:"px-4 py-3",children:[(0,l.jsx)("div",{className:"font-medium text-white",children:e.projectName}),(0,l.jsxs)("div",{className:"text-xs text-zinc-500 flex gap-1 mt-0.5",children:[e.county&&(0,l.jsx)("span",{className:"bg-zinc-800 px-1 rounded",children:e.county}),e.district&&(0,l.jsx)("span",{className:"bg-zinc-800 px-1 rounded",children:e.district})]})]}),(0,l.jsx)("td",{className:"px-4 py-3 text-right font-mono text-zinc-300",children:e.residentialAvg>0?ey(e.residentialAvg):"-"}),(0,l.jsx)("td",{className:"px-4 py-3 text-right font-mono text-zinc-300",children:e.shopAvg>0?ey(e.shopAvg):"-"}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.shopMultiple>0?(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("div",{className:"flex justify-between text-xs mb-0.5",children:(0,l.jsxs)("span",{className:"font-bold text-violet-400",children:[e.shopMultiple.toFixed(2),"x"]})}),(0,l.jsx)("div",{className:"h-1.5 bg-zinc-800 rounded-full overflow-hidden w-full",children:(0,l.jsx)("div",{className:"h-full bg-violet-600 rounded-full",style:{width:`${Math.min(e.shopMultiple/t*100,100)}%`}})})]}):(0,l.jsx)("span",{className:"text-zinc-600",children:"-"})}),(0,l.jsx)("td",{className:"px-4 py-3 text-right font-mono text-zinc-300",children:e.officeAvg>0?ey(e.officeAvg):"-"}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.officeMultiple>0?(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("div",{className:"flex justify-between text-xs mb-0.5",children:(0,l.jsxs)("span",{className:"font-bold text-cyan-400",children:[e.officeMultiple.toFixed(2),"x"]})}),(0,l.jsx)("div",{className:"h-1.5 bg-zinc-800 rounded-full overflow-hidden w-full",children:(0,l.jsx)("div",{className:"h-full bg-cyan-600 rounded-full",style:{width:`${Math.min(e.officeMultiple/r*100,100)}%`}})})]}):(0,l.jsx)("span",{className:"text-zinc-600",children:"-"})})]},s))})]})})}function tA({data:e}){let[t,r]=(0,o.useState)("weighted"),[s,n]=(0,o.useState)(30),[i,a]=(0,o.useState)(150),[c,d]=(0,o.useState)(5),[m,x]=(0,o.useState)("count"),u=e?.transactionDetails||[],h=e?.unitPriceAnalysis,p=h?.residentialStats,f=h?.officeStats,g=h?.storeStats,b=h?.typeComparison;return e&&(u.length||h)?(0,l.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-white pl-2 border-l-4 border-violet-500",children:"各用途單價統計"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-zinc-400 text-sm",children:"平均類型:"}),(0,l.jsxs)("div",{className:"flex bg-zinc-950/50 rounded-md p-1 border border-white/5",children:[(0,l.jsx)("button",{onClick:()=>r("arithmetic"),className:eb("px-3 py-1 text-xs rounded transition-colors","arithmetic"===t?"bg-violet-500 text-white":"text-zinc-400 hover:text-white"),children:"算術平均"}),(0,l.jsx)("button",{onClick:()=>r("weighted"),className:eb("px-3 py-1 text-xs rounded transition-colors","weighted"===t?"bg-violet-500 text-white":"text-zinc-400 hover:text-white"),children:"加權平均"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[(0,l.jsx)(tM,{title:"住宅建案統計",stats:p,noDataMessage:"無住宅交易數據",className:"border-violet-500/20",averageType:t}),(0,l.jsx)(tM,{title:"一般事務所/辦公室統計",stats:f,noDataMessage:"無事務所/辦公室交易數據",className:"border-cyan-500/20",averageType:t}),(0,l.jsx)(tM,{title:"店舖統計",stats:g,noDataMessage:"無店舖交易數據",className:"border-amber-500/20 xl:col-span-2",averageType:t})]})]}),b&&b.length>0&&(0,l.jsx)(tl,{title:"建案產品類型單價比較",description:"同一建案內不同用途（住宅/店面/事務所）的單價與倍數比較",children:(0,l.jsx)(tC,{data:b})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-white pl-2 border-l-4 border-violet-500",children:"單價分佈分析"}),(0,l.jsxs)("div",{className:"p-4 bg-zinc-900/30 border border-white/5 rounded-lg flex flex-wrap gap-4 items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-zinc-400 text-sm",children:"單價範圍:"}),(0,l.jsx)(eU,{type:"number",value:s,onChange:e=>n(Number(e.target.value)),className:"w-20 h-8 text-xs bg-zinc-950/50"}),(0,l.jsx)("span",{className:"text-zinc-500",children:"-"}),(0,l.jsx)(eU,{type:"number",value:i,onChange:e=>a(Number(e.target.value)),className:"w-20 h-8 text-xs bg-zinc-950/50"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-zinc-400 text-sm",children:"級距:"}),(0,l.jsx)(eU,{type:"number",value:c,onChange:e=>d(Number(e.target.value)),className:"w-16 h-8 text-xs bg-zinc-950/50"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-zinc-400 text-sm",children:"氣泡大小依據:"}),(0,l.jsxs)("div",{className:"flex bg-zinc-950/50 rounded-md p-1 border border-white/5",children:[(0,l.jsx)("button",{onClick:()=>x("count"),className:eb("px-3 py-1 text-xs rounded transition-colors","count"===m?"bg-violet-500 text-white":"text-zinc-400 hover:text-white"),children:"成交筆數"}),(0,l.jsx)("button",{onClick:()=>x("area"),className:eb("px-3 py-1 text-xs rounded transition-colors","area"===m?"bg-violet-500 text-white":"text-zinc-400 hover:text-white"),children:"總銷坪數"})]})]})]}),(0,l.jsx)(tl,{title:"單價分佈泡泡圖",description:"分析各單價區間的成交熱度與分佈密集區",children:(0,l.jsx)(tS,{data:u,minPrice:s,maxPrice:i,interval:c,sizeMetric:m})})]})]}):null}let tR=(0,ej.default)("store",[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]]),tF=(0,ej.default)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),tE=(0,ej.default)("sprout",[["path",{d:"M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3",key:"139s4v"}],["path",{d:"M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4",key:"1dlkgp"}],["path",{d:"M5 21h14",key:"11awu3"}]]),tT=(0,ej.default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),tD=(0,ej.default)("circle-parking",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9 17V7h4a3 3 0 0 1 0 6H9",key:"1dfk2c"}]]),tO=(e,t=0)=>e?.toLocaleString(void 0,{maximumFractionDigits:t});function t$({data:e,floorPremium:t=.3}){let{horizontalGrid:r,sortedFloors:s,sortedUnits:n,unitColorMap:i,summary:a,horizontalComparison:o}=e;return r&&s&&n?(0,l.jsxs)("div",{className:"space-y-8 overflow-x-auto",children:[(0,l.jsx)("div",{className:"min-w-max",children:(0,l.jsxs)("table",{className:"divide-y divide-zinc-800 border-collapse w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"sticky left-0 bg-dark-card z-20 p-2 text-zinc-400 border-r border-zinc-800",children:"樓層 \\ 戶別"}),n.map(e=>(0,l.jsx)("th",{className:"p-2 text-white font-medium border-l border-zinc-800/50",style:{backgroundColor:`${i[e]||"#4b5563"}80`},children:e},e))]})}),(0,l.jsx)("tbody",{className:"divide-y divide-zinc-800/50",children:s.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-zinc-800/30 transition-colors",children:[(0,l.jsx)("td",{className:"sticky left-0 bg-dark-card z-10 p-2 font-bold text-zinc-300 border-r border-zinc-800 text-center",children:e}),n.map(t=>{let s=r[e]?.[t];return s&&0!==s.length?(0,l.jsx)("td",{className:"p-1 border-l border-zinc-800/50 align-top",children:(0,l.jsx)("div",{className:"flex flex-col gap-1",children:s.map((e,t)=>{var r;let s=(r=e.premium,e.isStorefront?"rgba(217, 119, 6, 0.4)":e.isOffice?"rgba(37, 99, 235, 0.4)":null===r?"#1f2937":r<0?"rgba(139, 92, 246, 0.4)":0===r?"#06b6d4":r>5?"rgba(244, 63, 94, 0.5)":r>2?"rgba(234, 179, 8, 0.4)":"rgba(34, 197, 94, 0.3)"),n=e.isStorefront?{icon:(0,l.jsx)(tR,{className:"w-3 h-3"}),label:"店舖"}:e.isOffice?{icon:(0,l.jsx)(tF,{className:"w-3 h-3"}),label:"辦公"}:e.remark?.includes("露台")?{icon:(0,l.jsx)(tE,{className:"w-3 h-3"}),label:"露台"}:e.remark?.includes("親友")||e.remark?.includes("員工")?{icon:(0,l.jsx)(tT,{className:"w-3 h-3"}),label:"親友"}:null,i=0===e.premium;return(0,l.jsxs)("div",{className:eb("p-1.5 rounded text-xs transition-transform hover:scale-105 cursor-default relative group",i&&"ring-1 ring-cyan-500"),style:{backgroundColor:s},children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,l.jsxs)("span",{className:"font-semibold text-white flex items-center gap-1",children:[n&&(0,l.jsx)("span",{className:"text-zinc-200",title:n.label,children:n.icon}),e.unitPrice.toFixed(1),"萬"]}),e.hasParking&&(0,l.jsx)(tD,{className:"w-3 h-3 text-zinc-400"})]}),(0,l.jsx)("div",{className:"text-[10px] text-zinc-300/80 mt-0.5",children:e.transactionDate}),(0,l.jsx)("div",{className:"absolute z-50 hidden group-hover:block w-48 bg-zinc-900 border border-zinc-700 rounded-lg p-3 shadow-xl -translate-y-full -translate-x-1/2 left-1/2 top-[-8px]",children:(0,l.jsxs)("div",{className:"space-y-1",children:[i&&(0,l.jsx)("div",{className:"text-cyan-400 font-bold mb-1",children:"★ 基準戶"}),null!==e.premium&&(0,l.jsxs)("div",{className:"text-zinc-300",children:["調價: ",(0,l.jsxs)("span",{className:eb(e.premium>0?"text-red-400":e.premium<0?"text-violet-400":"text-zinc-400"),children:[e.premium>0?"+":"",e.premium.toFixed(2),"%"]})]}),(0,l.jsx)("div",{className:"h-px bg-zinc-700 my-2"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1 text-xs text-zinc-400",children:[(0,l.jsx)("span",{children:"成交總價:"})," ",(0,l.jsxs)("span",{className:"text-white text-right",children:[tO(e.tooltipInfo.totalPrice),"萬"]}),(0,l.jsx)("span",{children:"房屋總價:"})," ",(0,l.jsxs)("span",{className:"text-white text-right",children:[tO(e.tooltipInfo.housePrice),"萬"]}),(0,l.jsx)("span",{children:"車位總價:"})," ",(0,l.jsxs)("span",{className:"text-white text-right",children:[tO(e.tooltipInfo.parkingPrice),"萬"]}),(0,l.jsx)("span",{children:"房屋坪數:"})," ",(0,l.jsxs)("span",{className:"text-white text-right",children:[tO(e.tooltipInfo.houseArea,2),"坪"]})]})]})})]},t)})})},`${e}-${t}`):(0,l.jsx)("td",{className:"p-2 border-l border-zinc-800/50 bg-zinc-900/20 text-center text-zinc-600",children:"-"},`${e}-${t}`)})]},e))})]})}),a&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-zinc-200",children:"調價幅度統計摘要 (排除店舖/辦公室)"}),(0,l.jsx)("div",{className:"overflow-x-auto rounded-lg border border-zinc-800",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left text-zinc-300",children:[(0,l.jsx)("thead",{className:"text-xs text-zinc-400 uppercase bg-zinc-900/50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3",children:"基準房屋總價"}),(0,l.jsx)("th",{className:"px-6 py-3",children:"調價幅度總額"}),(0,l.jsx)("th",{className:"px-6 py-3",children:"總溢價率"}),(0,l.jsx)("th",{className:"px-6 py-3",children:"已售房屋坪數"}),(0,l.jsx)("th",{className:"px-6 py-3",children:"平均單價調價"})]})}),(0,l.jsx)("tbody",{children:(0,l.jsxs)("tr",{className:"bg-zinc-900/20 border-b border-zinc-800",children:[(0,l.jsxs)("td",{className:"px-6 py-4",children:[tO(a.totalBaselineHousePrice)," 萬"]}),(0,l.jsxs)("td",{className:eb("px-6 py-4 font-bold",a.totalPricePremiumValue>0?"text-red-400":"text-violet-400"),children:[a.totalPricePremiumValue>0?"+":"",tO(a.totalPricePremiumValue)," 萬"]}),(0,l.jsxs)("td",{className:"px-6 py-4",children:[(a.totalPricePremiumValue/a.totalBaselineHousePrice*100).toFixed(2)," %"]}),(0,l.jsxs)("td",{className:"px-6 py-4",children:[tO(a.totalSoldArea)," 坪"]}),(0,l.jsxs)("td",{className:eb("px-6 py-4",a.totalPricePremiumValue>0?"text-red-400":"text-violet-400"),children:[(a.totalPricePremiumValue/a.totalSoldArea).toFixed(2)," 萬/坪"]})]})})]})})]}),o&&o.length>0&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold text-zinc-200",children:["戶型水平價差與溢價貢獻 (基準樓層: F",e.refFloorForComparison||"N/A",")"]}),(0,l.jsx)("div",{className:"overflow-x-auto rounded-lg border border-zinc-800",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left text-zinc-300",children:[(0,l.jsx)("thead",{className:"text-xs text-zinc-400 uppercase bg-zinc-900/50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"戶型"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"基準戶 (樓/價)"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"水平價差(萬/坪)"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"去化戶數"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"溢價貢獻"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"貢獻佔比"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"基準房屋總價"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"平均單價調價"})]})}),(0,l.jsx)("tbody",{children:o.map((e,t)=>(0,l.jsxs)("tr",{className:"bg-zinc-900/20 border-b border-zinc-800 hover:bg-zinc-800/20",children:[(0,l.jsx)("td",{className:"px-4 py-3 font-medium text-white",children:e.unitType}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.anchorInfo}),(0,l.jsx)("td",{className:eb("px-4 py-3",(e.horizontalPriceDiff||0)>0?"text-red-400":"text-zinc-400"),children:"number"==typeof e.horizontalPriceDiff?`${e.horizontalPriceDiff>0?"+":""}${e.horizontalPriceDiff.toFixed(2)} 萬/坪`:"-"}),(0,l.jsxs)("td",{className:"px-4 py-3",children:[e.unitsSold," 戶"]}),(0,l.jsxs)("td",{className:eb("px-4 py-3 font-bold",e.timePremiumContribution>0?"text-red-400":"text-violet-400"),children:[e.timePremiumContribution>0?"+":"",tO(e.timePremiumContribution)," 萬"]}),(0,l.jsxs)("td",{className:"px-4 py-3",children:["number"==typeof e.contributionPercentage?e.contributionPercentage.toFixed(2):"0.00","%"]}),(0,l.jsxs)("td",{className:"px-4 py-3",children:[tO(e.baselineHousePrice)," 萬"]}),(0,l.jsxs)("td",{className:"px-4 py-3",children:["number"==typeof e.avgPriceAdjustment?e.avgPriceAdjustment.toFixed(2):"-"," 萬/坪"]})]},t))})]})})]})]}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-8",children:"無有效熱力圖資料"})}let tL=(0,ej.default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),tI=(0,ej.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function t_({data:e}){let[t,r]=(0,o.useState)(""),[s,n]=(0,o.useState)(.3),[i,a]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{e?.priceGridAnalysis?.projectNames?.length&&!t&&r(e.priceGridAnalysis.projectNames[0])},[e,t]),!e?.priceGridAnalysis)return null;let{projectNames:c,byProject:d}=e.priceGridAnalysis,m=o.default.useMemo(()=>{if(!t)return null;if(d[t]&&d[t].horizontalGrid)return d[t];if(e.transactionDetails){let r=e.transactionDetails.filter(e=>e["建案名稱"]===t);if(r.length>0)try{return function(e,t=.3){let r={},s=new Set,n=new Set;if(e.forEach(e=>{let t=e["樓層"]||e.floor||e.layer;if(null==t)return;"number"==typeof t&&(t=String(t));let i=e["戶別"]||e["戶型"]||e.unit||"?";s.add(t),n.add(i),r[t]||(r[t]={}),r[t][i]||(r[t][i]=[]);let a=parseFloat(e["房屋單價(萬)"]||e.unitPrice||0),l=parseFloat(e["交易總價(萬)"]||e.totalPrice||0),o=parseFloat(e["房屋總價(萬)"]||e.housePrice||0),c=parseFloat(e["車位總價(萬)"]||e.parkingPrice||0),d=parseFloat(e["房屋面積(坪)"]||e.houseArea||0),m=e["房數"]||e.rooms,x=e["車位類別"]||e.parkingType||"";"string"==typeof x&&x.includes("車位");let u=e["主要用途"]||e.mainPurpose||"",h=e["建物型態"]||e.buildingType||"",p=u.includes("商業")||h.includes("店")||u.includes("店"),f=u.includes("辦公")||h.includes("辦公")||h.includes("事務所");r[t][i].push({...e,unitPrice:a,floor:t,unit:i,isStorefront:p,isOffice:f,hasParking:c>0,tooltipInfo:{totalPrice:l,housePrice:o,parkingPrice:c,houseArea:d,rooms:m}})}),0===s.size)return{horizontalGrid:{},sortedFloors:[],sortedUnits:[],unitColorMap:{},summary:{totalBaselineHousePrice:0,totalPricePremiumValue:0,totalSoldArea:0,transactionCount:0},horizontalComparison:[]};let i=Array.from(s).sort((e,t)=>{let r=e=>e?e.startsWith("B")?-parseInt(e.substring(1)):parseInt(e)||0:0;return r(t)-r(e)}),a=Array.from(n).sort(),l=1/0,o=null;e.forEach(e=>{let t=e["主要用途"]||e.mainPurpose||"",r=e["建物型態"]||e.buildingType||"",s=e["備註"]||e.note||"",n=parseFloat(e["房屋單價(萬)"]||e.unitPrice||0);!(t.includes("商業")||r.includes("店")||s.includes("特殊")||s.includes("親友"))&&n<l&&n>0&&(l=n,o=e)});let c=0,d=0,m=0,x=0;Object.keys(r).forEach(e=>{Object.keys(r[e]).forEach(s=>{r[e][s].forEach((n,i)=>{let a=null;if(o){let e=e=>e.startsWith("B")?-parseInt(e.substring(1)):parseInt(e),r=e(o["樓層"].toString()),s=e(n.floor),i=o["房屋單價(萬)"]*(1+(s-r)*t/100);if(i>0&&(a=(n["房屋單價(萬)"]-i)/i*100,(n===o||.1>Math.abs(n["房屋單價(萬)"]-i))&&(a=0)),n.tooltipInfo.housePrice&&n.tooltipInfo.houseArea){let e=i*n.tooltipInfo.houseArea;c+=e,d+=n.tooltipInfo.housePrice-e,m+=n.tooltipInfo.houseArea,x++}}r[e][s][i].premium=a})})});let u={},h=["#f87171","#fb923c","#fbbf24","#a3e635","#34d399","#22d3ee","#818cf8","#c084fc","#f472b6"];return a.forEach((e,t)=>{u[e]=h[t%h.length]}),{horizontalGrid:r,sortedFloors:i,sortedUnits:a,unitColorMap:u,summary:{totalBaselineHousePrice:c,totalPricePremiumValue:d,totalSoldArea:m,transactionCount:x},horizontalComparison:[],refFloorForComparison:o?o["樓層"]:"-"}}(r,s)}catch(e){console.error("Heatmap generation error:",e)}}return null},[t,d,e.transactionDetails,s]);return(0,l.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4 bg-zinc-900/30 p-4 rounded-lg border border-white/5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-sm text-zinc-400",children:"選擇建案:"}),(0,l.jsx)(e1,{value:t,onChange:e=>r(e.target.value),className:"w-[280px] bg-zinc-950/50",children:c.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-sm text-zinc-400",children:"樓層價差:"}),(0,l.jsx)("input",{type:"range",min:0,max:2,step:.1,value:s,onChange:e=>n(Number(e.target.value)),className:"w-28 accent-violet-500"}),(0,l.jsxs)("span",{className:"text-sm font-mono text-violet-400 w-12",children:[s.toFixed(1),"%"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,l.jsxs)(eB,{variant:"outline",size:"sm",onClick:()=>{console.log(`Re-analyzing ${t} with floor premium: ${s}%`)},className:"border-violet-500/30 text-violet-400 hover:bg-violet-500/10",children:[(0,l.jsx)(tL,{className:"mr-2 h-4 w-4"}),"重新分析"]}),(0,l.jsxs)(eB,{variant:"outline",size:"sm",onClick:()=>{a(!0);let e=`${window.location.origin}?project=${encodeURIComponent(t)}&floorPremium=${s}`;navigator.clipboard.writeText(e).then(()=>{setTimeout(()=>a(!1),2e3)})},className:"border-cyan-500/30 text-cyan-400 hover:bg-cyan-500/10",children:[(0,l.jsx)(tI,{className:"mr-2 h-4 w-4"}),i?"已複製!":"分享連結"]})]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 p-4 bg-zinc-900/20 rounded-lg border border-white/5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-xs text-zinc-500",children:"溢價圖例:"}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-red-500/80"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"> 5%"})]}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-orange-500/80"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"2-5%"})]}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-yellow-500/80"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"0-2%"})]}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-green-500/80"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"< 0%"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,l.jsx)("span",{className:"text-xs text-zinc-500",children:"特殊交易:"}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-amber-600"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"店舖"})]}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-blue-600"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"辦公室"})]}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-4 h-4 rounded bg-purple-600"}),(0,l.jsx)("span",{className:"text-xs text-zinc-400",children:"廠辦"})]})]})]}),(0,l.jsx)(tl,{title:"建案銷控表與調價熱力圖",description:"可視化建案各戶別的銷售狀況與價格調整幅度",children:m?(0,l.jsx)(t$,{data:m,floorPremium:s}):(0,l.jsx)("div",{className:"text-zinc-500 text-center p-12",children:"請選擇建案以查看銷控表"})})]})}let tq=(0,ej.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),tV=(0,ej.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function tB(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),!1===r||!s.defaultPrevented)return t?.(s)}}function tU(e,t=[]){let r=[],s=()=>{let t=r.map(e=>o.createContext(e));return function(r){let s=r?.[e]||t;return o.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return s.scopeName=e,[function(t,s){let n=o.createContext(s),i=r.length;r=[...r,s];let a=t=>{let{scope:r,children:s,...a}=t,c=r?.[e]?.[i]||n,d=o.useMemo(()=>a,Object.values(a));return(0,l.jsx)(c.Provider,{value:d,children:s})};return a.displayName=t+"Provider",[a,function(r,a){let l=a?.[e]?.[i]||n,c=o.useContext(l);if(c)return c;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let n=r(e)[`__scope${s}`];return{...t,...n}},{});return o.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(s,...t)]}function tW(e){var t;let r,s=(t=e,(r=o.forwardRef((e,t)=>{let{children:r,...s}=e;if(o.isValidElement(r)){var n;let e,i,a=(n=r,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),l=function(e,t){let r={...t};for(let s in t){let n=e[s],i=t[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...e)=>{let t=i(...e);return n(...e),t}:n&&(r[s]=n):"style"===s?r[s]={...n,...i}:"className"===s&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==o.Fragment&&(l.ref=t?eE(t,a):a),o.cloneElement(r,l)}return o.Children.count(r)>1?o.Children.only(null):null})).displayName=`${t}.SlotClone`,r),n=o.forwardRef((e,t)=>{let{children:r,...n}=e,i=o.Children.toArray(r),a=i.find(tH);if(a){let e=a.props.children,r=i.map(t=>t!==a?t:o.Children.count(e)>1?o.Children.only(null):o.isValidElement(e)?e.props.children:null);return(0,l.jsx)(s,{...n,ref:t,children:o.isValidElement(e)?o.cloneElement(e,void 0,r):null})}return(0,l.jsx)(s,{...n,ref:t,children:r})});return n.displayName=`${e}.Slot`,n}"u">typeof window&&window.document&&window.document.createElement;var tG=Symbol("radix.slottable");function tH(e){return o.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===tG}var tK=new WeakMap;function tY(e,t){var r,s;let n,i,a;if("at"in Array.prototype)return Array.prototype.at.call(e,t);let l=(r=e,s=t,n=r.length,(a=(i=tJ(s))>=0?i:n+i)<0||a>=n?-1:a);return -1===l?void 0:e[l]}function tJ(e){return e!=e||0===e?0:Math.trunc(e)}(class e extends Map{#e;constructor(e){super(e),this.#e=[...super.keys()],tK.set(this,!0)}set(e,t){return tK.get(this)&&(this.has(e)?this.#e[this.#e.indexOf(e)]=e:this.#e.push(e)),super.set(e,t),this}insert(e,t,r){let s,n=this.has(t),i=this.#e.length,a=tJ(e),l=a>=0?a:i+a,o=l<0||l>=i?-1:l;if(o===this.size||n&&o===this.size-1||-1===o)return this.set(t,r),this;let c=this.size+ +!n;a<0&&l++;let d=[...this.#e],m=!1;for(let e=l;e<c;e++)if(l===e){let i=d[e];d[e]===t&&(i=d[e+1]),n&&this.delete(t),s=this.get(i),this.set(t,r)}else{m||d[e-1]!==t||(m=!0);let r=d[m?e:e-1],n=s;s=this.get(r),this.delete(r),this.set(r,n)}return this}with(t,r,s){let n=new e(this);return n.insert(t,r,s),n}before(e){let t=this.#e.indexOf(e)-1;if(!(t<0))return this.entryAt(t)}setBefore(e,t,r){let s=this.#e.indexOf(e);return -1===s?this:this.insert(s,t,r)}after(e){let t=this.#e.indexOf(e);if(-1!==(t=-1===t||t===this.size-1?-1:t+1))return this.entryAt(t)}setAfter(e,t,r){let s=this.#e.indexOf(e);return -1===s?this:this.insert(s+1,t,r)}first(){return this.entryAt(0)}last(){return this.entryAt(-1)}clear(){return this.#e=[],super.clear()}delete(e){let t=super.delete(e);return t&&this.#e.splice(this.#e.indexOf(e),1),t}deleteAt(e){let t=this.keyAt(e);return void 0!==t&&this.delete(t)}at(e){let t=tY(this.#e,e);if(void 0!==t)return this.get(t)}entryAt(e){let t=tY(this.#e,e);if(void 0!==t)return[t,this.get(t)]}indexOf(e){return this.#e.indexOf(e)}keyAt(e){return tY(this.#e,e)}from(e,t){let r=this.indexOf(e);if(-1===r)return;let s=r+t;return s<0&&(s=0),s>=this.size&&(s=this.size-1),this.at(s)}keyFrom(e,t){let r=this.indexOf(e);if(-1===r)return;let s=r+t;return s<0&&(s=0),s>=this.size&&(s=this.size-1),this.keyAt(s)}find(e,t){let r=0;for(let s of this){if(Reflect.apply(e,t,[s,r,this]))return s;r++}}findIndex(e,t){let r=0;for(let s of this){if(Reflect.apply(e,t,[s,r,this]))return r;r++}return -1}filter(t,r){let s=[],n=0;for(let e of this)Reflect.apply(t,r,[e,n,this])&&s.push(e),n++;return new e(s)}map(t,r){let s=[],n=0;for(let e of this)s.push([e[0],Reflect.apply(t,r,[e,n,this])]),n++;return new e(s)}reduce(...e){let[t,r]=e,s=0,n=r??this.at(0);for(let r of this)n=0===s&&1===e.length?r:Reflect.apply(t,this,[n,r,s,this]),s++;return n}reduceRight(...e){let[t,r]=e,s=r??this.at(-1);for(let r=this.size-1;r>=0;r--){let n=this.at(r);s=r===this.size-1&&1===e.length?n:Reflect.apply(t,this,[s,n,r,this])}return s}toSorted(t){return new e([...this.entries()].sort(t))}toReversed(){let t=new e;for(let e=this.size-1;e>=0;e--){let r=this.keyAt(e),s=this.get(r);t.set(r,s)}return t}toSpliced(...t){let r=[...this.entries()];return r.splice(...t),new e(r)}slice(t,r){let s=new e,n=this.size-1;if(void 0===t)return s;t<0&&(t+=this.size),void 0!==r&&r>0&&(n=r-1);for(let e=t;e<=n;e++){let t=this.keyAt(e),r=this.get(t);s.set(t,r)}return s}every(e,t){let r=0;for(let s of this){if(!Reflect.apply(e,t,[s,r,this]))return!1;r++}return!0}some(e,t){let r=0;for(let s of this){if(Reflect.apply(e,t,[s,r,this]))return!0;r++}return!1}});var tX=globalThis?.document?o.useLayoutEffect:()=>{},tZ=o[" useId ".trim().toString()]||(()=>void 0),tQ=0;function t0(e){let[t,r]=o.useState(tZ());return tX(()=>{e||r(e=>e??String(tQ++))},[e]),e||(t?`radix-${t}`:"")}e.i(1801);var t1=Symbol("radix.slottable");function t2(e){return o.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===t1}var t4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{var r,s;let n,i,a,c=(s=r=`Primitive.${t}`,(n=o.forwardRef((e,t)=>{let{children:r,...s}=e;if(o.isValidElement(r)){var n;let e,i,a=(n=r,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),l=function(e,t){let r={...t};for(let s in t){let n=e[s],i=t[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...e)=>{let t=i(...e);return n(...e),t}:n&&(r[s]=n):"style"===s?r[s]={...n,...i}:"className"===s&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==o.Fragment&&(l.ref=t?eE(t,a):a),o.cloneElement(r,l)}return o.Children.count(r)>1?o.Children.only(null):null})).displayName=`${s}.SlotClone`,i=n,(a=o.forwardRef((e,t)=>{let{children:r,...s}=e,n=o.Children.toArray(r),a=n.find(t2);if(a){let e=a.props.children,r=n.map(t=>t!==a?t:o.Children.count(e)>1?o.Children.only(null):o.isValidElement(e)?e.props.children:null);return(0,l.jsx)(i,{...s,ref:t,children:o.isValidElement(e)?o.cloneElement(e,void 0,r):null})}return(0,l.jsx)(i,{...s,ref:t,children:r})})).displayName=`${r}.Slot`,a),d=o.forwardRef((e,r)=>{let{asChild:s,...n}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(s?c:t,{...n,ref:r})});return d.displayName=`Primitive.${t}`,{...e,[t]:d}},{});o[" useEffectEvent ".trim().toString()],o[" useInsertionEffect ".trim().toString()];var t5=o[" useInsertionEffect ".trim().toString()]||tX;function t3({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){let[n,i,a]=function({defaultProp:e,onChange:t}){let[r,s]=o.useState(e),n=o.useRef(r),i=o.useRef(t);return t5(()=>{i.current=t},[t]),o.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,s,i]}({defaultProp:t,onChange:r}),l=void 0!==e,c=l?e:n;{let t=o.useRef(void 0!==e);o.useEffect(()=>{let e=t.current;if(e!==l){let t=l?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=l},[l,s])}return[c,o.useCallback(t=>{if(l){let r="function"==typeof t?t(e):t;r!==e&&a.current?.(r)}else i(t)},[l,e,i,a])]}Symbol("RADIX:SYNC_STATE");var t6=o.createContext(void 0);function t9(e){let t=o.useContext(t6);return e||t||"ltr"}var t8="rovingFocusGroup.onEntryFocus",t7={bubbles:!1,cancelable:!0},re="RovingFocusGroup",[rt,rr,rs]=function(e){let t=e+"CollectionProvider",[r,s]=tU(t),[n,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=e=>{let{scope:t,children:r}=e,s=o.default.useRef(null),i=o.default.useRef(new Map).current;return(0,l.jsx)(n,{scope:t,itemMap:i,collectionRef:s,children:r})};a.displayName=t;let c=e+"CollectionSlot",d=tW(c),m=o.default.forwardRef((e,t)=>{let{scope:r,children:s}=e,n=eT(t,i(c,r).collectionRef);return(0,l.jsx)(d,{ref:n,children:s})});m.displayName=c;let x=e+"CollectionItemSlot",u="data-radix-collection-item",h=tW(x),p=o.default.forwardRef((e,t)=>{let{scope:r,children:s,...n}=e,a=o.default.useRef(null),c=eT(t,a),d=i(x,r);return o.default.useEffect(()=>(d.itemMap.set(a,{ref:a,...n}),()=>void d.itemMap.delete(a))),(0,l.jsx)(h,{...{[u]:""},ref:c,children:s})});return p.displayName=x,[{Provider:a,Slot:m,ItemSlot:p},function(t){let r=i(e+"CollectionConsumer",t);return o.default.useCallback(()=>{let e=r.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${u}]`));return Array.from(r.itemMap.values()).sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current))},[r.collectionRef,r.itemMap])},s]}(re),[rn,ri]=tU(re,[rs]),[ra,rl]=rn(re),ro=o.forwardRef((e,t)=>(0,l.jsx)(rt.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,l.jsx)(rt.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,l.jsx)(rc,{...e,ref:t})})}));ro.displayName=re;var rc=o.forwardRef((e,t)=>{let r,{__scopeRovingFocusGroup:s,orientation:n,loop:i=!1,dir:a,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:m,onEntryFocus:x,preventScrollOnEntryFocus:u=!1,...h}=e,p=o.useRef(null),f=eT(t,p),g=t9(a),[b,y]=t3({prop:c,defaultProp:d??null,onChange:m,caller:re}),[j,v]=o.useState(!1),N=(r=o.useRef(x),o.useEffect(()=>{r.current=x}),o.useMemo(()=>(...e)=>r.current?.(...e),[])),w=rr(s),k=o.useRef(!1),[z,P]=o.useState(0);return o.useEffect(()=>{let e=p.current;if(e)return e.addEventListener(t8,N),()=>e.removeEventListener(t8,N)},[N]),(0,l.jsx)(ra,{scope:s,orientation:n,dir:g,loop:i,currentTabStopId:b,onItemFocus:o.useCallback(e=>y(e),[y]),onItemShiftTab:o.useCallback(()=>v(!0),[]),onFocusableItemAdd:o.useCallback(()=>P(e=>e+1),[]),onFocusableItemRemove:o.useCallback(()=>P(e=>e-1),[]),children:(0,l.jsx)(t4.div,{tabIndex:j||0===z?-1:0,"data-orientation":n,...h,ref:f,style:{outline:"none",...e.style},onMouseDown:tB(e.onMouseDown,()=>{k.current=!0}),onFocus:tB(e.onFocus,e=>{let t=!k.current;if(e.target===e.currentTarget&&t&&!j){let t=new CustomEvent(t8,t7);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=w().filter(e=>e.focusable);ru([e.find(e=>e.active),e.find(e=>e.id===b),...e].filter(Boolean).map(e=>e.ref.current),u)}}k.current=!1}),onBlur:tB(e.onBlur,()=>v(!1))})})}),rd="RovingFocusGroupItem",rm=o.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:s=!0,active:n=!1,tabStopId:i,children:a,...c}=e,d=t0(),m=i||d,x=rl(rd,r),u=x.currentTabStopId===m,h=rr(r),{onFocusableItemAdd:p,onFocusableItemRemove:f,currentTabStopId:g}=x;return o.useEffect(()=>{if(s)return p(),()=>f()},[s,p,f]),(0,l.jsx)(rt.ItemSlot,{scope:r,id:m,focusable:s,active:n,children:(0,l.jsx)(t4.span,{tabIndex:u?0:-1,"data-orientation":x.orientation,...c,ref:t,onMouseDown:tB(e.onMouseDown,e=>{s?x.onItemFocus(m):e.preventDefault()}),onFocus:tB(e.onFocus,()=>x.onItemFocus(m)),onKeyDown:tB(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void x.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var s;let n=(s=e.key,"rtl"!==r?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(n))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(n)))return rx[n]}(e,x.orientation,x.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let n=h().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)n.reverse();else if("prev"===t||"next"===t){var r,s;"prev"===t&&n.reverse();let i=n.indexOf(e.currentTarget);n=x.loop?(r=n,s=i+1,r.map((e,t)=>r[(s+t)%r.length])):n.slice(i+1)}setTimeout(()=>ru(n))}}),children:"function"==typeof a?a({isCurrentTabStop:u,hasTabStop:null!=g}):a})})});rm.displayName=rd;var rx={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ru(e,t=!1){let r=document.activeElement;for(let s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}var rh=e=>{var t;let r,s,{present:n,children:i}=e,a=function(e){var t,r;let[s,n]=o.useState(),i=o.useRef(null),a=o.useRef(e),l=o.useRef("none"),[c,d]=(t=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},o.useReducer((e,t)=>r[e][t]??e,t));return o.useEffect(()=>{let e=rp(i.current);l.current="mounted"===c?e:"none"},[c]),tX(()=>{let t=i.current,r=a.current;if(r!==e){let s=l.current,n=rp(t);e?d("MOUNT"):"none"===n||t?.display==="none"?d("UNMOUNT"):r&&s!==n?d("ANIMATION_OUT"):d("UNMOUNT"),a.current=e}},[e,d]),tX(()=>{if(s){let e,t=s.ownerDocument.defaultView??window,r=r=>{let n=rp(i.current).includes(CSS.escape(r.animationName));if(r.target===s&&n&&(d("ANIMATION_END"),!a.current)){let r=s.style.animationFillMode;s.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=r)})}},n=e=>{e.target===s&&(l.current=rp(i.current))};return s.addEventListener("animationstart",n),s.addEventListener("animationcancel",r),s.addEventListener("animationend",r),()=>{t.clearTimeout(e),s.removeEventListener("animationstart",n),s.removeEventListener("animationcancel",r),s.removeEventListener("animationend",r)}}d("ANIMATION_END")},[s,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:o.useCallback(e=>{i.current=e?getComputedStyle(e):null,n(e)},[])}}(n),l="function"==typeof i?i({present:a.isPresent}):o.Children.only(i),c=eT(a.ref,(t=l,(s=(r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?t.ref:(s=(r=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?t.props.ref:t.props.ref||t.ref));return"function"==typeof i||a.isPresent?o.cloneElement(l,{ref:c}):null};function rp(e){return e?.animationName||"none"}rh.displayName="Presence";var rf="Tabs",[rg,rb]=tU(rf,[ri]),ry=ri(),[rj,rv]=rg(rf),rN=o.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,onValueChange:n,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:c="automatic",...d}=e,m=t9(o),[x,u]=t3({prop:s,onChange:n,defaultProp:i??"",caller:rf});return(0,l.jsx)(rj,{scope:r,baseId:t0(),value:x,onValueChange:u,orientation:a,dir:m,activationMode:c,children:(0,l.jsx)(t4.div,{dir:m,"data-orientation":a,...d,ref:t})})});rN.displayName=rf;var rw="TabsList",rk=o.forwardRef((e,t)=>{let{__scopeTabs:r,loop:s=!0,...n}=e,i=rv(rw,r),a=ry(r);return(0,l.jsx)(ro,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:s,children:(0,l.jsx)(t4.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});rk.displayName=rw;var rz="TabsTrigger",rP=o.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,disabled:n=!1,...i}=e,a=rv(rz,r),o=ry(r),c=rC(a.baseId,s),d=rA(a.baseId,s),m=s===a.value;return(0,l.jsx)(rm,{asChild:!0,...o,focusable:!n,active:m,children:(0,l.jsx)(t4.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":d,"data-state":m?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:c,...i,ref:t,onMouseDown:tB(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():a.onValueChange(s)}),onKeyDown:tB(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&a.onValueChange(s)}),onFocus:tB(e.onFocus,()=>{let e="manual"!==a.activationMode;m||n||!e||a.onValueChange(s)})})})});rP.displayName=rz;var rS="TabsContent",rM=o.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,forceMount:n,children:i,...a}=e,c=rv(rS,r),d=rC(c.baseId,s),m=rA(c.baseId,s),x=s===c.value,u=o.useRef(x);return o.useEffect(()=>{let e=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,l.jsx)(rh,{present:n||x,children:({present:r})=>(0,l.jsx)(t4.div,{"data-state":x?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!r,id:m,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:r&&i})})});function rC(e,t){return`${e}-trigger-${t}`}function rA(e,t){return`${e}-content-${t}`}rM.displayName=rS;let rR=o.forwardRef(({className:e,...t},r)=>(0,l.jsx)(rk,{ref:r,className:eb("inline-flex h-10 items-center justify-center rounded-md bg-zinc-800 p-1 text-zinc-400",e),...t}));rR.displayName=rk.displayName;let rF=o.forwardRef(({className:e,...t},r)=>(0,l.jsx)(rP,{ref:r,className:eb("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-zinc-950 data-[state=active]:text-white data-[state=active]:shadow-sm",e),...t}));rF.displayName=rP.displayName;let rE=o.forwardRef(({className:e,...t},r)=>(0,l.jsx)(rM,{ref:r,className:eb("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));function rT(e,t){let r=(e.length-1)*t,s=Math.floor(r);return void 0!==e[s+1]?parseFloat((e[s]+(r-s)*(e[s+1]-e[s])).toFixed(2)):parseFloat(e[s].toFixed(2))}function rD(){let e=eJ(),[t,r]=(0,o.useState)(!1),[s,n]=(0,o.useState)(null),[i,a]=(0,o.useState)(null),c=(0,o.useCallback)(async()=>{r(!0),n(null),a(null);try{let l=e.counties.map(e=>e7[e]||e);if(0===l.length){n("請至少選擇一個縣市"),r(!1);return}let{dateRange:o,startDate:c,endDate:d}=e;if("custom"!==o&&(!c||!d)){let e=tn(o);e.startDate&&e.endDate&&(c=e.startDate,d=e.endDate)}let m={districts:e.districts,transactionType:e.transactionType,type:e.transactionType,projectNames:e.projectNames,buildingType:e.buildingType,excludeCommercial:e.excludeCommercial,floorPremium:e.floorPremium,dateRange:o,dateStart:c,dateEnd:d};console.log("Analyzing with counties:",l);let x=l.map(e=>{let t={...m,countyCode:e,counties:[e]};return tr(t).catch(t=>(console.error(`Failed to fetch data for ${e}:`,t),null))}),u=await Promise.all(x),h=null,p=0;for(let e of u)if(e){var t,s,i;console.log("Merging result for county:",e.projectRanking?.[0]?.county),t=h,h=e?t?(e.transactionDetails&&Array.isArray(e.transactionDetails)&&(t.transactionDetails||(t.transactionDetails=[]),t.transactionDetails=[...t.transactionDetails,...e.transactionDetails]),t.coreMetrics=function(e,t){if(!t)return e;if(!e)return t;let r=(e.totalSaleAmount||0)+(t.totalSaleAmount||0),s=(e.totalHouseArea||0)+(t.totalHouseArea||0),n=(e.transactionCount||0)+(t.transactionCount||0);return{totalSaleAmount:r,totalHouseArea:s,overallAveragePrice:s>0?r/s:0,transactionCount:n,medianPrice:0,q1Price:0,q3Price:0,minPrice:Math.min(e.minPrice||1/0,t.minPrice||1/0),maxPrice:Math.max(e.maxPrice||0,t.maxPrice||0)}}(t.coreMetrics,e.coreMetrics),e.projectRanking&&Array.isArray(e.projectRanking)&&(t.projectRanking=[...t.projectRanking,...e.projectRanking]),t.priceBandAnalysis=function(e,t){if(!t)return e;let r=Array.isArray(e)?e:e?.details||[],s=Array.isArray(t)?t:t?.details||[],n=e?.locationCrossTable||{},i=t?.locationCrossTable||{},a=e?.allDistricts||[],l=t?.allDistricts||[],o=e?.allRoomTypes||[],c=t?.allRoomTypes||[],d=new Map,m=e=>{let t=null!==e.bathrooms&&void 0!==e.bathrooms?String(e.bathrooms):"null",r=(e.roomType||"").replace(/\s+/g,""),s=`${r}-${t}`,n=Number(e.count)||0,i=Number(e.avgPrice)||0,a=Number(e.minPrice)||0,l=Number(e.maxPrice)||0;if(d.has(s)){let t=d.get(s),r=Number(t.count)||0,o=Number(t.avgPrice)||0,c=i*n,m=r+n,x=m>0?(o*r+c)/m:0;if(t.count=m,t.avgPrice=parseFloat(x.toFixed(2)),t.minPrice=Math.min(t.minPrice,a),t.maxPrice=Math.max(t.maxPrice,l),e.projectNames){let r=new Set([...t.projectNames,...e.projectNames]);t.projectNames=Array.from(r)}e.byDistrict&&Object.entries(e.byDistrict).forEach(([e,r])=>{t.byDistrict[e]=(t.byDistrict[e]||0)+r})}else d.set(s,{...e,roomType:r,count:n,avgPrice:i,minPrice:a,maxPrice:l,projectNames:e.projectNames?[...e.projectNames]:[],byDistrict:e.byDistrict?{...e.byDistrict}:{}})};r.forEach(m),s.forEach(m);let x={...n};Object.entries(i).forEach(([e,t])=>{x[e]?Object.entries(t).forEach(([t,r])=>{x[e][t]=(x[e][t]||0)+r}):x[e]={...t}});let u=Array.from(new Set([...a,...l])).sort(),h=Array.from(new Set([...o,...c])).sort();return{details:Array.from(d.values()),locationCrossTable:x,allDistricts:u,allRoomTypes:h}}(t.priceBandAnalysis,e.priceBandAnalysis),t.unitPriceAnalysis=function(e,t){if(!t)return e;let r=(e,t)=>{if(!t)return e;if(!e)return t;let r=(e.count||0)+(t.count||0);if(0===r)return e;let s={arithmetic:0,weighted:0},n=(e,t)=>"number"==typeof e.avgPrice?e.weightedAvgPrice||e.avgPrice:e.avgPrice?.[t]||0;["arithmetic","weighted"].forEach(i=>{let a=n(e,i),l=n(t,i);s[i]=(a*(e.count||0)+l*(t.count||0))/r});let i=Math.min(e.minPrice,t.minPrice),a=Math.max(e.maxPrice,t.maxPrice),l=e.minPrice<t.minPrice?e.minPriceProject:t.minPriceProject;return{count:r,avgPrice:s,minPrice:i,maxPrice:a,minPriceProject:l,maxPriceProject:e.maxPrice>t.maxPrice?e.maxPriceProject:t.maxPriceProject,medianPrice:0,q1Price:0,q3Price:0}},s=r(e.residentialStats,t.residentialStats),n=r(e.officeStats,t.officeStats),i=r(e.storeStats,t.storeStats),a=[...e.typeComparison||[]];return t.typeComparison&&(a=[...a,...t.typeComparison]),{residentialStats:s,officeStats:n,storeStats:i,typeComparison:a}}(t.unitPriceAnalysis,e.unitPriceAnalysis),t.transactionDetails&&t.transactionDetails.length>0&&function(e,t){if(!e||!t||0===t.length)return;let r=[],s={price:0,area:0,count:0},n=[],i={price:0,area:0,count:0},a=[],l={price:0,area:0,count:0},o=()=>({minPrice:1/0,maxPrice:-1/0,minRecord:null,maxRecord:null}),c=o(),d=o(),m=o();t.forEach(e=>{let t=e["建物型態"],o=e["主要用途"],x=e["房屋單價(萬)"],u=e["房屋總價(萬)"]||0,h=e["建物移轉總面積"]||0;if("number"!=typeof x||x<=0)return;let p=r,f=s,g=c;t?.includes("店")||"商業用"===o||e["備註"]?.includes("店")?(p=a,f=l,g=m):(t?.includes("辦公")||t?.includes("廠辦")||t?.includes("事務所")||o?.includes("辦公"))&&(p=n,f=i,g=d),p.push(x),f.price+=u,f.area+=h,f.count+=1,x>g.maxPrice&&(g.maxPrice=x,g.maxRecord=e),x<g.minPrice&&(g.minPrice=x,g.minRecord=e)});let x=(e,t,r,s)=>{e&&(function(e,t){if(!t||0===t.length){e.medianPrice=0,e.q1Price=0,e.q3Price=0;return}t.sort((e,t)=>e-t),e.medianPrice=rT(t,.5),e.q1Price=rT(t,.25),e.q3Price=rT(t,.75)}(e,t),e.count=r.count,e.avgPrice=r.count>0?t.reduce((e,t)=>e+t,0)/r.count:0,e.weightedAvgPrice=r.area>0?r.price/r.area:0,s.maxRecord&&(e.maxPrice=s.maxPrice,e.maxPriceProject=s.maxRecord["建案名稱"],e.maxPriceUnit=s.maxRecord["戶型"]||s.maxRecord["戶別"],e.maxPriceFloor=s.maxRecord["樓層"]),s.minRecord&&(e.minPrice=s.minPrice,e.minPriceProject=s.minRecord["建案名稱"],e.minPriceUnit=s.minRecord["戶型"]||s.minRecord["戶別"],e.minPriceFloor=s.minRecord["樓層"]))};e.residentialStats&&x(e.residentialStats,r,s,c),e.officeStats&&x(e.officeStats,n,i,d),e.storeStats&&x(e.storeStats,a,l,m);let u=new Map;t.forEach(e=>{let t=e["建案名稱"];if(!t)return;u.has(t)||u.set(t,{resSum:{price:0,area:0,count:0},shopSum:{price:0,area:0,count:0},officeSum:{price:0,area:0,count:0},county:e["縣市"],district:e["行政區"]});let r=u.get(t),s=e["建物型態"],n=e["主要用途"],i=e["房屋單價(萬)"],a=e["房屋總價(萬)"]||0,l=e["建物移轉總面積"]||0;"number"!=typeof i||i<=0||(s?.includes("店")||"商業用"===n||e["備註"]?.includes("店")?(r.shopSum.price+=a,r.shopSum.area+=l,r.shopSum.count+=1):s?.includes("辦公")||s?.includes("廠辦")||s?.includes("事務所")||n?.includes("辦公")?(r.officeSum.price+=a,r.officeSum.area+=l,r.officeSum.count+=1):(r.resSum.price+=a,r.resSum.area+=l,r.resSum.count+=1))});let h=[];u.forEach((e,t)=>{let r=e.resSum.area>0?e.resSum.price/e.resSum.area:0,s=e.shopSum.area>0?e.shopSum.price/e.shopSum.area:0,n=e.officeSum.area>0?e.officeSum.price/e.officeSum.area:0;r>0&&(s>0||n>0)&&h.push({projectName:t,county:e.county,district:e.district,residentialAvg:r,shopAvg:s,officeAvg:n,shopMultiple:r>0?s/r:0,officeMultiple:r>0?n/r:0})}),h.sort((e,t)=>e.projectName.localeCompare(t.projectName)),e.typeComparison=h}(t.unitPriceAnalysis,t.transactionDetails),t.parkingAnalysis=function(e,t){if(!t)return e;let r=e.parkingRatio,s=t.parkingRatio,n=null;if(r&&s){let e=r.withParking.count,t=r.withoutParking.count,i=s.withParking.count,a=s.withoutParking.count,l=e+i,o=t+a,c=l+o;n={withParking:{count:l,percentage:c>0?l/c*100:0},withoutParking:{count:o,percentage:c>0?o/c*100:0}}}else n=r||s;let i=new Map,a=e=>{if(i.has(e.type)){let t=i.get(e.type),r=t.count+e.count,s=t.transactionCount+e.transactionCount,n=t.avgPrice,a=e.avgPrice,l=s>0?(n*t.transactionCount+a*e.transactionCount)/s:0;t.count=r,t.transactionCount=s,t.avgPrice=l}else i.set(e.type,{...e})};(e.avgPriceByType||[]).forEach(a),(t.avgPriceByType||[]).forEach(a);let l=Array.from(i.values()),o=new Map,c=e=>{if(o.has(e.floor)){let t=o.get(e.floor),r=t.count+e.count;e.rawRecords&&(t.rawRecords=[...t.rawRecords||[],...e.rawRecords]);let s=r>0?(t.avgPrice*t.count+e.avgPrice*e.count)/r:0;t.count=r,t.avgPrice=s,t.minPrice=Math.min(t.minPrice,e.minPrice),t.maxPrice=Math.max(t.maxPrice,e.maxPrice),e.maxPrice>t.maxPrice&&(t.maxPriceProject=e.maxPriceProject,t.maxPriceUnit=e.maxPriceUnit,t.maxPriceFloor=e.maxPriceFloor),e.minPrice<t.minPrice&&(t.minPriceProject=e.minPriceProject,t.minPriceUnit=e.minPriceUnit,t.minPriceFloor=e.minPriceFloor)}else o.set(e.floor,{...e,rawRecords:e.rawRecords?[...e.rawRecords]:[]})};return(e.rampPlanePriceByFloor||[]).forEach(c),(t.rampPlanePriceByFloor||[]).forEach(c),{parkingRatio:n,avgPriceByType:l,rampPlanePriceByFloor:Array.from(o.values())}}(t.parkingAnalysis,e.parkingAnalysis),t.salesVelocityAnalysis=function(e,t){if(!t)return e;let r=Array.from(new Set([...e.allRoomTypes||[],...t.allRoomTypes||[]])),s={};return["monthly","quarterly","yearly","weekly"].forEach(r=>{let n=e[r]||{},i=t[r]||{},a={};new Set([...Object.keys(n),...Object.keys(i)]).forEach(e=>{let t=n[e]||{},r=i[e]||{},s=new Set([...Object.keys(t),...Object.keys(r)]),l={};s.forEach(e=>{let s=t[e],n=r[e];if(s&&n){let t=s.count+n.count,r=s.priceSum+n.priceSum,i=s.areaSum+n.areaSum;l[e]={count:t,priceSum:r,areaSum:i,avgPrice:i>0?r/i:0}}else s?l[e]={...s}:n&&(l[e]={...n})}),a[e]=l}),s[r]=a}),{allRoomTypes:r,...s}}(t.salesVelocityAnalysis,e.salesVelocityAnalysis),s=t.priceGridAnalysis,t.priceGridAnalysis=(i=e.priceGridAnalysis)?{projectNames:[...s.projectNames||[],...i.projectNames||[]],byProject:{...s.byProject||{},...i.byProject||{}}}:s,t.areaDistributionAnalysis=function(e,t){if(!t)return e;if(!e)return t;let r={...e};return Object.keys(t).forEach(e=>{r[e]?r[e]=[...r[e],...t[e]]:r[e]=[...t[e]]}),r}(t.areaDistributionAnalysis,e.areaDistributionAnalysis),t):JSON.parse(JSON.stringify(e)):t,p++}if(console.log("Aggregation complete. Total Transaction Details:",h?.transactionDetails?.length),0===p)throw Error("無法取得任何縣市的分析數據");if(p<l.length){let e=l.length-p;n(`注意：有 ${e} 個縣市的資料載入失敗，分析結果可能不完整。`)}a(h)}catch(e){console.error("Analysis failed:",e),n(e.message||"無法取得分析數據，請稍後再試。")}finally{r(!1)}},[e]);return(0,o.useEffect)(()=>{},[]),(0,l.jsxs)(eG,{children:[(0,l.jsx)("section",{className:"mb-6 sticky top-4 z-30",children:(0,l.jsx)(ti,{onAnalyze:c,isLoading:t})}),s&&(0,l.jsxs)("div",{className:"bg-red-500/10 border border-red-500/50 text-red-500 p-4 rounded-lg mb-6 flex items-center gap-2",children:[(0,l.jsx)(tV,{size:20}),s]}),t&&(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,l.jsx)(tq,{className:"h-10 w-10 animate-spin text-violet-500 mb-4"}),(0,l.jsx)("p",{className:"text-zinc-400",children:"正在分析數據，請稍候..."})]}),!t&&!i&&!s&&(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 glass-panel border-dashed border-2 border-zinc-800 rounded-xl",children:[(0,l.jsx)("div",{className:"text-zinc-500 mb-2",children:"尚未進行分析"}),(0,l.jsx)("p",{className:"text-zinc-600 text-sm",children:"請選擇篩選條件並點擊「開始分析」"})]}),!t&&i&&(0,l.jsx)("div",{className:"space-y-8 pb-20",children:(0,l.jsxs)(rN,{defaultValue:"ranking",className:"w-full",children:[(0,l.jsx)("div",{className:"overflow-x-auto pb-2 scrollbar-hide",children:(0,l.jsxs)(rR,{className:"bg-zinc-900/50 border border-white/5 p-1 mb-6 inline-flex min-w-max",children:[(0,l.jsx)(rF,{value:"ranking",children:"核心指標與排名"}),(0,l.jsx)(rF,{value:"price-band",children:"總價帶分析"}),(0,l.jsx)(rF,{value:"unit-price",children:"單價分析"}),(0,l.jsx)(rF,{value:"heatmap",children:"調價熱力圖"}),(0,l.jsx)(rF,{value:"velocity",children:"銷售速度與房型"}),(0,l.jsx)(rF,{value:"parking",children:"車位分析"})]})}),(0,l.jsx)(rE,{value:"ranking",className:"focus-visible:outline-none focus-visible:ring-0",children:(0,l.jsx)(tf,{data:i})}),(0,l.jsx)(rE,{value:"price-band",className:"focus-visible:outline-none focus-visible:ring-0",children:(0,l.jsx)(tj,{data:{...i.priceBandAnalysis,transactionDetails:i.transactionDetails}})}),(0,l.jsx)(rE,{value:"unit-price",className:"focus-visible:outline-none focus-visible:ring-0",children:(0,l.jsx)(tA,{data:i})}),(0,l.jsx)(rE,{value:"heatmap",className:"focus-visible:outline-none focus-visible:ring-0",children:(0,l.jsx)(t_,{data:i})}),(0,l.jsx)(rE,{value:"velocity",className:"focus-visible:outline-none focus-visible:ring-0",children:(0,l.jsx)(tk,{data:i})}),(0,l.jsx)(rE,{value:"parking",className:"focus-visible:outline-none focus-visible:ring-0",children:(0,l.jsx)(tP,{data:i})})]})})]})}rE.displayName=rM.displayName,e.s(["default",()=>rD],6698)}]);